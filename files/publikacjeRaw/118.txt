The Physics of Optimal Decision Making: A Formal Analysis of Models of Performance in Two-Alternative Forced-Choice Tasks Rafal Bogacz, Eric Brown, Jeff Moehlis, Philip Holmes, and Jonathan D. Cohen Princeton University In this article, the authors consider optimal decision making in two-alternative forced-choice (TAFC) tasks. They begin by analyzing 6 models of TAFC decision making and show that all but one can be reduced to the drift diffusion model, implementing the statistically optimal algorithm (most accurate for a given speed or fastest for a given accuracy). They prove further that there is always an optimal trade-off between speed and accuracy that maximizes various reward functions, including reward rate (percentage of correct responses per unit time), as well as several other objective functions, including ones weighted for accuracy. They use these findings to address empirical data and make novel predictions about performance under optimality. Keywords: drift diffusion model, reward rate, optimal performance, speed–accuracy trade-off, perceptual choice This article concerns optimal strategies for decision making in the two-alternative forced-choice (TAFC) task. We present and compare several decision-making models, briefly discuss their neural implementations, and relate them to one that is optimal in the sense that it delivers a decision of specified accuracy in the shortest possible time: the drift diffusion model (DDM). Further definitions of optimality, via objective functions such as reward rate (RR), are given below, and we provide explicit solutions to the speed–accuracy trade-off for the TAFC task. It has been known since Hernstein’s (1961, 1997) work that animals do not achieve optimality under all conditions, and in behavioral economics, humans often fail to choose optimally (e.g., Kahneman & Tversky, 1984; Loewenstein & Thaler, 1989). For example, in selecting among two items of comparable value and a cash payment worth less than either, participants often opt for cash, possibly to avoid a harder decision between two more valu- able but similar items (Shafir & Tversky, 1995). Such findings raise important questions: Is human decision making always suboptimal? If it is not, under what conditions is it optimal? When it is suboptimal, does this reflect inherent deficien- cies in decision-making mechanisms or other sources of systematic bias? Answers to such questions may provide insights into under- lying neural mechanisms. However, to consider them, one must first describe optimal performance, against which actual behavior can be compared. Optimality has long been a key principle in the physical sciences (e.g., energy minimization and related variational methods), and it has recently begun to see application in the life sciences, including behavioral ecology (Belovsky, 1984; Bull, Metcalfe, & Mangel, 1996; Dunbar, 1984) and neuroscience (e.g., Bialek, Rieke, de Ruyter van Steveninck, & Warland, 1991; Levine & Elsberry, 1997; Olshausen & Field, 1996). Optimality is also a cornerstone of standard economic theory and its application to human decision making (e.g., the rational agent model and the principle of utility maximization). However, this has focused on optimal outcomes and not the dynamics of decision processes. Some theories based on optimal performance have appeared in psychology as well (e.g., Carpenter & Williams, 1995; Edwards, 1965; Link, 1975; Mozer, Colagrosso, & Huber, 2002). Anderson’s (1990) rational analysis is perhaps the most fully developed example, and models based on it have illuminated cognitive functions including memory, catego- rization, and reasoning (Anderson, 1990; Oaksford & Chater, 1998). In this article, we adopt a similar approach with regard to decision making, with an additional focus on how it may be Rafal Bogacz, Center for the Study of Brain, Mind and Behavior, Princeton University, and Program in Applied and Computational Mathe- matics, Princeton University; Eric Brown and Jeff Moehlis, Program in Applied and Computational Mathematics, Princeton University; Philip Holmes, Program in Applied and Computational Mathematics, Princeton University, and Department of Mechanical and Aerospace Engineering, Princeton University; Jonathan D. Cohen, Center for the Study of Brain, Mind and Behavior, Princeton University, and Department of Psychology, Princeton University. This work was supported by the following grants: National Institutes of Health Grant P50 MH62196, Department of Energy Grant DE-FG02- 95ER25238 (Philip Holmes), Engineering and Physical Science Research Council Grant EP/C514416/1, National Science Foundation Mathematical Sciences Postdoctoral Research Fellowship (held by Jeff Moehlis and Eric Brown), and the Burroughs-Wellcome Program in Biological Dynamics and Princeton Graduate School (Eric Brown). We thank Peter Hu for collecting data in the experiment described in the section of the article entitled TAFC Experiment and Fit of DDM. We thank Josh Gold for providing us with the program to generate the moving dots stimuli and for discussion. We thank Tyler McMillen for contribution to the section on multiple decisions and Mark Gilzenrat and Angela Yu for discussions and valuable insights and ideas that have driven the work reported in this article. The full set of data from the experiment and Matlab codes allowing comparison of decision-making models (together with online tutorial) are available for download at http://www.cs.bris.ac.uk/home/rafal/optimal/. Correspondence concerning this article should be addressed to Rafal Bo- gacz, who is now at the Department of Computer Science, University of Bristol, Bristol BS8 1UB, United Kingdom. E-mail: r.bogacz@bristol.ac.uk Psychological Review Copyright 2006 by the American Psychological Association 2006, Vol. 113, No. 4, 700–765 0033-295X/06/$12.00 DOI: 10.1037/0033-295X.113.4.700 700 implemented in the brain. We do so within the context of a set of highly simplified decision-making conditions, one in which a choice must be made between two responses based on limited information about which is correct (that is, which will be re- warded) and in which both the speed and the accuracy of the decision impact the total cumulative reward that is accrued. These conditions are often referred to as the TAFC paradigm. The Two-Alternative Forced-Choice (TAFC) Task Choosing between two alternatives, even under time pressure and with uncertain information, is a simplification of many situa- tions, but we focus on it for several reasons. First, it is represen- tative of many problems faced by animals in their natural envi- ronments (e.g., whether to approach or avoid a novel stimulus). Pressures for speed and accuracy in such constrained situations may have exerted strong evolutionary influences, thereby optimiz- ing mechanisms. Second, a wealth of human behavioral data generated since the late 19th century (e.g., Hill, 1898) has moti- vated formal modeling of the dynamics and response outcomes in TAFC tasks (e.g., Busemeyer & Townsend, 1993; LaBerge, 1962; Laming, 1968; Link, 1975; Link & Heath, 1975; Pike, 1966; Ratcliff, 1978; Ratcliff & Smith, 2004; Ratcliff, Van Zandt, & McKoon, 1999; Stone, 1960; Usher & McClelland, 2001; Vickers, 1970). Finally, neuroscientists can now monitor neuronal dynam- ics and assess their relationship to task performance. In many cases, neural and behavioral data are converging to support formal models such as the DDM (e.g., Gold & Shadlen, 2002; Hanes & Schall, 1996; Ratcliff, Cherian, & Segraves, 2003; Schall, 2001; Shadlen & Newsome, 1996, 2001). TAFC task models typically make three fundamental assump- tions: (a) evidence favoring each alternative is integrated over time, (b) the process is subject to random fluctuations, and (c) the decision is made when sufficient evidence has accumulated favor- ing one alternative over the other. A central question, to which we return, is whether evidence for each alternative is integrated inde- pendently or whether the difference in evidence is integrated. Most current theories assume that the difference in evidence drives the decision. In neural models, differences can be computed by inhib- itory mechanisms, but theories vary in how inhibition is imple- mented, leading to different behavioral predictions. Several com- parisons of theories with empirical data have appeared (e.g., Ratcliff & Smith, 2004; Ratcliff et al., 1999; Smith & Ratcliff, 2004; Smith & Vickers, 1989; Usher & McClelland, 2001; Van Zandt, Colonius, & Proctor, 2000; Vickers, Caudrey, & Wilson, 1971), but a systematic mathematical analysis that compares mod- els with one another and with optimal performance is lacking. Our first goal is to conduct such a study. This is a key step if we are to decide which model best describes the data. We relate several existing models to a particular standard: the DDM (Lam- ing, 1968; Ratcliff, 1978; Stone, 1960). We adopt the DDM as a reference because it is simple and well characterized (e.g., Smith, 2000), has been proven to implement the optimal mechanism for TAFC decision making (e.g., Laming, 1968), and accounts for an impressive array of behavioral and neuroscientific data (e.g., Gold & Shadlen, 2002; Hanes & Schall, 1996; Ratcliff, 1978; Ratcliff, Gomez, & McKoon, 2004; Ratcliff & Rouder, 2000; Ratcliff, Thapar, & McKoon, 2003; Schall, 2001; Shadlen & Newsome, 2001; Smith & Ratcliff, 2004; Thapar, Ratcliff, & McKoon, 2003). The Drift Diffusion Model (DDM) for Decision Making in the TAFC Paradigm In applying the DDM to the TAFC, we assume that the differ- ence in the (noisy) information favoring each alternative is inte- grated over each trial and that a decision is reached when the resulting accumulated value crosses a critical threshold. Discrete analogues of the DDM were first applied to decision making in World War II, via the sequential probability ratio test (SPRT), the theory being developed independently by Barnard (1946) and Wald (1947; cf. Lehmann, 1959). (For histories, see DeGroot, 1988; Good, 1979; Wallis, 1980.) It was subsequently shown that the DDM and its discrete analogue, a directed random walk, describe accuracy and reaction times (RTs) in humans per- forming TAFC tasks (Laming, 1968; Ratcliff, 1978; Stone, 1960). In particular, DDM first passages account for a robust feature of human performance: RT distributions are heavily skewed toward longer times (see Figure 1a). More recently, neural firing patterns have been examined in light of the DDM (e.g., Gold & Shadlen, 2002; Hanes & Schall, 1996; Schall & Thompson, 1999; Shadlen & Newsome, 2001). For example, Shadlen and Newsome (1996) have studied the activity of neurons in the lateral intraparietal (LIP) area (which code for gaze direction) in monkeys performing a TAFC task in which they respond by saccading to one of two targets. Following stimulus presentation, activity increases in neurons selective for both direc- tions, with those selective for the correct response rising fastest on average (see Figure 1c). Critically, the time at which their firing rate reaches a fixed threshold predicts the response. As noted above and elaborated below, the DDM is optimal in the sense that it is the fastest decision maker for a given level of accuracy. This assumes a fixed decision threshold, yet the model does not specify what this should be. Absent noise, thresholds have no effect on accuracy. However, with noisy data, accuracy in- creases as thresholds and decision times (DTs) rise because there is more time to average out uncorrelated noise. This produces a speed–accuracy trade-off: Lower thresholds produce faster but less accurate responding, whereas higher thresholds produce more ac- curate but slower responses. This speed–accuracy trade-off is critical for interpreting the results of most psychological experi- ments (Pachella, 1974; Wickelgren, 1977). For example, a manip- ulation intended to influence task difficulty, and thereby accuracy, could instead simply induce a change in response threshold, thereby changing RTs. A number of different theories of how humans (or animals in general) set thresholds or otherwise manage the speed–accuracy trade-off have been proposed (Busemeyer & Rapoport, 1988; Edwards, 1965; Gold & Shadlen, 2002; Maddox & Bohil, 1998; Myung & Busemeyer, 1989; Rapoport & Burkheimer, 1971). We return to this in the second part of the article (A Theory of Optimal Thresholds), where we extend the DDM to show how thresholds can be chosen to optimize performance according to various cri- teria and thereby make novel predictions. Overview of the Article We have two primary goals: (a) to analyze the relationship of the DDM to other decision-making models and (b) to address the broader question of optimality, specifically identifying optimal 701OPTIMAL DECISION MAKING parameters for TAFC tasks. We hope thereby to offer a unified framework in which to pursue future modeling and quantitative studies of decision-making behavior. The article is organized as follows. In the second section (Back- ground), we provide formal descriptions of the TAFC task, the SPRT, and the DDM, specifying how key quantities such as error rate (ER) and mean DT depend on the parameters characterizing the DDM. We then review five other decision-making models. We analyze the relationship of these to the DDM in the third section (Relationships Among the Models), showing that all but one of them is a variant of it, at least in a limiting sense. We thereby clarify the relationships among several theories and their differing predictions, facilitating further analysis and discussion. We illus- trate this by fitting DDM parameters to empirical TAFC data and using these as a reference for comparing models throughout the remainder of the article. We then address the question of optimality. In the fourth section (Optimal Performance of Decision Networks), we show that the parameters optimizing performance of the other decision-making models are precisely those for which the models reduce to the DDM. We review several criteria for optimality in the fifth section (A Theory of Optimal Thresholds), demonstrating that each im- plies a unique optimal threshold and speed–accuracy trade-off and illustrating their dependence on task parameters. We further show that the DDM implements the optimal decision-making procedure for all the criteria and predict novel patterns that should emerge in empirical data as signatures of optimal performance in each case. In the sixth section (Biased Decisions), we consider biased deci- sions and rewards, in which one alternative is more probable, or the reward associated with it more valuable, than the other. We thereby explain some published neurophysiological data and make new quantitative predictions about behavioral strategies in these cases. We finally discuss extensions to the DDM that might provide more complete accounts of decision-making behavior, arguing that it offers an attractive framework for further theoretical analysis and the design of empirical studies. Throughout, we restrict our formal presentation to the most important equations, and where possible, we provide intuitive explanations. Further mathematical details are available in Appendix A. Background Behavioral and Neurophysiological Data from the TAFC In a common version of the TAFC task, participants must identify the direction of a coherently moving subset of dots em- bedded in a random motion field (Britten, Shadlen, Newsome, & Movshon, 1993). Critical parameters under experimenter control include (a) stimulus fidelity or difficulty, which can be manipu- lated by varying the fraction of coherently moving dots; (b) whether participants are allowed to respond freely or responses are cued or deadlined; and (c) the delay between response and the next stimulus. In addition to their use in the study of behavior, TAFC tasks are also used widely in neurophysiological studies, in which direct recordings are made from brain areas involved in task performance (e.g., Shadlen & Newsome, 1996, 2001). Figure 1b shows a representation of typical firing rates observed in the middle tem- poral area (MT) of monkeys trained on the moving dots task (MT is involved in motion processing). When a stimulus with coherent leftward motion is presented, the firing rate of an MT neuron selective for leftward motion typically exceeds that of one selec- tive for rightward motion (Britten et al., 1993)—the grey curve in the figure is more often above the black one. However, both firing rates are noisy, hence decisions based on instantaneous activities of MT neurons would be inaccurate, reflecting uncertainty inherent in the stimulus and its neural representation. Figure 1c shows activity patterns of neurons in area LIP (in- volved in eye movement control): They clearly separate as time increases. LIP neurons are believed to integrate the noisy MT outputs over each trial, leading to more accurate decisions. Neural integration mechanisms have been studied extensively in the con- 0.4 0.6 0.8 1 1.2 1.4 1.6 0 20 40 60 Reaction time N u m b e r o f tr ia ls 0 0.5 1 1.5 2 0 50 100 150 200 time from stimulus onset [s] fi ri n g r a te 0 0.5 1 1.5 2 0 10 20 30 time from stimulus onset [s] fi ri n g r a te LIP left LIP right MT left MT right b) c) a) Figure 1. a: Sample reaction time distribution in two-alternative forced- choice task; based on data from a sample participant in Experiment 1 described in the section TAFC Experiment and Fit of DDM (trials in condition D � 1). b, c: Cartoon of typical peri-stimulus time histograms of neuronal activity during the moving dots task. The figure does not show the actual data, but it is a sketch based on data described by Britten, Shadlen, Newsome, and Movshon (1993), Shadlen and Newsome (2001), and Schall (2001). Horizontal axes show time from stimulus onset. Vertical axes indicate firing rate. Representative firing rates are shown for stimulus with coherent leftward motion. b: Firing rate of neurons in the middle temporal area (MT): Gray line represents a typical neuron selective for leftward motion, and black line for rightward motion. c: Firing rate of neurons in the lateral intraparietal (LIP) area: Gray line represents a typical neuron selective for leftward saccades, and black line for rightward saccades. 702 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN text of control of motor processes (e.g., Aksay, Gamkrelidze, Seung, Baker, & Tank, 2001; Cannon, Robinson, & Shamma, 1983; Goldman, Levine, Major, Tank, & Seung, 2003; Koulakov, Raghavachari, Kepecs, & Lisman, 2002; Major et al., 2004; Seung, 1996; Seung, Lee, Reis, & Tank, 2000). The Decision Problem Motivated by the above example, we formalize the TAFC de- cision problem by postulating two neuronal populations whose activities (firing rates) provide evidence for the two alternatives. We denote their mean activities during a given trial by I1 and I2 and assume that each experiences independent random fluctuations with the same standard deviation, c. The goal is to identify which of I1 and I2 is greater, and the optimality question becomes, for given signal and noise levels I1, I2, and c, what strategy provides the most accurate and fastest decisions on average? More pre- cisely, there are two questions: (a) Which strategy yields the lowest expected ER at a given (fixed) time allowed for decision, and (b) which strategy yields the shortest expected RT for a given ER? These questions correspond to two paradigms under which TAFC tasks can be run. The first typically involves fixed-duration stimuli, after which participants are expected to answer, usually on presentation of a signal to respond, thus constraining their RTs. We refer to the hard-limit case, in which decisions are supposed to be made instantly at the cue, as the interrogation paradigm. The second addresses a free-response paradigm under which partici- pants respond in their own time. Because, in the latter, both ERs and RTs vary (participants implicitly choose a speed–accuracy trade-off), one may assess optimality by asking which among strategies that yield the same ER gives the shortest RT. These paradigms represent the extremes of a continuum of more general deadlining tasks, in which responses can be made at any time before a fixed deadline. We now formalize the questions posed above, which both hinge on determining whether the difference of the means I1 � I2 is positive or negative. Let us denote by Y the random variable corresponding to the difference in activity of two neuronal popu- lations, where the activity of each represents accumulated evidence for one of the two alternatives. We suppose that successive sam- ples of Y within each trial are drawn from one of two probability distributions with densities p1(y) and p2(y) with means �1 and �2. Hence, we must decide which of the hypotheses H1 (I1 � I2 � �1 � 0) or H2 (I1 � I2 � �2 � 0) is correct. The answer to Question a above is given by the procedure of Neyman and Pearson (1933). To decide from which distribution a random sequence Y � y1, y2, . . . , yn is drawn, we calculate the likelihood ratio of the sample Y given the hypotheses H1 and H2: p1n p2n � p1�y1�p1�y2� · · · p1�yn� p2�y1�p2�y2� · · · p2�yn� . (1) Here, p1(yi) and p2(yi) denote the probabilities of each observation yi assuming that hypothesis H1 or H2 is true respectively. The ratio p1(yi)/p2(yi) is greater than 1 if the observation yi supports H1 (i.e., if yi is more likely under H1 than H2) and less than 1 if it supports H2. Because all observations are assumed independent, p1n and p2n denote the probabilities of observing the sequence of observations y1, y2, . . . , yn under H1 or H2, respectively. Hypothesis H1 (or H2) is accepted if the ratio of Equation 1 is less than Z (or greater than Z), where Z is a constant determined by the desired level of accuracy for one of the hypotheses.1 Neyman and Pearson showed that, for fixed sample size n, setting Z � 1 delivers the most likely hypothesis and minimizes the total error probability. Hence, this procedure minimizes ER for fixed DT and thus is optimal for the interrogation paradigm. (Here and throughout, we do not consider any explicit cost for acquiring evidence.) The answer to Question b above is provided by the SPRT of Barnard (1946) and Wald (1947). Here, the goal is to decide as soon as a stream of incoming data reaches a predetermined level of reliability. Again assuming that samples are drawn at random from one of two distributions with densities p1(y), p2(y), the running product of the likelihood ratios is calculated as in Equation 1, but now, observations continue only as long as the product lies within predefined boundaries Z2 � Z1: Z2 � p1n p2n � Z1. (2) Thus, after each measurement, one updates the likelihood ratio, thereby assessing the net weight of evidence in favor of H1 over H2. When the ratio first exceeds Z1 or falls below Z2, sampling ends, and either H1 or H2 is accepted; otherwise, sampling con- tinues.2 The SPRT is optimal in the following sense: Among all fixed or variable sample decision methods that guarantee fixed error probabilities, SPRT requires on average the smallest number of samples to render a decision (Wald & Wolfowitz, 1948). Thus, for a given ER, SPRT delivers the fastest RT. In the first section of Appendix A (Probability Ratio Tests), we provide more precise statements and generalizations to decisions between alternatives with unequal prior probabilities. The SPRT is equivalent to a random walk with thresholds corresponding to the alternative choices, as one can see by taking logarithms in Equations 1 and 2: log Z2 � log p1�y1� p2�y1� � · · · � log p1�yn� p2�yn� � log Z1. (3) Denoting the logarithm of the likelihood ratio by I n, Equation 1 implies that I n is additively updated after each observation: I n � I n�1 � log p1�yn� p2�yn� (4) (cf. Gold & Shadlen, 2002). The SPRT is therefore equivalent to a random walk starting at I0 � 0 and continuing until I n reaches the threshold log Z1 or log Z2. Moreover, as discrete samples are taken more frequently and one approaches sampling of a contin- 1 The Neyman–Pearson procedure underlies many statistical tests used in psychology to evaluate an experimental hypothesis on a fixed number of experimental samples, including the t test. 2 In the context of statistical analysis of experimental data, the SPRT would correspond to checking the condition of Equation 2 after each sample collected and stopping the experiment if Equation 2 is not satisfied (i.e., a prespecified confidence level is reached) rather than waiting for a fixed number of samples and then evaluating the hypotheses for signifi- cance (i.e., probability). 703OPTIMAL DECISION MAKING uous variable, the SPRT converges on the DDM, and the discrete log likelihood ratio I n becomes a continuous time-dependent vari- able x(t), after a change of scale. Details are given in Appendix A (Random Walks and the SPRT and The Continuum Limit of the SPRT).3 As shown below, in the section entitled DDM, this con- tinuum limit yields explicit formulae and key quantitative predic- tions. In the following sections, we review six mathematical models of TAFC decision making, starting with the DDM as developed by Ratcliff (1978; Ratcliff et al., 1999). We then discuss the Ornstein– Uhlenbeck (O-U) model (Busemeyer & Townsend, 1993) because it provides a link between the DDM and the biologically-motivated models that follow (Ditterich, Mazurek, & Shadlen, 2003; Usher & McClelland, 2001; Wang, 2002). These employ different forms of inhibition to compute differences in signals associated with each alternative. We also discuss the well-established and widely used race model (LaBerge, 1962; Logan, 2002; Logan & Bundesen, 2003; Smith & Van Zandt, 2000; Smith & Vickers, 1989; Vickers, 1970). All six models are represented as simplified stochastic differential equations in which only essential elements are re- tained. In particular, for ease of exposition and mathematical tractability, we describe only linearized systems, although many of our observations extend to nonlinear models. Explicit comparisons among linear, piecewise-linear, and nonlinear (sigmoidal) models show that linearized models often capture the key dynamics and parameter dependencies (Brown et al., 2005; Brown & Holmes, 2001; cf. Usher & McClelland, 2001). DDM As indicated above, in the DDM (Ratcliff, 1978), one accumu- lates the difference between the amounts of evidence supporting the two hypotheses. We denote the accumulated value of this difference at time t by x(t) and assume that x � 0 represents equality in the amounts of integrated evidence. We consider two versions of the DDM below, the first being a continuum limit of the random walk model (Laming, 1968) that we refer to as the pure DDM and the second or extended DDM, a generalized model in which drift rates and starting points may vary across trials (e.g., Ratcliff & Rouder, 1998). In the pure DDM, we start with unbiased evidence and accu- mulate it according to dx � Adt � cdW, x�0� � 0. (5) (Biased decisions are treated in the sixth section, below.) In Equation 5, dx denotes the change in x over a small time interval dt, which is comprised of two parts: The constant drift Adt repre- sents the average increase in evidence supporting the correct choice per time unit. In terms of the section above, The Decision Problem, A � 0 if H1 is correct for the trial in question, and A � 0 if H2 is correct. The second term, cdW, represents white noise, which is Gaussian distributed with mean 0 and variance c2dt. Hence, x grows at rate A on average, but solutions also diffuse due to the accumulation of noise. Neglecting boundary effects, the probability density p(x, t) of solutions of Equation 5 at time t is normally distributed with mean At and standard deviation c�t (Gardiner, 1985): p�x, t� � N�At, c�t�. (6) We model the interrogation paradigm by asking if, at the interro- gation time T, the current value of x lies above or below zero. If H1 applies, a correct decision is recorded if x � 0 and an incorrect one if x � 0. The average ER is therefore the probability that a typical solution x(T) of Equation 5 lies below zero at time T, which is obtained by integrating the density p(x, T) of Equation 6 from � to 0: ER � �� Ac �T� , where �y� � � � y 1 �2� e ��u2/ 2�du. (7) (Here, is the normal standard cumulative distribution function.) In the free-response paradigm, the decision is made when x reaches one of two fixed thresholds, positive or negative. If both alternatives are equally probable, the thresholds are symmetric (�z). Figure 2a shows examples of the evolution of x during separate trials (sample paths). Although on average x moves to- ward the correct threshold, noise causes it to hesitate and back- track, and on some trials, it crosses the incorrect threshold. Solutions of a first passage problem for the pure DDM yield simple expressions revealing how ER and mean DT depend on drift A, noise c, and decision threshold z (Feller, 1968; cf. Ratcliff, 1978): ER � 1 1 � e2Az/c 2 , and (8) DT � z A tanh�Azc2� . (9) (See Appendix A, subsection titled ERs, Mean DTs, and Reward Rates). Here, DT denotes the mean DT: the fraction of the RT associated with the decision process. We denote the remaining fraction of RT (e.g., due to sensory or motor processes unrelated to the decision process) by T0. Thus, RT � DT T0. Because Equations 8 and 9 involve ratios of A, z, and c2, ER and DT do not change if these parameters are scaled by the same constant. All the models reviewed here share this property. Because the variable x of the DDM is proportional to the log likelihood ratio, the DDM implements the Neyman–Pearson pro- cedure (with Z � 1) for the interrogation paradigm and the SPRT for the free-response paradigm. Hence, it is the optimal decision maker for both paradigms. The extended DDM (e.g., Ratcliff, 1978; Ratcliff et al., 1999) includes two additional elements that improve its fit to experimen- tal data. Intertrial differences in stimulus fidelity or attention can be modeled by allowing drift to vary by selecting A from a normal distribution with mean mA and standard deviation sA on each trial (Ratcliff, 1978). Drift variability produces longer DTs for errors 3 In Appendix A (sections Optimal Decisions for the Free-Response Protocol and Optimal Decisions Under the Interrogation Protocol), we also provide direct arguments, independent of the SPRT, suggesting that the DDM is optimal in all these senses. 704 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN than correct responses (Ratcliff & Rouder, 1998, 2000),4 because most errors occur on trials with low drift, which typically have longer DTs. Secondly, the initial value x(0) can be chosen from a uniform distribution ranging from �sx to sx (with sx � z). This may reflect participants’ sensitivity to local frequency variations in presentation of specific stimuli that occur even when they are equally probable overall (e.g., Cho et al., 2002; Soetens, Deboeck, & Hueting, 1984) or premature sampling: the integration of noise from sensory neuronal populations before the stimulus onset (Laming, 1968; Rouder, 1996). Starting point variability produces shorter DTs for errors than correct trials (Ratcliff & Rouder, 1998) because these errors occur more often on trials for which the process begins closer to the threshold for the incorrect alternative and hence crosses this threshold with a relatively short DT. The expression for ER of the extended DDM in the interrogation paradigm involves an integral that cannot be analytically evalu- ated, although it can be derived in the presence of drift variability (see Ratcliff, 1978, where an equation for d� [d-prime] as a function of interrogation time is also given). Expressions for ER and DT of the extended DDM in the free-response paradigm also involve integrals that cannot be analytically evaluated, and so we generally resort to numerical simulations, although asymptotic approximations are derived in Appendix A (see section titled ER and DT for the Extended Drift Diffusion Model in the Free- Response Protocol). An efficient numerical method for calculating ER and the distribution of DTs has recently been developed (Tuerlinckx, 2004). Ornstein–Uhlenbeck (O-U) Model The O-U model (Busemeyer & Townsend, 1993) differs from the DDM in that a third term, linear in x, is added: dx � ��x � A�dt � cdW, x�0� � 0. (10) The rate of change of x now also depends on its current value, with a magnitude controlled by the additional parameter �, and x can accelerate or decelerate toward a threshold depending on the sign of �. In the following discussion, we again assume that A � 0 and H1 is correct. First, suppose � � 0. For x � �A/� (�0), dx is zero on average; this value of x corresponds to an equilibrium or fixed point for the noise-free process. When x � �A/�, dx is on average positive, and x typically grows; when x � �A/�, dx is on average negative, and x tends to decrease. The fixed point is therefore an attractor. More precisely, for this stable O-U process, the time-dependent proba- bility density of x converges to a stationary normal distribution centered on x � �A/� with standard deviation c/��2� (Gardiner, 1985; Holmes, Lumley, & Berkooz, 1996). p�x� � N�� A� , c��2�� . (11) Derivations and full expressions for the time-dependent distribu- tion are given in Appendix A (section entitled Optimal Decisions Under the Interrogation Protocol). Now, suppose � � 0. When x � �A/� (�0), dx is on average negative, and x usually decreases, whereas for x � �A/�, it usually increases. Hence, x is repelled from the fixed point more strongly 4 Throughout this article, we assume that drift is fixed within a trial and that drift variations occur only from trial to trial. The case of varying drift within the trial is analyzed in Brown et al. (2005); cf. Ratcliff (1980) and Ratcliff & Rouder (2000). a) b) c) 0 0.5 1 1.5 2 2.5 -1.5 -1 -0.5 0 0.5 1 1.5 2 2.5 time x y1 y2 Z Z 0 Figure 2. Examples of the time evolution of variables in decision models. a: The pure drift diffusion model. Horizontal axis denotes time; vertical axis denotes the accumulated difference x between the evidence supporting the correct and incorrect alternatives. The model was simulated for 100,000 trials using the Euler method with timestep �t � 0.01 and the following parameters: drift A � 1, noise c � 1, threshold z � 1. Each path corresponds to one sample simulated decision process. The histograms outside the thresholds show proportions of trials reaching the threshold after different intervals. b: An example of the evolution of the mutual inhibition model, showing y1 and y2 as functions of time. c: The phase or state space of the mutual inhibition model. Horizontal axis denotes the activation of the first decision unit; vertical axis denotes the activation of the second decision unit. The path shows the decision process from stimulus onset (where y1 � y2 � 0) to reaching a decision threshold (decision thresholds are shown by dashed lines). The mutual inhibition model was simulated for the following parameters: I1 � 4.41, I2 � 3, c � 0.33 (parameters of the inputs correspond to those estimated from the participant shown in Figure 5, via Equation 24), w � k � 10, Z � 0.4. 705OPTIMAL DECISION MAKING the further away it is, and the mean of x accelerates away from x � �A/� in an unstable O-U process. Thus, the corresponding prob- ability density has exponentially growing mean and variance, with no stationary limit. It is also described by the general expressions developed in Appendix A (section entitled Optimal Decisions Under the Interrogation Protocol). Summarizing, � � 0 causes attraction toward the fixed point proportional to the distance of the current state from it, whereas � � 0 causes repulsion. The intuition for these behaviors with respect to decision making is as follows. In the stable case, all solutions approach and tend to remain near the fixed point, which lies nearer the correct threshold, so they typically slow down before crossing it, corresponding to conservative behavior. The unstable case corresponds to riskier behavior: Solutions on the correct side of the fixed point accelerate toward the correct thresh- old, giving faster responses, but solutions on the incorrect side accelerate toward the incorrect threshold, possibly producing more errors. For � � 0, the O-U model simplifies to the pure DDM. Busemeyer and Townsend (1993) proposed that rewards for correct responses should increase �, whereas punishments for errors should decrease it. They also noted that negative � produces a recency or decay effect over the course of a trial because later inputs influence accumulated evidence more than earlier ones, whereas positive � produces a primacy effect (earlier inputs have more influence). The ER expression for the O-U model in the interrogation paradigm generalizes that for the DDM (Equation 7). For interro- gation at time T, we have (Busemeyer & Townsend, 1992; derived in Appendix A, Equations A88 and A92): ER�T� � �� A c �2(e �T � 1) �(e�T � 1) � . (12) The expressions for ER and DT in the free-response paradigm were derived by Busemeyer and Townsend (1992); we give them as Equations A55 and A56 in Appendix A, along with asymptotic approximations A64 and A65 that better reveal parameter depen- dencies. Race (Inhibition-Free) Model The DDM and O-U model are one-dimensional: A single inte- grator accumulates the net evidence. However, many models, including physiologically-motivated ones, use separate integrators for the evidence in support of each alternative and are therefore inherently two-dimensional (or more). Here and below, we review four such models, pictured in Figure 3, and describe when they can and cannot be approximately reduced to one-dimensional descrip- tions. We again simplify by considering only linearized models. The simplest is the race model in which accumulators for each of the two alternatives integrate evidence independently. At least three discrete variants exist, differing in how time and evidence are discretized: the recruitment model (LaBerge, 1962), the accumu- lator model (Vickers, 1970), and the Poisson counter model (Pike, 1966). Here, we describe a continuous-time analogue (see Fig- ure 3a). We again denote the mean rates of incoming evidence by I1 and I2 and assume they are subject to independent white-noise processes of root-mean-square (RMS) strength c. The integrators y1 and y2 accumulate evidence according to �dy1 � I1dt � cdW1dy2 � I2dt � cdW2 , y1�0� � y2�0� � 0. (13) We model the interrogation paradigm by assuming that at time T, the choice is made in favor of the alternative with higher yi. In free-response mode, as soon as either unit exceeds a preassigned threshold, the model is assumed to make a response. Again, we assume equal probabilities of the two alternatives and hence equal decision thresholds y1 � y2 � Z (capital Z distinguishes this case from the threshold of one-dimensional models, denoted by z). Instead of deriving ER and DT expressions for the race model here, we show how they relate to the ERs and DTs of the other models in the section Optimal Performance of Decision Networks, below). Anticipating those results, we note that the race model cannot be reduced to the DDM and is therefore not optimal in the sense described above. Next, we describe three biologically-motivated models that re- late more closely to the DDM and O-U models than to the race model, although they also employ separate accumulators. Mutual Inhibition Model Figure 3b shows the architecture of an abstract neural network (connectionist) model described by Usher and McClelland (2001). We refer to this as the mutual inhibition model in the remainder of this article to distinguish it from others to be discussed below. Its four units represent the mean activities of neuronal populations: Two input units represent populations providing evidence in sup- port of the alternative choices (e.g., groups of left- and right- movement-sensitive MT neurons; cf. the section Behavioral and a) Race b) Mutual inhibition d) Pooled inhibition c) Feed-forward inhibition Inputs: Response units: I1±c I2±c y1 y2 I1±c I2±c y1 y2 u u I1±c I2±c y1 y2 w Inputs: Response units: w w vv w' w' I1±c I2±c y1 y2 y3 Figure 3. Architectures of decision models. a: Race model (continuous version of Vickers, 1970). b: Mutual inhibition model (simplified from Usher & McClelland, 2001). c: Feedforward inhibition model (simplified from Ditterich, Mazurek, & Shadlen, 2003). d: Pooled inhibition model (simplified from Wang, 2002). Arrows denote excitatory connections; line with filled circles denotes inhibitory connections. In Panel d, discs con- taining small open circles denote populations of excitatory neurons, and the disc with filled circles denotes populations of inhibitory neurons. 706 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN Neurophysiological Data From the TAFC, above), and two deci- sion units represent populations integrating the evidence (e.g., LIP neurons). The decision units are leaky integrators with activity levels yi, and each accumulates evidence from an input unit with mean activity Ii and independent white-noise fluctuations dWi of RMS strength c. The decision units also mutually inhibit each other via a connection of weight w. Information is therefore accumulated according to �dy1 � (�ky1 � wy2 � I1)dt � cdW1dy2 � (�ky2 � wy1 � I2)dt � cdW2 , y1�0� � y2�0� � 0. (14) Here, k denotes the decay rate of activity (the leak terms �kyi cause the activity to decay to zero in the absence of inputs) and �wyi represents mutual inhibition. The parameters k, w, and those of the two models described below are all assumed to be non- negative. The activity scale is chosen so that zero represents baseline activity in the absence of inputs, hence integration starts from y1(0) � y2(0) � 0. The values of y1 and y2 describing the state of this model may be represented as a point on a phase plane with horizontal and vertical axes y1 and y2, and the evolution of activities during the decision process may be visualized as a path in this plane. Figure 2c shows an example corresponding to the individual time courses of y1 and y2 of Figure 2b. The major simplification of the model presented here in com- parison to that of Usher and McClelland (2001) is the removal of nonlinearities. In Equations 14, the accumulation rates of y1 and y2 depend linearly on their present values. To account for the fact that neural firing rates are never negative, Usher and McClelland assumed that y1 and y2 are transformed via a threshold-linear activation function f(y) with f(y) � y for y � 0 and f(y) � 0 for y � 0; Equations 14 linearize this function by ignoring thresholding below 0. However, as noted above, in our analysis, yi � 0 corre- sponds to (positive) baseline activity so that yi � 0 need not imply negative activity. As suggested by Cohen, Dunbar, and McClelland (1990), this sensitive (linear) range of the activa- tion function is precisely where one expects decision units in the focus of attention to operate. Furthermore, for suitable parameter values, Equations 14 yield good estimates of the ER and DT distributions of the fully nonlinear system, as shown elsewhere (Usher & McClelland, 2001; see Brown et al., 2005; Brown & Holmes, 2001, for explicit comparisons among the dynam- ics of fully nonlinear, piecewise-linearized, and linearized mutual inhibition models). Feedforward Inhibition Model Shadlen and Newsome (2001; cf. Ditterich et al., 2003; Ma- zurek, Roitman, Ditterich, & Shadlen, 2003) proposed a feedfor- ward inhibition model for area LIP (see Figure 3c). It differs from the mutual inhibition model in that the units are perfect integrators with no leak, and they receive inhibition from crossed inputs rather than inhibiting each other. The accumulation rates are independent of yi: �dy1 � I1dt � cdW1 � u(I2dt � cdW2)dy2 � I2dt � cdW2 � u(I1dt � cdW1) , y1�0� � y2�0� � 0, (15) where the crossed inputs imply that both noise sources influence both accumulators. Here, u denotes the weight of feedforward inhib- itory connections: In the version of Ditterich et al. (2003), these have the same weight as excitatory connections (i.e., u � 1). As in the mutual inhibition model, we assume that decisions are rendered whenever the activity of either unit reaches the threshold Z. Pooled Inhibition Model Wang (2002) developed a biophysically based model of area LIP simulating individual spiking neurons rather than averaged representations of neural populations as in the abstract connection- ist type models described above. The neural and synaptic proper- ties (e.g., membrane capacitance, leak conductance, etc., and decay times of AMPA and NMDA currents) were based on anatomical and neurophysiological observations. The model, shown in Figure 3d (cf. Wang, 2002), includes two pools of neurons representing the alternative choices. These re- ceive stimulus inputs and compete with each other as explained below. At the population level, this architecture has much in common with the mutual inhibition model (compare Figures 3b and 3d), but they differ as follows. First, the decision neurons have self-excitatory recurrent projec- tions, denoted by v in Figure 3d. These are necessary to enable individual neurons, whose membrane voltages decay on a milli- second scale, to integrate information on the decision timescale of hundreds of milliseconds. (They also allow the system to actively maintain stimulus representations, a property used to address short-term memory phenomena in other contexts.) Second, neu- rons representing the alternatives do not directly inhibit each other (because real excitatory neurons do not send inhibitory connec- tions), but both populations excite a common pool of inhibitory neurons via connections of weight w�, which then inhibit all decision neurons equally via recurrent connections of weight w. Precise relationships between detailed neural network models such as this and the DDM are elusive because it is not yet entirely clear when a population of neurons may be approximated by a noisy connectionist unit (although progress is being made in this direction; e.g., Brunel & Latham, 2003; Ermentrout, 1994; Omurtag, Knight, & Sirovich, 2000; Renart, Brunel, & Wang, 2003; Shelley & McLaughlin, 2002; X.-J. Wang, personal com- munication, January 26, 2004; Wong & Wang, 2006). Here, we assume that such a reduction holds so that, denoting the activities of the decision groups by y1 and y2 and of the inhibitory pool by y3, the model may be written as 5 �dy1 � (�ky1 � wy3 � vy1 � I1)dt � cdW1,dy2 � (�ky2 � wy3 � vy2 � I2)dt � cdW2, dy3 � (�kinhy3 � w�(y1 � y2))dt. (16) Again, as above (but unlike Wang, 2002), we have linearized all terms in these equations. As we show below in the section entitled Relationships Among the Models, this reduced or averaged net- 5 Some of the work referenced above indicates that the averaged syn- aptic conductances are the relevant dynamical variables for the reduced network equations; here, for consistency with the rest of the article, we express Equations 16 in terms of the activities of the underlying popula- tions (Wilson & Cowan, 1972). 707OPTIMAL DECISION MAKING work version of Wang’s (2002) model may be viewed as a more biologically realistic implementation of the Usher and McClelland (2001) mutual inhibition model. Relationships Among the Models A number of previous reports have noted similarities between the DDM and biologically-inspired connectionist and averaged neural network models (e.g., Ratcliff & Smith, 2004; Seung, 2003; Usher & McClelland, 2001; Wang, 2002). In this section, we extend those observations by conducting a formal analysis of the relationships among the models, and we derive precise correspon- dences among their variables and parameters. The relationships we find are summarized in Figure 4, which shows that, for appropriate parameter ranges, all the models described in the previous section except the race model can be reduced to the optimal DDM. Recently, Ratcliff and Smith (2004) studied the specific rela- tionships among the DDM, O-U, race, and mutual inhibition models. They used a model mimicry approach, in which they generated data by simulating one model, fitting a second to these data, and measuring the closeness of this fit. Our study comple- ments these previous efforts. Although our analytical approach limits us to simplified models, it allows us to explain why and for which parameter ranges certain models are equivalent. The relationships we find, summarized in Figure 4, in many cases are similar to those that have been revealed by other ap- proaches. For example, similar to Ratcliff and Smith (2004), we find that the DDM and the O-U model with � close to zero mimic each other (as designated by the connection between these models in Figure 4 with label � � 0), the DDM does not mimic the race model (there is no connection between them in Figure 4), and the mutual inhibition model can mimic the DDM, O-U, and race models for different parameter values (arrows pass from the mutual inhibition model to the DDM, O-U, and race models in Figure 4). In the remainder of this section, we describe analyses of the specific relationships among models. In several instances, we present illustrative simulations using parameters fit to TAFC be- havioral data. Therefore, we begin, in the first subsection, with a description of a fit of the DDM to such data. The second subsec- tion shows that for particular parameter ranges, the mutual inhi- bition model can be approximated by either the O-U model or the DDM. The third subsection describes the relationship between the feedforward inhibition model and DDM. The fourth subsection shows that the pooled inhibition model can also be approximated by the DDM for certain parameter values but that there are subtle differences in interpretation of the role of inhibition. TAFC Experiment and Fit of DDM To illustrate our analysis and verify its relevance, we must choose representative parameter values. We do this using data from an experiment examining human performance in a TAFC similar to the one used by Shadlen and Newsome (2001) and identifying the parameters of the DDM that best fit the behavior of a representative participant (with mean ER and RT that were within one standard deviation of the means of full set of partici- pants). A complete description of the experiment will be the subject of a future report. Here, we briefly describe the experi- mental methods (a more detailed description of the experimental methods is provided in Appendix B) and our methods of parameter estimation for the DDM, after which we return to the comparative analysis of models. Method Twenty adult participants performed a task in which they had to indicate whether the predominant direction of movement of an array of dots on a display screen was leftward or rightward by pressing a corresponding key. Task difficulty (i.e., motion coherence) was kept constant throughout the experiment. Participants were paid one cent for each correct choice. After each response, participants were required to release the key, and there was a delay D before presentation of the next stimulus (D was kept constant within each block but varied across blocks). On some blocks, an additional delay Dp was imposed after error responses (see below). Trials were blocked by delay condition. This was manipulated to test predictions made by the DDM (discussed below in the section entitled Optimal Thresholds for Different Criteria in the Pure DDM). There were four delay conditions: (a) D � 0.5 s, (b) D � 1 s, (c) D � 2 s, and (d) D � 0.5 s and Dp � 1.5 s (in the first three conditions, Dp � 0). Estimating Parameters of the DDM We estimated the parameters of the extended DDM using a combination of the weighted least squares fitting method (Ratcliff & Tuerlinckx, 2002) and the method of Bogacz and Cohen (2004). Because we expected participants to adopt different decision cri- teria in different delay conditions (as described below in the section entitled A Theory of Optimal Thresholds), we assumed that thresholds z differed across conditions. We further assumed that all the other parameters of the DDM were the same for a given participant in all conditions because the stimuli were exactly the same in all blocks (the motion of dots had the same coherence). Thus, for each participant, we estimated the following parameters: mA (mean drift rate), sA (standard deviation of the drift rate), c (noise), sx (standard deviation of the starting point), T0 (non- decision-related response time), and z1, z2, z3, and z4 (decision thresholds for the four delay conditions). Pooled inhibition Mutual inhibition Feedforward inhibition Race O-U DDM 3 D 2 D 1 D λ=0 kinh large w+k large u=0 u=1 w+k large w=k w=0 k=0 kinh large w, w’ large v=k Figure 4. Relationships among decision models. An arrow between two models indicates that the computations of the first model simplify to computations of the second under conditions in the arrow’s label. The horizontal dotted lines separate classes of models with different numbers of dimensions (one dimension [1D], two dimensions [2D], and three dimen- sions [3D]), so that arrows crossing the dotted lines indicate simplifications involving dimension reduction. A more detailed taxonomy of diffusion and race models (distinguishing between different variants of these models) is given in Figure 1 of Ratcliff and Smith (2004). DDM � drift diffusion model; O-U � Ornstein–Uhlenbeck model. 708 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN Following Ratcliff and Tuerlinckx (2002), for each delay con- dition d, we divided the RT distributions for correct and error trials into five quantiles q: 0.1, 0.3, 0.5, 0.7, and 0.9, denoted as RTCq,d th , RTEq,d th , and RTCq,d ex , RTEq,d ex , with superscripts th and ex indicating theoretical (extended DDM) and experimental statistics. We de- note the ERs given by the extended DDM and observed in the experiment by ERd th and ERd ex respectively. The subplex optimization algorithm (Rowan, 1990) was used to find parameters minimizing the cost function describing the weighted difference between ERs and RT distributions for the model and from the experiment (Ratcliff & Tuerlinckx, 2002): Cost � � d�1 4 ��ER,d�ERd th � ERd ex�2 � � q�1 5 �RTC,d,q�RTCd,q th � RTCd,q ex �2 � � q�1 5 �RTE,d,q�RTEd,q th � RTEd,q ex �2�. (17) In the above equation, �’s denote the weights of the fitted statis- tics. We would like to choose the weight of a given statistic close to 1/(the estimated variance of this experimental statistic), as described by Bogacz and Cohen (2004). For ER, this can be estimated as follows: Assume, for a given condition, that a partic- ipant has a probability of making an error equal to pe and that there are n trials in this condition. Then, the experimental error rate ERex comes from the binomial distribution with mean pe and variance pe(1 � pe)/n. We take �ER � n/pe(1 � pe). For simplicity, we estimate pe as the mean ER of the participant averaged across all delay conditions. This averaging across conditions is done to avoid dividing by zero in blocks in which the participant did not make any errors and also because the differences in ERex across condi- tions for single participants are small in comparison to differences between participants. The estimation of variance for quantiles of the RT distribution was computed using the method of Maritz and Jarrett (1978). Figure 5 compares the ER and RT quantiles of the extended DDM fitted to experimental data from a sample participant by plotting quantile probability functions, as in Ratcliff and Smith (2004). The decision process of this participant exhibited variabil- ity of both drift and starting point (estimated parameter values: mA � 1, sA � 0.31, sx � 0.14, c � 0.33). The extended DDM fits the essential properties of the data: In Figure 5a, the participant em- phasized speed over accuracy; thus, the threshold was low (z1 � 0.16, just outside the range of starting points sx � 0.14), and the effect of variability of starting point was prevalent, producing shorter RTs for errors than correct responses (Ratcliff & Rouder, 1998). In Figure 5d, the participant emphasized accuracy over 0 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 1 Probability R e a c ti o n t im e [ s ] D=0.5 0 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 1 Probability R e a c ti o n t im e [ s ] D=1 0 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 1 Probability R e a c ti o n t im e [ s ] D=2 0 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 1 Probability R e a c ti o n t im e [ s ] D=0.5 D pen =1.5 )b )a )d )c Figure 5. Fit of the extended drift diffusion model (DDM) to a sample participant in the experiment. Each panel corresponds to one experimental delay condition labeled on the top of the panel. Circles indicate experimental data: In each panel, the left column of circles corresponds to error trials, and the right to correct trials. The horizontal axes show the probability of response (i.e., error rate for the left column and probability of correct response for the right column). The vertical axes show the values of five quantiles of reaction time: 0.1, 0.3, 0.5, 0.7, and 0.9. Error bars indicate standard error. The approximately horizontal lines connect predictions of fitted DDM for each of five quantiles. The following parameters of the extended DDM were estimated: sx � 0.14, mA � 1, sA � 0.31, c � 0.33, z1 � 0.16, z2 � 0.19, z3 � 0.22, z4 � 0.26, and T0 � 0.37 s. 709OPTIMAL DECISION MAKING speed; thus, the threshold was high (z4 � 0.26), and the effect of variability of drift was prevalent, producing longer RTs for errors than for correct responses (Ratcliff & Rouder, 1998). Mutual Inhibition Model, O-U Model, and DDM Usher and McClelland (2001) observed that the dynamics of the difference y1 � y2 between activities of the decision units in the (linearized) mutual inhibition model are described by the O-U model in general and, for certain balanced parameters, by the DDM as well. Here, we provide an analytic interpretation of these observations and establish that when the decay and inhibition parameters of the mutual inhibition model are equal and large, the mutual inhibition model, O-U model, and DDM become equiva- lent. Reduction of the Mutual Inhibition Model to the Pure DDM As illustrated above, in the section entitled DDM, the behavior of the mutual inhibition model may be visualized by plotting states on the phase plane. Figure 2c shows a representative path in state space: Initially, the activities of both decision units increase due to stimulus onset, but as the units become more active, mutual inhibition causes the activity of the weaker unit to decrease, and the path moves toward the threshold for the more strongly acti- vated unit (i.e., the correct choice). To understand how these dynamics of the mutual inhibition model are influenced by its two critical parameters (decay and inhibition), Figure 6 shows its vector fields for three different ranges of these parameters. Each arrow shows the average direc- tion in which the state moves from the point indicated by the arrow’s tail, and its length corresponds to the speed of movement (i.e., rate of change) in the absence of noise. In Figure 6, as for most other simulations described in this article, we set I1 � I2; that is, we assume that the first alternative is the correct one (the opposite case is obtained simply by reflecting about the diagonal y1 � y2). Note that in all three panels of Figure 6, there is a line (an eigenvector), sloping down and to the right, to which system states are attracted: The arrows point toward this line from both sides. The orientation of this line represents an important quantity: the difference in activity between the two decision units. Note that the evolution along the line differs for different values of decay and inhibition, as does the strength of attraction toward the line and its location in the phase plane. Most of the interesting dynamics determining decisions occur along this line, and hence, we refer to it as the decision line. Therefore, it is easier to understand these in terms of new coordinates rotated clockwise by 45° with respect to the y1 and y2 coordinates, so that one of the new axes is parallel to the decision line. These new coordinates are shown in Figures 6b and 7a, denoted by x1 (parallel to the decision line) and x2 (per- pendicular to it). The transformation from y to x coordinates is given by (cf. Grossberg, 1988; Seung, 2003) �x1 � y1 � y2 �2 , x2 � y1 � y2 �2 . (18) Equations 18 derive from the geometry shown in Figure 7a: x1 describes the difference between activities of the two decision units, whereas x2 describes the sum of their activities. The square root of two in the denominators of Equations 18 is a normalization factor, included to ensure that y and x coordinates have the same scale. In deciding between two alternatives, it is natural that the difference between the activities of the units selective for the alternatives should be a useful descriptor of the decision process. However, the new coordinates do more than merely emphasize this point. They allow us to factor the two Equations 14 that describe the mutual inhibition decision process into two decoupled pro- cesses, separating the evolution of the difference in the activity of the two units (x1) from the change in their overall (summed) activity (x2). If we can show that the latter has minimal impact on the decision process, then we can reduce the description of this process from one that is two dimensional to a simpler one that is one dimensional. As we show below, for certain parameters, this one-dimensional description reduces to the DDM. To transform Equations 14 into the new coordinates, we first calculate the derivative (rate of change) of x1. Substituting Equa- tions 14 into the first of Equations 18, we obtain dx1 � dy1 � dy2 �2 � ��k y1 � y2�2 � w y1 � y2�2 � I1 � I2�2 �dt � 1 �2 �cdW1 � cdW2�. (19) We assumed earlier that the noise processes for the input units are independent. Because the standard deviation of the sum (or dif- ference) of two independent random variables is equal to the square root of the sum of their variances, the noise process in x1 may be written 1 �2 �cdW1 � cdW2� � �c2 � c2 �2 dW1� � cdW1�. (20) In Equation 20, dW1� again denotes a noise process with mean equal to 0 and an RMS strength of 1. Substituting Equation 20 and the definition of x1 from Equation 18 into Equation 19, we obtain Equation 21. Following analogous calculations for x2, we have a) Decay > Inhibition b) Decay = Inhibition c) Decay < Inhibition (λ < 0) (λ = 0) (λ > 0) x1 x2 y1 y2 y2 y2 y1 y1 Figure 6. Vector fields for the mutual inhibition model. In all plots, I1 � 2, I2 � 1. Inhibition (w) and decay (k) have different values in different panels. a: w � 0.5, k � 1.5. b: w � 1, k � 1. c: w � 1.5, k � 0.5. See text for discussion. 710 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN dx1 � � (w � k)x1 � I1 � I2�2 �dt � cdW1�, and (21) dx2 � � (�k � w)x2 � I1 � I2�2 �dt � cdW2�. (22) Equations 21 and 22 are uncoupled; that is, the rate of change of each xi depends only on xi itself (this was not the case for the decision units in Equations 14). Hence, the evolution of x1 and x2 may be analyzed separately, and in fact, each is described by an O-U process that depends on the parameters of k (decay) and w (inhibition). We first consider the dynamics in the x2 direction, correspond- ing to the summed activity of the two decision units. Equation 22 for the x2 process always gives a stable O-U process because �k � w � 0 (recall that k and w are both constrained always to be non-negative). This corresponds to attraction to the line in all of the panels in Figure 6, implying that x2 approaches a limiting value as time increases. The rate of this (exponential) approach is ��2 � k w, and it is kept constant in the three cases of Figure 6 by setting k w � 2. From Equation 11, the stationary standard deviation from the decision line in the x2 direction is equal to stdev�x2� � c �2�k � w� . (23) Turning to the x1 process, Equation 21 involves a drift term that is proportional to the difference between the inputs I1 and I2. As we discussed above, in the section entitled Ornstein–Uhlenbeck (O-U) Model, this process may be stable or unstable depending on the relative magnitudes of k and w, in a manner comparable to the effects of the parameter � in the O-U model. This dependence is due to the fact that the dynamics of x1 are described in Equation 21 by an O-U process with coefficient � � w � k. When decay is larger than inhibition, then � � 0, and there is an attractor for the x1 dynamics (see above), as shown in Figure 6a. When decay is smaller than inhibition, then � � 0, and there is repulsion from the fixed point in the x1 direction, as shown in Figure 6c. The fixed point is a saddle in this case. Because �k w� (for x2 in Equation 22) � �w � k� (for x1 in Equation 21) for all positive values of k and w, the average state of the system approaches the decision line faster (and often consid- erably faster) than it moves along it (e.g., see Figure 2c). More- over, if the denominator �2(k w) in Equation 23 is large rela- tive to noise strength c, the states/solutions remain tightly bunched around this line as they continue to evolve. This is an important observation, as it indicates that the decision process divides into two phases: an initial phase in which the activity of both units increases quickly and there is rapid equilibration to a neighbor- hood around the decision line, followed by slower movement along the line, governed by an O-U process in which the difference between the activities of the two units grows as one of them prevails and the other subsides. Most relevant to the current discussion, when decay equals inhibition, the term (w � k)x1 in Equation 21 disappears. In this case, the dynamics of x1 reduce to the pure DDM (cf. Equation 5). The vector field for this case is shown in Figure 6b. When decay and inhibition are both reasonably strong (as in Figure 6b), the attraction toward the decision line dominates diffusion along it. Hence, typical paths migrate quickly toward the decision line and then move relatively slowly along (or near) it. In this case, the dynamics of the two-dimensional decision process closely approx- imate those of the one-dimensional DDM (see also Brown et al., 2005). Solutions to the full two-dimensional system (Equations 21–22) are described by the joint probability density of x1 and x2. Because these are independent processes (neglecting threshold effects), this is simply the product of the 2 one-dimensional Gaussian densities for the O-U processes x1 and x2. Critically, when decay equals inhibition and both assume sufficiently large values relative to noise strength, the mutual inhibition model’s behavior should closely resemble that of the pure DDM. We refer to a mutual inhibition model in which decay is equal to inhibition as balanced. Relating Parameters of the Mutual Inhibition Model to the Pure DDM In this section, we find the parameters describing the diffusion process along the decision line in the mutual inhibition model. As above, the transformation is geometric and so requires the same simple trigonometry used above. From Equation 21, we can see that the RMS noise of the approximating DDM is equal to c, and the drift is given by A � I1 � I2 �2 . (24) Calculation of effective thresholds for the diffusion process re- quires a little more work. If the density of solutions is sufficiently tight about the decision line, we need only find the points where this line reaches the thresholds y1 � Z and y2 � Z (D and C in Figure 7b). More specifically, we need to find the distances �z to those points from the intersection of the diagonal (x1 � 0) with the decision line at point A. Because the diagonal and decision line are oriented at �45° to the y2-axis, the triangles ABC and ABD in Figure 7b are isosceles, and the distances AC, AD, and AB are all equal to z. The decision line is located at the equilibrium for the stable O-U process: x*2 � I1 � I2 �2�k � w� . (25) a) b) c) y1 y2 x1 x2 0 x2*2* z Z Z y1 y2 Z Z y1 y2 O B A C D 45° z z Figure 7. Geometry of the mutual and feedforward inhibition models. a: Transformation from y to x coordinates. Small circle denotes a sample state of the network. Labels y1 and y2 indicate the activation levels of decision units. Labels x1 and x2 indicate the values of x (difference and sum) coordinates for this state of the network. b: Thresholds for the balanced mutual inhibition model. c: Thresholds for the feedforward inhibition model with u � 1. In Panels b and c, the grey arrow denotes the decision line, or the line along which the diffusion occurs. Lines marked by Z denote the thresholds of the mutual and feedforward inhibition models. Labels A, B, C, D, and O are as used in the main text. 711OPTIMAL DECISION MAKING Thus, again from Figure 7b and using the right isosceles triangle OBZ, the length of AB is equal to the difference of the lengths OB and OA, or z � �2Z � I1 � I2�2�k � w� . (26) Relating Parameters of the Mutual Inhibition Model to the Extended DDM The extended DDM includes variability of drift and starting point across trials. To relate this model to the mutual inhibition model, these two types of variability need to be incorporated into the latter. Therefore, we define the extended mutual inhibition model in which the mean inputs to the integrators Ii are chosen on each trial from a normal distribution with mean mIi and standard deviation sI and the starting points of variables yi(0) are drawn from a uniform distribution between �sy and sy. First, let us consider the case of statistically independent I1, I2, y1(0), and y2(0). In this case, the sum I1 I2 differs from trial to trial, and because this sum enters Equation 26 relating the thresh- olds of the mutual inhibition model and pure DDM, there is no deterministic relationship between the thresholds of the extended mutual inhibition model and DDM (note, however, that if k, w3 , the second term in Equation 26 disappears, and the relationship simply becomes z � �2Z). Furthermore, the distribution of start- ing points x1(0) projected onto the decision line x2 has a triangular distribution (because it is given by the sum of two independent, uniformly distributed random variables), so the diffusion along the decision line cannot be described by the extended DDM, which assumes uniformly distributed initial states. It is, however, straightforward to establish the equivalence be- tween the extended versions of the mutual inhibition model and DDM if we make the following additional assumptions: I1 I2 � mI1 mI2 � constant, and y1(0) y2(0) � 0. The first assumption states that the total input to the integrators is constant across trials (as in the Poisson counter model of Smith & Van Zandt, 2000). Although this assumption may not be satisfied exactly, adaptation in sensory cortices (Blakemore & Campbell, 1969) is known to reduce the neuronal response when the stimulus is strong and to enhance it when the stimulus is weak. The second assumption states that the starting points of the two integrators are anticorre- lated. Although as yet there is no physiological evidence for such anticorrelation in cortical populations, there are indications of this in the superior colliculus (R. Ratcliff, personal communication, June 25, 2004). Under the above assumptions, I2 � mI1 mI2 � I1, and hence, the drift along the decision line is equal to A � I1 � I2 �2 � 2I1 � mI1 � mI2 �2 . (27) Therefore, the relationships between the parameters are mA � mI1 � mI2 �2 , sA � �2sI, (28) and the relationship between the thresholds is z � �2Z � mI1 � mI2�2�k � w� . (29) Similarly, under the above assumptions, the starting point of the diffusion along the decision line is x1�0� � y1�0� � y2�0� �2 � �2y1�0�. (30) Therefore, the relationship between parameters sx and sy is sx � �2sy. The above relationships are verified in the simulations described in the next section. ERs and DTs in the Balanced Mutual Inhibition Model and DDM As argued above, the balanced mutual inhibition model resem- bles the DDM. However, these models are not identical because the mutual inhibition model describes a two-dimensional process, including movement along the x2-axis (corresponding to the summed activity level of the decision units), whereas the DDM describes a one-dimensional process involving movement only along the x1-axis (corresponding to the difference in activity lev- els). As a way of assessing how well the DDM approximates the balanced mutual inhibition model, we compare ERs and DTs produced by the extended versions of each model when their parameters are constrained according to the relationships derived above, in the section entitled Relating Parameters of the Mutual Inhibition Model to the Extended DDM, and fit to experimental data described above, in the section entitled TAFC Experiment and Fit of DDM. As anticipated, the approximation of the extended mutual inhi- bition model by the extended DDM is more accurate for larger decay and inhibition (k w). This is due to the fact that as the parameter �2 (� �[k w]; see Equation 22) becomes more negative, attraction along the x2 direction toward the decision line is faster, and solutions become more tightly distributed around it (via Equation 23). This is evident in Figure 8, which compares the ERs and DTs of the extended versions of the mutual inhibition model and DDM (with equivalent parameters). Figure 8a illus- trates the case of high decay and inhibition, in which the solutions are tightly distributed about the decision line, and ERs and DTs of the two models are almost exactly the same. In the case of lower decay and inhibition shown in Figure 8b, the solutions are more broadly distributed about the decision line, leading to greater discrepancy between the ERs and DTs of the two models. Figure 8c illustrates the case in which the decay and inhibition are further decreased so that most solutions do not reach the decision line before exceeding the threshold, resulting in substantially different ERs and DTs for the two models. Two additional points are worth noting with respect to these results. First, movement toward the decision line may be facilitated by the high transient activity of sensory input neurons observed just after stimulus onset, as illustrated in Figure 1b (Britten et al., 1993; Schall, 2001). Smith (1995) also suggested the existence of the transient on the basis of psychophysical data. Second, if decay and inhibition are very low (or the signal is very large), then, according to Equation 26, the threshold of the DDM may become negative, a condition for which our reduction to one dimension is ill defined. In summary, when decay and, in particular, inhibition in the mutual inhibition model are very low, there is little competition 712 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN between the two decision units: They integrate evidence essen- tially independently, and hence, the mutual inhibition model can- not be approximated by the DDM. However, when decay and inhibition are greater, the balanced mutual inhibition model can be approximated by diffusion along the decision line, as described by the DDM. Feedforward Inhibition Model and DDM In this section, we show that the feedforward inhibition model reduces to DDM when the parameter u describing the weight of feedforward inhibition is equal to u � 1. To analyze the dynamics of the feedforward inhibition model, we convert it to the rotated coordinates as we did the mutual inhibition model. Transforming Equation 15 via Equation 18 (as done above), we obtain �dx1 � �1 � u�� I1 � I2 �2 dt � cdW1�� , dx2 � �1 � u�� I1 � I2�2 dt � cdW2�� . (31) Thus, similar to the mutual inhibition model, the dynamics of the feedforward inhibition model in the rotated coordinates can be described by two uncoupled diffusion processes weighted by fac- tors 1 u and 1 � u. When we defined the mutual and feedfor- ward inhibition models, we implicitly assumed that the weight of connections from input units to the integrating (decision) units is equal to 1. Note that as the weight of the inhibitory connection (u) approaches the weight of the excitatory connection (1), the weight- ing factor 1 � u diminishes, and thus, dynamics become slower along the direction of x2 relative to the direction of x1. However, unlike the case of the mutual inhibition model, in the feedforward a) w=k=100 b) w=k=10 c) w=k=1 0 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 1 Probability R e a c ti o n t im e [ s ] 0 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 1 Probability R e a c ti o n t im e [ s ] 0 0.2 0.4 0.6 0.8 1 0 0.5 1 1.5 2 Probability R e a c ti o n t im e [ s ] -0.5 0 0.5 -0.5 0 0.5 y 1 y 2 -0.5 0 0.5 -0.5 0 0.5 y 1 y 2 -0.5 0 0.5 -0.5 0 0.5 y 1 y 2 Figure 8. Similarity in error rates (ERs) and decision times (DTs) between the extended diffusion model and balanced mutual inhibition model. Top panels show ER and quantiles of DT distribution for the extended drift diffusion model (solid line) and extended mutual inhibition model (dashed line). In each panel, the left ends of the lines correspond to error trials and the right to correct trials. The horizontal axes show the probability of response (i.e., ER for the left ends and probability of correct response for the right ends). The vertical axes show the values of five quantiles of reaction time: 0.1, 0.3, 0.5, 0.7, and 0.9. Approximately horizontal solid lines show the ERs and DTs of the diffusion model fitted to condition D � 0.5, Dp � 1.5 of the participant from Figure 5 (these lines in all top panels are the same as in Figure 5d). Dashed lines correspond to values obtained from simulations of the extended mutual inhibition model (10,000 iterations for different values of decay and inhibition shown above panels), and all other parameters are defined as in the text section Mutual Inhibition Model, O-U Model, and DDM to give equivalence with the extended diffusion model. Specifically, mI1 � 1.42, mI2 � 0, c � 0.33, sI � 0.22, and sy � 0.096. Note that for higher values of decay and inhibition, the match between the models improves. Note difference in scales in the top of Panel c. Bottom panels show the states from 1,000 trials, at time t � T0 200 ms. Long-dashed lines show the decision threshold. Short-dashed lines show the decision line. 713OPTIMAL DECISION MAKING inhibition model given by Equation 26, there is no attraction toward the decision line. Thus, approximation by the one- dimensional DDM depends on the mean and variance in the x2 direction remaining negligible for the duration of the decision task. If the excitatory and inhibitory weights are equal (u � 1, as they are in the model described by Ditterich et al., 2003), then the value of coordinate x2 remains equal to zero throughout the duration of the decision process, and the entire process proceeds along the decision line x1. In other words, if u � 1, the feedforward inhibi- tion model is exactly equivalent to the pure DDM. In this case, diffusion occurs along the line shown in Figure 7c, and the relationships between the parameters of the pure DDM and the feedforward inhibition model are the following: A 4 2 I1 � I2 �2 , c 4 2c, z 4 �2Z, (32) where the left-side terms are for the DDM and the right-side terms are for the feedforward inhibition model. The relationships for the drift and noise terms come from the first of Equations 31, and for the threshold from Figure 7c. As in the previous section, we can define an extended feedfor- ward inhibition model, where we also assume I1 I2 � constant and y1(0) y2(0) � 0. For u � 1, the relationships between the parameters of the extended versions of the feedforward inhibition model and DDM are the following: mA 4 2 mI1 � mI2 �2 , sA 4 �2sI, sx 4 �2sy, c 4 2c, z 4 �2Z. (33) Busemeyer and Diederich (2002) considered the following model combining mutual and feedforward inhibition:6 dy1dy2 � �k �w�w �k y1dty2dt � 1 �u�u 1 I1dt � cdW1I2dt � cdW2 . (34) They have shown that as u � 1, the above model can be related to the O-U process (Busemeyer & Diederich, 2002; Diederich & Busemeyer, 2003). If such a combined model were balanced (k � w), then as k and w increased and u approached 1, this combined model would be also increasingly well approximated by the pure DDM. Mutual Inhibition and Pooled Inhibition Models In this section, we show that a connectionist model with pooled inhibitory connections can also be approximated by the pure DDM. Specifically, we consider a connectionist model with the architecture shown in Figure 3d, the dynamics of which are de- scribed by the following three (linearized) equations (we rewrite Equations 16): �dy1 � (�ky1 � wy3 � vy1 � I1)dt � cdW1,dy2 � (�ky2 � wy3 � vy2 � I2)dt � cdW2, dy3 � (�kinhy3 � w�(y1 � y2))dt. (35) In the above equation, kinh denotes the decay rate with which the pool of inhibitory neurons approaches firing rates determined by the excitatory populations. If we assume that this rate is fast relative to that of the excitatory populations7 (the effective decay rate of the excitatory population is decreased by the self-excitatory connections; thus, this assumption is equivalent to kinh � k � v), then inhibitory neurons may be said to have little memory of their previous inputs, closely tracking and thus approximating the value y3 � w� kinh �y1 � y2�. (36) Substituting Equation 36 into Equation 35 and regrouping terms, we obtain �dy1 � ���k � ww� kinh � v�y1 � ww�kinh y2 � I1�dt � cdW1, dy2 � ���k � ww�kinh � v�y2 � ww� kinh y1 � I2�dt � cdW2. (37) A comparison of Equations 37 and 14 reveals that the connection- ist model with the architecture of Figure 3d is equivalent to the mutual inhibition model shown in Figure 3b with decay parameter equal to (k ww�/kinh � v) and mutual inhibition ww�/kinh. Therefore, pooled and rapidly equilibrated inhibition not only provides competition but also contributes to the decay of each unit’s activity. Hence, given the considerations of the above sec- tion, Mutual Inhibition Model, O-U Model, and DDM, the con- nectionist model with the architecture shown in Figure 3d displays the same dynamics in the x1 direction as the pure DDM when the following balance among parameters holds: k � ww�/kinh � v � ww�/kinh or k � v. (38) The dynamics in the x2 direction collapse to the decision line, exactly as for the mutual inhibition model, with a timescale pro- portional to kinh/ww�. To summarize, the dynamics of the connectionist model with pooled inhibition can be approximated by the pure DDM when self-excitation exactly balances the decay of each decision unit’s activity (i.e., k � v), inhibitory strengths (w, w�) are sufficiently high, and the decay of inhibitory units kinh is sufficiently large. Furthermore, paralleling the arguments of the previous section, an extended pooled inhibition model may be defined and related to 6 The first square matrix in Equation 34 was denoted by S and the second square matrix by C in Busemeyer and Diederich (2002). 7 The assumption that the decay rate kinh is relatively fast is plausible but will require validation in further physiological experiments. This rate depends on the dynamics of synaptic currents afferent to the inhibitory population. Although, in the original model of Wang (2002), inhibitory neurons receive a significant proportion of their input via NMDA receptors (described by relatively slow time constants of approximately 100 ms; Wang, 2002), the density of such receptors remains to be determined in area LIP. Current research indicates that inhibitory neurons in the hip- pocampus do possess NMDA receptors (McBain & Dingledine, 1993), but Ling and Benardo (1995) have shown that the inhibition in the rat somato- sensory cortex is not NMDA dependent. A parallel finding for the LIP inhibitory neurons, showing that they are excited via rapidly decaying AMPA receptors, would support the present assumption. 714 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN the extended DDM.8 We do not consider the pooled inhibition model further in view of its close relationship to the mutual inhibition model (for large kinh, cf. Equations 37). Optimal Performance of Decision Networks In this section, we identify parameter values that allow decision networks to achieve optimal performance in the interrogation and free-response paradigms (the first and second sections immedi- ately below, respectively). The third section below investigates whether the ERs in decision models can be made arbitrarily small if a sufficiently long time is allowed for the decision in the interrogation paradigm or if the threshold is made sufficiently high in the free-response paradigm. The results of this section for the mutual inhibition model are summarized in Table 1. In particular, we show that for the parameters for which decision networks reduce to DDM, they achieve optimal performance in both para- digms. Highest Accuracy for Fixed DTs: The Interrogation Paradigm As described in the introductory section, the pure DDM is also the optimal decision maker (i.e., is equivalent to the Neyman– Pearson test) in the interrogation paradigm; that is, it is the most accurate for a fixed DT. In this section, we show that the mutual inhibition model achieves such optimality when it is balanced. It is worth noting here that in the interrogation paradigm, the ER of the mutual inhibition model does not depend on the magnitude of decay and inhibition but only on their relative values. As we show below, this contrasts with the free-response paradigm, in which performance depends additionally on the absolute magni- tude of decay and inhibition. The reason is that in the interrogation paradigm, decisions are based solely on a comparison of activities of the decision units and hence only on the value of the x1 coordinate. In effect, the interrogation paradigm allows the two- dimensional probability density to evolve and then, at the time of interrogation, cuts it along the x2-axis and sums it in the negative (error) and positive (correct) x1 half-planes. Therefore, the density of solutions about the decision line (that tightens under increased decay and inhibition) is irrelevant. As a consequence, in contrast to free response, in the interrogation paradigm, the balanced mutual inhibition model achieves the same ER as the DDM irrespective of the magnitudes of decay and inhibition. This is true even in the extreme case of k � w � 0, corresponding to the race model in which the decision units integrate independently of one another. Similar conclusions hold for the feedforward inhibition model (which minimizes ER in the interrogation paradigm for any value of u) and the pooled inhibition model (if the dynamics in the x1 direction are balanced by setting k � v, for any values of w, w�, and kinh). Hence, the mutual inhibition model can in general be approximated by an O-U process with parameter � equal to the difference between inhibition and decay (i.e., � � w � k), and in the case of the interrogation paradigm, these are identical. There- fore, we focus exclusively on the O-U model and ask what value of � optimizes performance. First, we analyze the pure O-U model (without variability of drift or starting point). In Appendix A (section entitled Optimal Decisions Under the Interrogation Protocol), we calculate explicit expressions for the ERs for different interrogation times T and parameters A, c, and �, as already given above in Equation 12. These verify that the O-U process achieves its lowest ER for a fixed DT when � � 0 (i.e., when it simplifies to the DDM). This approximates the mutual inhibition model with decay equal to inhibition. Figure 9a shows ERs achieved by the O-U process with different values of � and different interrogation times. Usher and McClelland (2001) noted that ERs depend only on the absolute magnitude of � (e.g., they are the same for � � 0.2 and �0.2 and for 0.4 and �0.4) and that the lowest ERs are achieved when � � 0. These observations are consistent with the analyses of Appendix A (section entitled Minimizing ER for Unbiased Choices). In particular, the fact that the lowest ER in the interrogation paradigm is achieved by an O-U process with � � 0 confirms the earlier observation that the mutual inhibition model achieves the lowest ER when it is balanced and approximates the DDM. We now consider the extended O-U model, in which drift rate and/or starting point are allowed to vary from trial to trial. Ap- pendix A (section entitled Optimal Values of � for the O-U Model With Variable Drift in Interrogation Protocol) calculates the ER of the O-U model with variability of drift but not starting point and shows that for any mA, sA, c, and interrogation time T, the ER is minimized for � � 0. Thus, the mutual inhibition model with variability of inputs (but not starting points) achieves the lowest ER in the interrogation paradigm when it is balanced (k � w). In contrast with variable drift rate, simulations of Figure 9c indicate that when starting point is allowed to vary, optimal per- formance of the O-U model (i.e., minimization of ER) may be achieved for values of � lower than zero. This may be intuitively understood as follows: Values � � 0 introduce a recency effect (with recently arrived inputs influencing accumulated evidence more than previous inputs or biases; see above section, Ornstein– Uhlenbeck (O-U) Model), which reduces the influence of the 8 The more-detailed firing rate model of Wong and Wang (2006), which includes specific synaptic time constants, indicates that Equation 38 may sometimes be violated. Depending on the overall stimulus strength, on which the analogs of k, w, and so on, depend, both the stable and unstable O-U cases of Figure 6 can occur. Table 1 Conditions on Parameters k (Decay) and w (Inhibition) of the Mutual Inhibition Model for Optimal Performance (Minimal ER in the Interrogation Protocol or Maximal Reward Rate for Free Response) and for Vanishing ER in the Limit of Long Decision Time (Interrogation Protocol) or Large Thresholds (Free Response) Property No variability Variability of drift Optimal performance Interrogation k � w k � w Free response k � w k � w (suggested by simulations) k, w3 k, w 3 ER 3 0 Interrogation k � w Not attainable Free response k � w Not attainable Note. ER � error rate. 715OPTIMAL DECISION MAKING random starting point on the decision that is eventually made. This suggests that when starting point varies, unbalanced versions of the mutual inhibition model may be optimal. However, this observa- tion needs to be considered with respect to the psychological interpretation of variable starting points. Typically, starting point is thought to reflect the influence of prior stimulus or response history on current processing as a result of priming effects and/or expectations based on estimations of stimulus and response prob- abilities (e.g., Cho et al., 2002). In the section entitled Biased Decisions, below, we demonstrate that variations in the starting point are in fact optimal for all models when these variations appropriately track systematic changes in stimulus frequency. There, we return to a discussion of how to interpret the effects of variable starting point in fits of the DDM and related models to empirical data. The analyses and simulations described here provide insight into the parameters of the mutual inhibition model that produce optimal performance in the interrogation paradigm under various condi- tions. However, they do not explain how a biological system might actually make the decision at the required time in the interrogation paradigm, that is, how the system determines the sign of x1 when it has not yet crossed a specified threshold. A number of mecha- nisms for doing so can be imagined. For example, this could be accomplished by setting a very high value of the decision threshold during the trial and then lowering it rapidly or suddenly increasing � (perhaps via w), which would cause strong repulsion from the fixed point and, thus, rapid movement toward one of the thresholds used in the free-response paradigm. Such weight adjustments could be achieved by a transient increase in gain, which might in turn be mediated by release of neuromodulatory neurotransmitters. The locus coeruleus has been suggested as a possible element in such a control circuit (Aston-Jones & Cohen, 2005; Brown et al., 2005; Brown, Gilzenrat, & Cohen, 2004; Gilzenrat, Brown, Aston- Jones, & Cohen, 2004; Usher, Cohen, Servan-Schreiber, Ra- jkowski, & Aston-Jones, 1999), but further consideration of such mechanisms is beyond the scope of this article. Fastest Decisions for Fixed Accuracy: The Free-Response Paradigm As described above, the pure DDM achieves the fastest DTs for a given level of accuracy, and in this sense, it is the optimal decision process for the free-response paradigm. Above, in the section entitled Mutual Inhibition Model, O-U Model, and DDM, we established that the mutual inhibition model’s behavior is similar to that of the DDM when decay equals inhibition and both assume a sufficiently large value. Usher and McClelland (1995, footnote on p. 22) noted that their model also achieves its shortest DTs for fixed accuracy when decay equals inhibition—that is, when it best approximates the DDM. Similar observations were a) interrogation b) free-response c) 0 0.5 1 1.5 2 0 0.1 0.2 0.3 0.4 0.5 time [s] E R λ = -6 or 6 λ = -3 or 3 λ = 0 0 0.5 1 1.5 2 0 0.2 0.4 0.6 0.8 1 z E R λ = -6 λ = 0 λ = 6 Figure 9. Error rates (ERs) for the Ornstein–Uhlenbeck (O-U) model. a: ER in the interrogation protocol for decisions made at different times and for different values of �, according to Equations 8 and 12, with A � 2.19 and c � 1 (parameters estimated from data from middle-difficulty condition of Participant S1 in the experiment described in Usher & McClelland, 2001). b: ER in the free-response protocol. O-U models were simulated for values of parameters corresponding to the evolution along the decision line in Figure 11; that is, for A � 2.19, c � 1. O-U models with three different values of � were simulated: �6, 0, and 6, shown by the three thick curves in different patterns (see legend). The value of the decision threshold is shown on the horizontal axis. For each set of parameters, the model was simulated 1,000 times, and the proportion of incorrect decisions is shown by solid lines. The thin line denotes the proportion of trials for which the decision has not been reached by time t � 100 in the case � � �6. The ERs for � � 0 and � � 6 very closely match the values predicted by Equation 8 and by Equation A55 in Appendix A, respectively (although theoretical predictions are not shown for clarity of the figure). c: ER of the extended O-U model with the variability of starting point in the interrogation paradigm. The model was simulated for the following parameters: mA � 2.19, sA � 0, c � 1 (parameters estimated from data from middle-difficulty condition of Participant S1 in the experiment described in Usher & McClelland, 2001), and sx � 0.5 at interrogation time t � 0.1 s. For each value of �, the O-U model was simulated 20,000 times; the average ER is shown by the solid line. Error bars show the standard error of the mean. 716 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN made for the feedforward inhibition model. In this section, we show that these relationships still hold when drift rate is allowed to vary across trials in these models. In particular, we conjecture that when drift rate is allowed to vary but starting point is held constant, performance of the mutual inhibition model is optimized when decay is equal to inhibition and both take large values (that is, when it approximates the DDM). To test this, we simulated the mutual inhibition model with different values of decay k, while all other parameters were held constant. Specifically, the weight of inhibition9 was set to w � 10, the range of starting points was set to sy � 0, and the remaining parameters were set by fitting the extended DDM to data from a sample participant (see Figure 5) and then determining equivalent parameters for the extended mutual inhibition model as described above in the section entitled Mutual Inhibition Model, O-U Model, and DDM. For each value of decay, the threshold was set such that the ER of the network was 2%. Figure 10a shows the DTs produced by this model. As expected, the shortest decisions are achieved when decay equals inhibition (i.e., k � 10). Even when the parameters are balanced in this manner, the mutual inhibition model only approximates the DDM because its state merely approaches the decision line and remains with high probability in its proximity, rather than moving exactly along the line. As a result, sample paths cross thresholds Z over an interval along which the coordinate x2 takes different values. This is nonoptimal: The SPRT requires a single pair of threshold points. The larger decay and inhibition are, the closer the mutual inhibi- tion model is to the DDM (because attraction toward the line is stronger). Hence, we expect that the balanced mutual inhibition model will achieve the shortest DTs for fixed ERs when decay and inhibition are larger. This prediction is verified in the simulations shown in Figure 10b. The mutual inhibition model was simulated with different values of decay k and inhibition w (maintaining equality of the two), while all other parameters were held constant across simulations. For each value of decay, the threshold was set such that the ER of the network was 10%. Figure 10b shows that as decay and inhibition increase, DT decreases. Furthermore, the mutual inhibition model’s DT approaches that predicted by the opti- mal DDM for a 2% ER, shown by the dashed line in Figure 10b. In summary, the mutual inhibition model approaches optimal performance in the free-response paradigm when decay equals inhibition and both increase in magnitude. Thus, as in the interro- gation paradigm, optimality depends on the equivalence of decay and inhibition. However, in the free-response paradigm, optimality further depends on the absolute magnitude of these parameters. In the extreme, when both decay and inhibition are zero (leftmost point in Figure 10b), the DT in the mutual inhibition model corresponds to that of the race model (because, in this case, the mutual inhibition model becomes precisely the race model; see Figure 4), which has a slower DT than the balanced mutual inhibition model (with any k � w � 0). Figure 10c shows similar results for the feedforward inhibition model: DT for fixed ER � 2% and different weights (u) of the inhibitory connections. The DT for u � 1 again corresponds to the DT of the race model; both leftmost points in Figures 10b and 10c correspond to the same value of DT (the small difference reflects a simulation artifact due to finite sample size). The race model has a slower DT than the feedforward inhibition model (for any u � 0), as it does in comparison with the mutual inhibition model. Note that when the inhibitory and excitatory connections from the inputs are equal (at u � 1, as in the original model by Ditterich et al., 2003), then the feedforward inhibition model achieves the same DT predicted by the DDM (indicated by the dashed line). This is expected because, as described above, in the section entitled Feed- forward Inhibition Model and DDM, when u � 1, the feedforward inhibition model is exactly equivalent to the DDM and hence achieves optimal performance. We do not discuss the feedforward inhibition model further in this article because it can be considered equivalent to the DDM when u � 1. When starting point is allowed to vary, simulations indicate that, as in the case of the interrogation paradigm, balancing decay and inhibition may not be optimal (i.e., for fixed w k, a minimum DT for fixed ER is achieved for w � k). However, we note again that this finding should be considered within the context of a psycho- logical interpretation of the starting point and its relationship to stimulus and response frequencies, which we address below, in the section entitled Variable Signal Strength and Adjustment of Drift Rate. Balanced Systems and Arbitrarily Small Errors For the decision models considered in this article, increasing interrogation time in the interrogation paradigm or threshold in the free-response paradigm leads to increased accuracy. This suggests another sense in which these models may be optimal: We can ask whether ERs can be reduced to arbitrarily small values in the models of these two paradigms.10 We first consider the case of drift being constant across trials (pure models). We show that in the interrogation paradigm, ERs can be reduced to arbitrarily small values for the DDM and the balanced mutual inhibition model (i.e., with decay equal to inhibition). In the free-response paradigm, this is true for both the balanced mutual inhibition model and an unbalanced variant in which decay dominates inhibition. Then, we show that if drift varies across trials, arbitrarily small error cannot be achieved by any of the models (results are summarized in Table 1). The variability of starting point does not influence the ER as threshold or interrogation time goes to infinity. Assuming collapse to a one-dimensional process for the long DTs in question, in what follows we consider only O-U processes that approximate the mutual inhibition model (although, as dis- 9 Note from Figure 9b that, for w � 10, the model performs far from fully optimally. We choose this value to illustrate the robustness of the property that balanced decay and inhibition improve performance—this fact holds even if these quantities are not so large as to enforce collapse of the dynamics to a single dimension. That is, balancing these parameters improves performance even in regimes in which performance is not fully optimal. 10 It must be noted here that humans rarely achieve perfect performance, even when a premium is placed on accuracy and participants are given unlimited time to respond (McElree & Dosher, 1989; Ratcliff, 1978; Reed, 1973; Usher & McClelland, 2001). This discrepancy with certain decision models has been cited as a challenge to their veracity (in particular, by Usher & McClelland, 2001, with respect to the DDM). However, Ratcliff (1988) showed that the imperfect accuracy of human performance in long time limits may be explained by making a simple, biologically plausible modification to the DDM: adding boundaries limiting the maximum and minimum values of the diffusion variable x. We have confirmed this and provided analytical estimates, but we do not treat this issue here, leaving its further study for future work. 717OPTIMAL DECISION MAKING cussed above, we do not depend on this collapse for our O-U model to accurately describe the interrogation paradigm). Interrogation Paradigm The minimum ER that can be achieved by an O-U model (i.e., after interrogation at infinite time) is given by: ER � �� � 2A2���c2� (39) (from Equation 12 above via Equation A94 of Appendix A; Busemeyer & Townsend, 1992; cf. Equation 10 in Usher & Mc- Clelland, 2001). In Equation 39, denotes the normal standard cumulative distribution function, and A and c denote the drift and standard deviation of noise as before. From this formula, it follows that the ER can be arbitrarily close to zero only when � � 0, that is, when decay is equal to inhibition in the mutual inhibition model. Indeed, for � � 0, there is a certain probability of error even for very long interrogation times, although this may be small for high drift rates (i.e., easy decisions). To illustrate this result, Figure 11 shows the evolution of states of the mutual inhibition model for three different ratios of decay and inhibition. These simulations represent moderately difficult decision tasks (mean input to the first unit I1 � 6.1 [s �1], to the a) Mutual inhibition model b) Mutual inhibition model 6 8 10 12 14 0.3 0.35 0.4 0.45 0.5 k D e c is io n T im e [ s ] 0 20 40 60 80 100 120 0.3 0.35 0.4 0.45 0.5 k D e c is io n T im e [ s ] c) Feedforward inhibition model d) Mutual inhibition model 0 0.2 0.4 0.6 0.8 1 0.3 0.35 0.4 0.45 0.5 D e c is io n T im e [ s ] 4 6 8 10 12 14 16 0.428 0.429 0.43 0.431 0.432 0.433 0.434 0.435 k R e w a rd r a te [ re w a rd s /s ] Race Race Diffusion u Figure 10. Performance of mutual and feedforward inhibition models. During all simulations, the following parameters were kept fixed: mI1 � 1.42, mI2 � 0, c � 0.33, sI � 0.22 (the same values as in Figure 8), and sy � 0. Panels a, b, and c show decision time (DT) for the threshold set such that error rate (ER) � 2%. a, b: DT for the mutual inhibition model for different values of inhibition. In Panel a, inhibition is kept constant at w � 10, and decay (k) is varied (shown on horizontal axis). In Panel b, inhibition is equal to decay (w � k), and they are varied together. c: DT for the feedforward inhibition model as the weight of the inhibitory connections (u) is varied (shown on horizontal axis). For each set of parameter values, the threshold was increased from zero in steps of 0.01 until the model reached an ER less than or equal to 2%. For each value of the threshold, 10,000 trials were simulated. The error bars indicate standard error of mean DT estimation. d: Reward rate achieved by the mutual inhibition model with optimal thresholds at different levels of decay. During simulations, the following parameters were kept constant: w � 10; the delays between trials were equal to D � 2, Dp � 0. The decay rate k is shown on the horizontal axis. For each set of parameter values, the threshold was chosen that maximized the reward rate (by simulation), and the model was run for 100 simulated blocks of 10,000 trials each. The lines on the graphs connect the mean reward rates achieved by the model, and the error bars show the standard error across the blocks. 718 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN second unit I2 � 3 [s �1], magnitude of noise c � 1 [s�1]; values corresponding to middle-difficulty condition of Participant S1 in the experiment described by Usher & McClelland, 2001). Fig- ure 11b illustrates the case for the balanced model (when decay equals inhibition). The top section of Panel b shows states of the model from independent trials after 0.5 s: They have already reached the proximity of the decision line but are still located close to their starting midpoint in the x1 direction. The middle section shows model states after 1.0 s. States have begun to diffuse along the decision line, and the mean of the density has moved toward the correct decision (i.e., rightward). The bottom section shows the state of the system after 1.5 s: The density of points has a greater standard deviation in the x1 direction; however, the mean has now moved far to the right so that a great majority of states are on the correct side of the line dividing decisions (x1 � 0; marked as dashed line). A critical property of the pure DDM is that the mean of the probability density of its solutions eventually moves faster than the density spreads so that the probability of being on the correct side of the line dividing decisions (x1 � 0) converges to 1 with time. Indeed, it follows directly from Equation 7 that as T goes to infinity, ER approaches zero. Figure 11a shows the evolution of the states of the system when decay is larger than inhibition (both parameters are modified by 15% from their values in Figure 11b). The evolution along the -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 -4 -2 0 2 4 -4 -2 0 2 4 y 1 y 2 t = 0 .5 t = 1 t = 1 .5 a) Decay > Inhibition b) Decay = Inhibition c) Decay < Inhibition (λ < 0) (λ = 0) (λ > 0) Figure 11. Distributions of solutions to the mutual inhibition model with different values of inhibition (w) and decay (k). Three mutual inhibition models were simulated. In all the models, the signal and noise from the environment were the same, with I1 � 3 �2 2.19, I2 � 3, and c � 1 (parameters corresponding to the parameters of the pure drift diffusion model A � 2.19; c � 1 estimated from data from middle-difficulty condition of Participant S1 in the experiment described in Usher & McClelland, 2001). Dashed lines indicate x1 � 0 axis, dividing correct and incorrect decisions in the interrogation paradigm, and decision lines are shown solid. The models shown in the three panels differed in the ratio of inhibition to decay: a: k � 11.5, w � 8.5 (� � �3); b: k � 10, w � 10 (� � 0); and c: k � 8.5, w � 11.5 (� � 3). Each model was simulated 1,000 times, and the plots show the states (i.e., the activities of decision units) of the simulated models, with each dot corresponding to one simulation. The horizontal axes denote the activations of the first (correct) unit, and the vertical axes denote the activations of the second (incorrect) unit. The states of the models are shown at three moments in time: top sections of panels for t � 0.5 s, middle sections of panels for t � 1 s, and bottom sections of panels for t � 1.5 s. Many states have left the region plotted in the bottom-right (� � 0) panel. 719OPTIMAL DECISION MAKING decision line is now described not by the diffusion process but by a stable O-U process (i.e., � � 0; also see Figure 6a). The middle and bottom sections of Panel a show that the distribution con- verges to a steady state, with little difference between the states at times 1 s and 1.5 s. The mean is influenced by the drift (note that the density is slightly shifted to the right, i.e., in the direction of the drift), but it no longer moves: It has converged to the attracting fixed point described above (see Figure 6a). Interrogation at future times will result in essentially the same proportion of solutions from the stationary distribution on each side of x1 � 0 and therefore with an irreducibly finite number on the wrong side of the x1 � 0 line contributing errors. Figure 11c shows the evolution of model states for decay slightly smaller than inhibition. Evolution along the decision line is now described by an unstable O-U process (i.e., � � 0; also see Figure 6c). The points that, because of noise, initially move to one or the other side of the fixed point tend to remain on that side of the fixed point and be pushed rapidly away from it. Hence, no matter how long the interrogation time is, there will again be a finite fraction of trials on which an error is made. Remarkably, Equation 39 shows that this fraction depends only on the magni- tude of � and not on its sign. Figure 11 also illustrates the causes of the recency and primacy effects in the O-U model discussed above, in the section entitled Ornstein–Uhlenbeck (O-U) Model. When � � 0, as in Figure 11a, the solutions fluctuate around the fixed point, and the effect of inputs decays over time, so that the most recent inputs have the biggest impact on the current state of the model. By contrast, when � � 0, as in Figure 11c, the fluctuations in input at the beginning of the trial strongly influence the response in the interrogation paradigm because, if a state of the model departs from the fixed point sufficiently, the repulsion from the fixed point is so strong that it is likely to remain on the same side of the fixed point. Free-Response Paradigm In contrast to the above results for the interrogation paradigm, for free-response, the minimum achievable ERs depend not only on the extent to which a model is unbalanced (i.e., on the absolute value of �) but also on whether decay or inhibition dominates (i.e., on the sign of �). As we show in Appendix A (Equation A59), if � � 0, then, as the thresholds tend to infinity, ER tends to zero. However, for � � 0, as the thresholds are increased to achieve low ERs, DTs become excessively long (Ratcliff & Smith, 2004): The greater distance of the threshold from origin is now compounded by the fact that when � � 0, there is an interior attracting point (i.e., one that is closer to origin than the threshold; see Figure 11a). This produces solutions that are confined, with exponentially de- caying probability, near that attractor. (Recall from the section entitled Fastest Decisions for Fixed Accuracy: The Free-Response Paradigm, above, that, for fixed ER, when � � 0, DTs are at least expected to be longer than those of the DDM.) Thus, if the threshold is set above a certain level, many decisions will not be made within a given finite time. If the threshold is lowered to the level at which these decisions can be made, there will be always a nonzero fraction of errors. Finally, for the case � � 0 (see Figure 11c), minimum achiev- able ERs as thresholds tend to infinity are finite and given by Equation 39. This is because the unstable process always forces some fraction of solutions across the threshold for the incorrect decision. This is shown in Appendix A (see Equation A58 and recall the definition of ã in Equation A28). It is interesting that this limit of ER as threshold goes to infinity in the free-response paradigm precisely coincides with the limit of ER as DT goes to infinity in the interrogation paradigm when � � 0 but that it does not coincide in the case � � 0.11 Figure 9b summarizes these results by showing how the ER of the O-U process depends on the value of the threshold. Parameters for the simulation in Figure 9b match those for evolution along the decision line in Figure 11. For � � 0, the ER converges to zero for large thresholds. For � � 0, the ER converges to a finite value after which increasing the threshold has negligible effect. For � � 0, although the number of trials with errors decreases to zero for larger thresholds, on a high proportion of trials a decision is not reached within a fixed allotted time (shown by thin line) because expected DTs diverge to infinity. Figure 9b is in agreement with the finding of Busemeyer and Townsend (1993) that lower (more negative) values of � lead to lower values of ER in the free- response paradigm (see left panel of Figure 9 in Busemeyer & Townsend, 1993). Lower Bounds on ER Due to Variability of Drift If the drift in the DDM is selected at the beginning of each trial from a normal distribution with mean mA and standard deviation sA, then on a certain fraction of trials, the drift will be negative (Ratcliff, 1978). Hence, even as time goes to infinity in the interrogation paradigm or threshold is taken to infinity in the free-response paradigm, there is a nonzero probability of error equal to exactly the fraction of trials with negative drift, which is ER � �� mAsA � . (40) Intuitively, this follows from the fact that, for long times, drift always dominates the effects of noise or initial conditions in the DDM. In fact, as long as mA � 0, this value of ER is actually a lower bound on ERs for any value of interrogation time or decision threshold in both the extended DDM and the extended O-U model, as shown in Appendix A (section entitled Lower Bounds on ER Due to Variable Drift). For the O-U model, whether or not this bound is actually obtained depends on the task paradigm (interro- gation versus free response) and the value of �. The main results of Section 4 are summarized in Table 1. A Theory of Optimal Thresholds In any speeded decision task, one has to choose whether to be faster or more accurate. In the DDM (and all of the related models considered above), this speed–accuracy trade-off is determined by the value of the decision threshold. As we have shown, for any 11 This observation could be used to adjudicate models that assume � � 0 (such as the DDM) versus � � 0 by comparing performance in the interrogation paradigm at long interrogation times to performance in the free-response paradigm when strong emphasis has been placed on accu- racy. � � 0 predicts comparable ERs, whereas � � 0 predicts that they will differ. 720 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN given threshold (i.e., for any particular trade-off between speed and accuracy), the DDM is the optimal decision-making process. However, this begs the question, How should the threshold be set to achieve optimal performance? The answer to this question depends, of course, on the criterion that is used to evaluate per- formance, which in turn depends on the goals of the decision maker. There have been a number of efforts to explain human decision-making performance in TAFC tasks in terms of the op- timization of specific criteria (e.g., Edwards, 1965; Gold & Shadlen, 2002; Maddox & Bohil, 1998). Different criteria are optimized by different thresholds, which in turn have different implications for performance. In this section, we consider the various criteria that have been proposed, the derivation of their optimal thresholds, and their relationship to task parameters and performance. We begin by reviewing the various criteria that have been proposed in the literature, including Bayes risk (BR) and RR. In the second section, we find the thresholds that optimize these criteria for the pure DDM, show analytically that there is a unique optimal threshold for each of these criteria, and examine how this depends on task parameters (drift, noise, and the pace of the task). In the third section, we show that, for each criterion, the DDM using the threshold optimal for that criterion outperforms all other decision processes. In the fourth section, we derive an equation that specifies the DT for a given ER (and vice versa) under optimal performance, thus defining a novel optimal performance curve. In the fifth section, we apply our analysis to the extended DDM. Finally, in the sixth section, we address the question of how the optimal threshold is discovered by the decision maker and the implications that this may have for performance. Criteria for Optimality Bayes Risk This criterion was first used by Wald and Wolfowitz (1948) in proving the optimality of the SPRT. It assumes that decision makers seek to minimize a cost function that is the weighted sum of DT and ER:12 BR � c1DT � c2ER. (41) Edwards (1965) generalized this criterion in considering how human participants choose decision thresholds. He considered an experimental paradigm in which (a) observing the stimulus has a cost (c1) that scales with the duration of the observation (partici- pants lose c1 monetary units for each unit of observation time) and (b) there is a payoff matrix for different types of errors (c2). For a payoff matrix with no reward for correct responses and a penalty c2 for errors, Edwards’s cost function reduces to BR. Edwards derived the optimal threshold for the DDM minimizing this cost function (we consider these explicitly in the section entitled Op- timal Thresholds for Different Criteria in the Pure DDM, below). Rapoport and Burkheimer (1971) extended Edwards’s theory, and Busemeyer and Rapoport (1988) designed an experiment to test it, finding that the participants chose decision thresholds close to those minimizing the BR. The assumption that decision makers optimize BR requires further specification of the relative value that they place on speed versus accuracy—that is, the values of parameters c1 and c2 in Equation 41. These values can be inferred from fits to experimen- tal data (e.g., Mozer et al., 2002) or explicitly manipulated (as in the case of Busemeyer & Rapoport, 1988). In contrast, assuming that decision makers optimize RR does not require any further specification; that is, it is a parameter-free criterion. Reward Rate This can be defined as the proportion of correct trials divided by the average duration between decisions, namely (Gold & Shadlen, 2002), RR � 1 � ER RT � D � ER � Dp (42a) � 1 � ER DT � T0 � D � ER � Dp . (42b) In Equation 42a, RT denotes total response time, D the interval between a correct response and the next stimulus (the response– stimulus interval), and Dp an additional penalty delay introduced following an error (which may, of course, be set to zero).13 Following the conventions used in previous sections, Equation 42b decomposes RT into its two components: mean DT and T0, the time required for all non-decision-related (e.g., sensory and motor) processing. This formulation assumes that after each correct deci- sion, participants receive a reward and that after every response, they have to wait a certain interval before the onset of the next stimulus (and hence the possibility of making the next choice). The BR and RR criteria differ in a number of important respects. First, long DTs are penalized differently: BR assumes that there is an explicit cost (e.g., financial) for each additional increment of stimulus observation time, whereas for RR, long DTs simply slow down the rate at which rewards are received. The direct depen- dence of the RR criterion on time also predicts different behavior for different decision–stimulus intervals D and Dp (as is shown later), parameters that do not enter into BR. Most importantly, however, BR and RR have different implica- tions for the emphasis placed on reward versus accuracy. RR, by definition, seeks to maximize reward. As we show further on, optimizing RR may sometimes demand faster and less accurate responding. If the experiment is configured exactly as described in this section (i.e., participants are financially penalized for errors and time spent on decision), minimization of BR is equivalent to maximization of reward. However, in general, BR allows that accuracy may be favored over speed, even if this means receiving less overall reward. A number of studies have suggested that decision makers do sometimes favor accuracy over maximizing reward. Maddox and Bohil (1998) investigated participants’ choices in a version of the interrogation paradigm in which one stimulus is more frequent or more rewarded. They noticed that in this task, 12 For consistency, note that because DT is in units of time and ER is dimensionless, the units of c2 must also be time. This implies the use of a characteristic time to normalize the weights. 13 Such delays are often used in studies of nonhuman animals as pen- alties for incorrect responses, to encourage accurate performance while avoiding the use of aversive stimuli as punishment. 721OPTIMAL DECISION MAKING participants might choose the more frequent or the more rewarded alternative even if the accumulated evidence at the interrogation time favors the other alternative. Let us define the decision bound- ary as the value of variable x in the DDM above and below which different alternatives are chosen (so far, we have assumed that the decision boundary is at 0). Maddox and Bohil suggested that participants choose decision boundaries between the values max- imizing reward and those maximizing accuracy even when they are specifically instructed to maximize reward. The investigators offered three reasons why participants may tend to maximize accuracy: (a) To choose the boundary maximiz- ing reward, participants need to gain knowledge about the distri- butions of the stimuli of different classes (i.e., varying reward value); (b) there is evidence that participants are more concerned about being accurate than about gaining modest rewards (Pitz & Reinhold, 1968; Stevenson, Busemeyer, & Naylor, 1991); and (c) the trial-by-trial feedback about accuracy is often equally or more salient than the feedback about the reward (in psychological ex- periments, participants are often informed if they have made an error, and they may pay more attention to this information than to information about the reward). They also observed large individual differences in the emphases placed on reward versus accuracy among participants. On the basis of these findings, Maddox and Bohil (1998) proposed a model called competition between reward and accuracy (COBRA), which postulates that decision makers pursue a balance between reward and accuracy maximization. Reward/Accuracy and Modified Reward Rate The COBRA theory was proposed in the context of the inter- rogation paradigm. Here, we extend it to the free-response para- digm. Furthermore, since Maddox and Bohil (1998) did not for- mulate an equation for the function being optimized, we consider two different ways of doing so, each of which penalizes errors in a different manner. The first is a reward/accuracy (RA) function that is a weighted difference of RR and accuracy: RA � c1RR � c2 Dtotal ER, (43) where Dtotal � D T0 is the total delay between the end of one decision and the beginning of the next. We assume that penalty delay Dp (from the expression for RR in Equations 42a and 42b) is set to zero because errors are penalized explicitly in the second term of Equation 43. For c1, c2 � 0, maximization of this function emphasizes accuracy by negatively weighting errors (in the second term) in addition to positively weighting correct responses (via RR in the first term). Note that inclusion of Dtotal in the second term allows the units [1/time] to be consistent. The second criterion, a modified RR (RRm), describes the con- dition under which correct responses are rewarded by c1 and errors are penalized by c2: RRm � c1�1 � ER� � c2ER DT � Dtotal . (44) Note that because errors are dealt with explicitly via the second term in the numerator, we again neglect the penalty delay, setting Dp � 0. Also note that Equation 44 is closely related to Equation 43 but that it now includes the full interstimulus interval DT Dtotal in the denominator of the second term. As expected, both RA and RRm reduce to RR when the accuracy weight c2 � 0 (Equation 43 with Dp � 0). COBRA was introduced to explain the observation that decision makers sometimes seem to favor accuracy over a strict maximi- zation RR. However, like the BR criterion, this requires the esti- mation of two parameters (c1 and c2). The question remains whether it is possible to explain decision-making behavior using the parameter-free RR criterion. We return to this question below, after we derive the thresholds for the DDM that optimize the various criteria discussed above. Optimal Thresholds for Different Criteria in the Pure DDM We begin by considering Edwards’s (1965) calculations of thresholds minimizing BR, then derive the thresholds that optimize the three other criteria reviewed above, and examine the depen- dence of optimal thresholds on task parameters. For simplicity, here we consider decisions produced by the pure DDM; in the section entitled Optimal Performance Curves for the Extended DDM, below, we explore the effects of introducing drift rate and starting point variability in the extended DDM. Properties Common to the Criteria for Optimality First, we observe that thresholds optimizing the criteria of Equations 41, 43, and 44 do not depend on parameters c1 and c2 separately but only on their ratio (the values of the functions themselves, of course, do depend on c1 and c2). Therefore, we define a parameter q describing the weighting of accuracy relative to speed or reward: q � c2 c1 . (45) Figure 12 shows thresholds that optimize the four criteria, com- puted by seeking a minimum of BR and maxima of RR, RA, and RRm, respectively (as described further below and detailed in Appendix A). Each criterion corresponds to a row of panels, and each column shows the dependence of the threshold on a particular task parameter while the others are kept fixed. Before focusing on individual criteria, we emphasize features common to all. The leftmost column of Figure 12 shows that, in contrast to the other parameters, the optimal threshold depends nonmonotonically on the drift rate A. If the drift rate is equal to zero, the stimulus contains no information. In this case, the optimal strategy is to guess immediately, and so, the optimal threshold is equal to zero. As the drift rate increases and information becomes available, it becomes advantageous to integrate, and so, the optimal threshold increases. However, as the drift rate becomes sufficiently high, it begins to dominate the noise, so that threshold can again be lowered until decisions can be made almost immediately. The second column from the left shows the dependence of the optimal threshold on noise (c). If c is close to zero, then the drift is not obscured by noise (i.e., the signal is strong) and decisions can be made with little need to integrate information (i.e., average the signal) over time. Thus, the optimal threshold is close to zero. As noise increases, more integration is required to obtain an accurate estimate of the signal, and thus, the optimal value of the 722 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN threshold increases. Interestingly, as noise goes to infinity, the optimal threshold appears to converge to a constant (we prove this for BR and RR below, and we conjecture that it is also the case for the other criteria on the basis of simulations). The third column from the left shows the dependence of the optimal threshold on the total delay Dtotal. As Dtotal decreases toward zero (i.e., the next stimulus is presented immediately after the response, ignoring T0), the optimal value of the threshold also decreases toward zero.14 That is, it is optimal to make decisions immediately because there is no opportunity cost for errors. Al- though responding will be random (because no information has been accumulated) and therefore will produce a reward on only 50% of trials, the arbitrarily high frequency of trials serves to maximize reward.15 As the delay Dtotal increases, so too does the optimal value of the threshold: An increase in the opportunity cost for responding requires that each response be more accurate. There is no limit on the optimal value of the threshold. The rightmost column of Figure 12 shows that for greater emphasis on accuracy (i.e., greater values of q), optimal thresholds 14 For BR, RR, and RRm, the optimal threshold converges to zero as Dtotal3 0. However, for RA, the second term in Equation 43 can dominate as Dtotal decreases to zero, leading to a nonzero limiting value for optimal threshold (not visible in Figure 12 as the minimum of zo[Dtotal] occurs for Dtotal � 0.01 for the parameters used there). 15 Of course, in practice, this could not occur because Dtotal includes T0—the nondecision component of the response time, which includes the time for stimulus encoding and motor response and therefore is necessarily nonzero. Consequently, the optimal threshold will always be nonzero (for A � 0). 0 1 2 0 0.05 0.1 z m in im iz in g B R 0 1 2 0 0.05 0.1 0.15 0.2 0 1 2 0 0.05 0.1 0.15 0.2 0 1 2 0 0.1 0.2 0.3 0.4 z m a x im iz in g R R 0 1 2 0 0.5 1 0 2 4 0 0.1 0.2 0.3 0.4 0 1 2 0 0.1 0.2 0.3 0.4 z m a x im iz in g R A 0 1 2 0 0.5 1 1.5 0 2 4 0 0.1 0.2 0.3 0.4 0 1 2 0.15 0.2 0.25 0.3 0.35 0 1 2 0 0.1 0.2 0.3 0.4 A z m a x im iz in g R R m 0 1 2 0 0.5 1 1.5 2 c 0 2 4 0 0.1 0.2 0.3 0.4 D total 0 1 2 0.15 0.2 0.25 0.3 Dependence on drift A Dependence on noise c Depen. on delays D total Depen. on accuracy weight q q 2 A 2 totalD 2Az c= ∞ 0 totalAD21 4 q 4 Aq 4 A 0 Figure 12. The optimal thresholds for the pure drift diffusion model. Each row shows thresholds optimizing a different criterion (indicated on the left side of the figure). Each column shows the dependence of the optimal threshold on one task parameter (indicated on the top and bottom of the column), with other task parameters held fixed at values chosen from the following: A � 1, c � 0.33 (corresponding to values estimated from a sample participant; see Figure 5), Dtotal � 2 (corresponding to one of the delay conditions in the task performed by the participant), and q � 0.5 (chosen arbitrarily). The values of the optimal thresholds were found numerically. Values at the angles are equal to the rate of increase (i.e., the slope) of the optimal threshold function for the varied parameter equal to zero and are derived analytically. The arrows indicate the values to which the optimal threshold converges as the parameter on the horizontal axis goes to infinity. Panels are omitted where criteria do not depend on those parameters. BR � Bayes risk; RR � reward rate; RA � reward/accuracy; RRm � modified reward rate; Depen. � dependence. 723OPTIMAL DECISION MAKING rise, which can be expected because higher thresholds increase accuracy. Derivation of Optimal Thresholds for Individual Criteria The features above are general to all criteria. Here, we consider how optimal thresholds differ among criteria. Bayes risk. Edwards (1965) has shown that the BR is mini- mized by the threshold z satisfying the following condition (Equa- tion 17 from Edwards, 1965, rewritten in the present notation; for completeness, we derive this in Appendix A, Equation A76): q 2A2 c2 � 4Az c2 � e��2Az/c 2� � e2Az/c 2 � 0. (46) This transcendental equation does not have closed form solutions for z but can be solved numerically, as was done for the first row of Figure 12. Furthermore, the terms can be rearranged so that Equation 46 expresses equality between increasing and decreasing functions of z, thus demonstrating the uniqueness of its solution. It is also useful to note that for low A, high c, or low q, Equation 46 simplifies to z � Aq 4 , (47) which gives the slopes and the limit indicated in the first row of Figure 12. We also note that when q � 0, the accuracy does not influence the BR, and hence, the optimal threshold is equal to zero. Reward rate. This criterion is defined in Equations 42a and 42b in terms of ER and DT. The optimal threshold can be derived by reexpressing these in terms of the parameters of the DDM (drift, noise, and threshold) given by Equations 8 and 9 and then solving for the threshold that maximizes RR. Substitution of these equa- tions into Equations 42a and 42b followed by some algebraic manipulation yields the expression 1/RR � z A � D � T0 � �D � T0 � Dp � zA�e��2zA/c2�. (48) Note that this expression depends only on performance variables and task parameters—that is, it does not rely on any criterion- specific parameters. Note also that the parameters of the pure DDM (A, c, and z) do not occur independently and can be grouped into two new parameters. We define these two new parameters of normalized threshold (z̃) and signal-to-noise ratio (ã) as follows: z̃ � z A , and ã � �Ac� 2 . (49) (The BR threshold condition in Equation 46 may also be written solely in terms of z̃, ã, and q.) Although ã is the squared signal- to-noise ratio, we refer to it simply as the signal-to-noise ratio in what follows. Note that the parameters z̃ and ã fully determine the ER and DT of the pure DDM (Equations 8 and 9).16 With these new parameters, Equation 48 becomes 1/RR � z̃ � D � T0 � �D � T0 � Dp � z̃�e �2z̃ã. (50) The above equation has a unique minimum (as shown in Appendix A, in the section entitled Optimizing Reward Rates for Unbiased Data) at which the RR is maximized, given by the solution of: e2z̃ã � 1 � 2ã�D � Dp � T0 � z̃�. (51) Although this (transcendental) equation does not admit an explicit solution in terms of elementary functions, it may easily be solved numerically for z̃ to yield the optimal threshold (normalized by A), as a function ( f ) of ã and task delays as follows: z̃o � f�ã, D � Dp � T0�. (52) First, we note that the optimal threshold does not depend on D and Dp separately but only on their sum D Dp (or actually on D Dp T0). Hence, for example, the same value of the threshold is optimal for a long intertrial interval but no penalty delay (e.g., D � 2 s, Dp � 0 s) and for a much more rapid pace of presentation but with a corresponding increase in penalty delay (D � 0.5 s, Dp � 1.5 s). Therefore, provided that decision makers optimize their thresholds to maximize RR, they should have the same ER and mean RT in both of these conditions. Let us denote the sum of the three delays influencing the optimal threshold together by Dtotal: Dtotal � D � Dp � T0. (53) The dependence of the optimal threshold on Dtotal (rather than D and Dp separately) is not a property specific to the pure DDM; it is true for any decision-making mechanism (e.g., an O-U model) seeking to optimize RR, as shown in Appendix A (see the section Dependence of the Optimal Threshold on Experimental Delays). Multiplying Equation 52 by A gives the optimal absolute (nonnor- malized) threshold in terms of the original parameters: zo � Az̃o � Af ��Ac� 2 , Dtotal� . (54) The second row of Figure 12 shows how zo depends on the parameters A, c, and Dtotal (see Equations A38 and A39 of Ap- pendix A). In addition to the general properties of optimal thresh- olds described above (and shown in Figure 12), we can define the following quantitative characteristics of the optimal threshold for the RR criterion: (a) It increases logithmically as Dtotal goes to infinity, (b) it converges to ADtotal /2 as c goes to infinity, and (c) it reaches a maximum of c2/A (or 1/ã) as drift increases and then decreases to zero as drift is increased further (see Equations A38–A39 in Appendix A). These relationships should be empir- ically testable. Reward/accuracy and modified reward rate. The expressions specifying the optimal threshold for these criteria are more com- plex and are given in the Equations A78 and A84 of Appendix A. We note here, however, that there is a unique optimal threshold for both of these criteria. This follows from the fact that they are both sums of a function with a single maximum in z (the RR term) and a function that is decreasing in z (the additional accuracy terms). The DDM Optimizes All Criteria Relative to Other Decision-Making Processes Above, we showed that for a given set of task parameters, there is a unique value of the threshold for the DDM that optimizes each 16 Although the new parameters are ratios, they have units: z̃ has units of time, and ã has units of 1/time. (Below, we take the unit of time to be seconds.) 724 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN of the criteria considered. We can also ask how, at optimal per- formance, the DDM compares with other models? Appendix A (section titled Optimality of the Sequential Probability Ratio Test [SPRT]) shows that the optimality of the DDM (in the sense of Wald, 1947, and discussed above in the section called The Deci- sion Problem) also implies that the DDM with optimal threshold for a given criterion gives the minimum BR or the maximum RR, RA, or RRm achievable by any model. In fact, the DDM optimizes any criterion involving accuracy and speed that satisfies the broad conditions specified in Appendix A (section titled Optimality of the Sequential Probability Ratio Test [SPRT]). From these observations, we can further assert that among mutual inhibition models with optimal thresholds, the overall maximum RR will be achieved when decay is equal to inhibition and both are of a sufficient magnitude (see sections Background and Relationships Among the Models, above). Figure 10d dem- onstrates this point for a particular parameter set. By the same reasoning, the O-U model yields optimal RRs when � � 0; the calculations in Appendix A (section titled Optimizing Reward Rates for Unbiased Data) demonstrate this explicitly. Further- more, the exact Equation A57 and its approximate forms that follow may be used to evaluate the extent to which RRs for the O-U model depart from optimality. The Relationship Between ER and DT at Optimal Performance The analyses described above indicate that for a given criterion and set of task parameters, there is a single threshold that will optimize performance of the pure DDM. This threshold defines a specific point in the speed–accuracy trade-off, that is, a specific ER and DT that are optimal for a given criterion and set of task conditions. In this section, we derive an expression for each criterion that describes the optimal ER and DT as a function of task parameters (signal-to-noise ratio ã, delay Dtotal, and, if appropri- ate, emphasis on accuracy q). Each of these expressions describes a relationship between ER and DT at optimality that we refer to as an optimal performance curve. Similar curves can be derived for the extended DDM (as we do below in the section called Optimal Performance Curves for the Extended DDM). To the extent that the curves for different criteria and models can be distinguished from one another, they can be used to generate quantitative, empirically testable predictions con- cerning optimal performance under different decision-making models and criteria. The derivation of optimal performance curves for the DDM builds on the relationship between ER and DT for a given Dtotal, which can be deduced by rearranging Equations 8 and 9 to obtain the expressions for parameters z̃ and ã as a function of ER and DT: z̃ � DT 1 � 2ER , (55) ã � 1 � 2ER 2DT log�1 � ERER � . (56) Bayes Risk Edwards (1965) showed that substituting the above equations into the optimality condition of Equation 46 and rearranging terms yield a direct relation between ER and DT normalized by the weight of accuracy q under conditions of optimal performance defined as minimization of BR (Equation 20 in Edwards, 1965): DT q � �1 � 2ER�log 1 � ER ER 2 log 1 � ER ER � 1 1 � ER � 1 ER (57) (cf. Equation A77 in Appendix A). The left side of this equation expresses the ratio of DT to the parameter weighting accuracy Figure 13. The optimal performance curves for the drift diffusion model. Horizontal axes show the error rate, and vertical axes show the normalized decision time (DT), that is, DT divided by accuracy weight q in Panel a and by total delay Dtotal in Panels b and c. a: Optimal performance curves for Bayes risk (BR). b, c: Optimal performance curves for reward/accuracy (RA) and modified reward rate (RRm) criteria. Each curve corresponds to different values of q ranging from �0.2 (bottom curves) to 0.5 (top curves) in steps of 0.1. The thick line (identical in Panels b and c) corresponds to q � 0; that is, the thick line is the unique optimal performance curve for the reward rate. 725OPTIMAL DECISION MAKING (which, in this case, also has the units of time), whereas the right side is a function of ER alone. Hence, the equation describes a relationship between ER and normalized DTs that we call an optimal performance curve (see Figure 13a). This relationship must be satisfied for any task difficulty level, provided that par- ticipants set their thresholds to minimize the BR under the pure DDM. As noticed by Edwards, when the decisions are very easy (ã � 1), both ER and DT converge to 0 (left side of Figure 13a); when the decisions are very difficult (ã � 0), ER converges to 0.5 and DT to 0 (the optimal strategy is to guess immediately; right side of Figure 13a). According to this analysis, the longest DTs should be about 0.136q and associated with an ER of about 13.5% (peak of the curve in Figure 13a). Reward Rate Analogously, by substituting Equations 55 and 56 into the condition for thresholds maximizing the RR (Equation 51), we obtain the optimal performance curve for this criterion: DT Dtotal � � 1 ER log 1 � ER ER � 1 1 � 2ER� �1 . (58) The left side of the above equation expresses the ratio of time in the trial used on decision processes to the maximum intertrial interval (total response-to-stimulus delay on error trials), whereas the right side is a function only of ER. Hence, the equation describes the relation between ER and normalized DT (as a fraction of maximum intertrial interval). This optimal performance curve is shown as the thick black curve in Figures 13b and 13c. It has a shape similar to that for BR, but the longest DTs are about 20% of the maximum interde- cision interval and are associated with an ER of about 18% (peak of the thick curves in Figures 13b and 13c).17 Reward/Accuracy and Modified Reward Rate In Appendix A (Equations A80–A81), we derive analogous optimal performance curves for RA and RRm, respectively (Equa- tions 59–60): DT Dtotal � E � 2q � �E2 � 4q�E � 1� 2q , where E � 1 ER log 1 � ER ER � 1 1 � 2ER , (59) DT Dtotal � �1 � q�� 1 ER � q 1 � ER log 1 � ER ER � 1 � q 1 � 2ER� �1 . (60) The right-hand sides of the above equations contain the additional parameter q, hence they do not describe a single curve but rather a family of curves for different values of q. As q approaches zero, both of these expressions converge to Equation 58 because, in this case, both criteria simplify to the RR. These families are shown in Figures 13b and 13c. Note that the RA and RRm criteria differ in their predictions: For RA, the value of q does not influence the ER corresponding to maximum DT (i.e., the position of the peak), whereas, for RRm, increasing q moves the peak to the right. These observations provide a framework for constructing and testing the extent to which and under what conditions participants maximize these different criteria for optimality. Optimal Performance Curves for the Extended DDM In this section, we compute the optimal threshold and optimal performance curve for the extended DDM. For simplicity, we consider only one criterion of optimality: RR. Optimal perfor- mance curves for the other criteria can be derived similarly, and we have also computed them for the O-U model with � � 0 (results not shown here). The variability in drift rate and starting point introduced in the extended DDM have a direct influence on the optimal threshold for the different criteria. Figure 14a shows that as the variability of drift increases, the optimal threshold first slightly increases, but then the information content of the drift becomes lower, and the optimal threshold decreases. Numerical simulations show that as the variability of drift goes to infinity, the optimal threshold goes to zero because the drift ceases to carry any useful information and the optimal strategy is to guess. Figure 14b shows that as the variability of starting point increases, the optimal threshold also increases. Because the extended DDM assumes that the threshold in general must be higher than the range of starting points sx, the optimal threshold is higher than sx. It should be emphasized that in Figure 14b, starting point variability reflects noise in the initial conditions of the integrator and not changing prior probabilities of alternatives (the threshold maximizing RR when the starting point correctly represents stimulus probabilities is discussed below, in the section entitled Biased Decisions). Figures 14c and 14d show the optimal performance curves for the extended DDM for different values of Dtotal. These curves were determined as follows: Parameters sA, sx, Dtotal, and mA were fixed, and c was varied to obtain the different points on the curves (i.e., for each value of c, the optimal threshold was found numer- ically, and a point was added to the graph with corresponding values of ER and DT). Four observations can be made about these curves. First, the shape of the curve depends on the value of Dtotal (unlike for the pure DDM). Second, the variability of drift moves the optimal performance curve down, as would be expected, because it pre- dominantly decreases the optimal threshold (see Figure 14a). Third, the variability of starting point moves the optimal curve up, as would be expected, because it increases the threshold (see Figure 14b). Finally, with variability of starting point, the optimal normalized DT for ER � 0 is not equal to zero. This is because the extended DDM assumes that the threshold must be higher than the range of starting points, so it cannot be equal to zero, which is required for DT � 0. Figure 14d shows that if Dtotal is very low, the optimal performance curve with variability of starting point becomes monotonically decreasing. 17 We recognize, however, that this relationship may not be valid for intertrial intervals exceeding certain values (e.g., intertrial intervals of order of minutes) because, for very large Dtotal, the optimal threshold may be very large (see Figure 12a) and exceed the maximum biologically allowed firing rate of decision neurons. 726 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN Threshold-Setting Algorithms Above, in the section Optimal Thresholds for Different Criteria in the Pure DDM, we derived expressions for the thresholds that optimize various criteria for a given set of task parameters. This raises the question, How do decision makers identify this optimal threshold? In this section, we review published work addressing this question, and we show that any adaptive threshold-setting model makes two predictions for a task in which participants maximize RR: (a) They will choose thresholds closer to optimal values for easier versus harder tasks, and (b) they will tend to choose thresholds at higher than optimal values. One possibility is that the knowledge of optimal threshold is intrinsic; that is, the decision maker comes to the task with com- plete knowledge of the relationship between task parameters (sig- nal, noise, delay, and their variability) and the optimal threshold. Although this may be possible for highly practiced tasks within a narrow domain of parameters, it seems unlikely more generally and certainly for novel tasks. Here, we consider the more plausible (or at least more general) alternative that the decision maker has no intrinsic knowledge of the optimal threshold but is able to deter- mine (or approximate) it using an adaptive adjustment procedure: Different values of the threshold are sampled, the effects on a criterion are observed, and the threshold is adjusted to optimize the criterion.18 Several studies have examined this possibility. Review of Threshold Setting Myung and Busemeyer (1989) performed an experiment using the free-response paradigm19 in which participants were explicitly required to minimize BR. They tested predictions of two algo- 18 Note that such an adaptive mechanism is likely to be required even if the relationship of task parameters to optimal threshold is known. This is because unless the task parameters are explicitly specified at the outset, they must be discovered. This, in turn, requires sampling at some threshold that is most likely not optimal (because the optimal one is not yet known) and that therefore must be adapted as the task parameters are discovered. 19 In this experiment, participants were presented with successive “re- sults of medical tests” until they made a choice of “diagnosis.” Thus, DT (in the equation for BR) for this experiment corresponded to the number of medical tests the participant observed before the diagnosis. a) b) 0 0.5 1 0.1 0.15 0.2 0.25 Drift variability O p ti m a l th re s h o ld 0 0.1 0.2 0.1 0.15 0.2 0.25 Starting point variability O p ti m a l th re s h o ld c) d) 0 0.1 0.2 0.3 0.4 0.5 0 0.05 0.1 0.15 0.2 0.25 Error rate M e a n n o rm a liz e d d e c is io n t im e sA=0, sx=0 s A =0, s x =0.14 s A =0.31, s x =0 0 0.1 0.2 0.3 0.4 0.5 0 0.05 0.1 0.15 0.2 0.25 Error rate M e a n n o rm a liz e d d e c is io n t im e sA=0, sx=0 s A =0, s x =0.14 s A =0.31, s x =0 ∞ 0 Figure 14. Optimal thresholds and optimal performance curves for the extended drift diffusion model (DDM). a, b: Dependence of the reward-rate-maximizing threshold for the extended DDM on drift variability (Panel a) and starting point variability (Panel b), with other parameters held fixed. The values of the varied parameters are shown on horizontal axes, and the values of the fixed parameters were equal to sx � 0.14, mA � 1, sA � 0.31, c � 0.33 (corresponding to values estimated from a sample participant; see Figure 5), and Dtotal � 2 (one of the delay conditions performed by the participant). c, d: Optimal performance curves for the extended DDM, obtained numerically by varying noise parameter c while other parameters were kept fixed: mA � 1, sx and sA as shown in figure legend, Dtotal � 2 in Panel c, and Dtotal � 0.5 in Panel d. 727OPTIMAL DECISION MAKING rithms for updating the decision threshold: (a) an error correction model, which assumed that participants increase the threshold after an error and decrease it after a correct response, and (b) a hill- climbing model, which assumed that after receiving a reward, participants make the same threshold modification as on the pre- vious trial, whereas after an error, they make a threshold modifi- cation opposite to that on the previous trial (this algorithm imple- ments gradient-based reinforcement learning). Analysis of the experimental data suggested that both processes of threshold mod- ification were in operation. During the course of the experiment, participants’ thresholds converged close to the vicinity of the optimal value, but convergence was slow and required hundreds of trials. Later work of Busemeyer and Myung (1992) showed that hill climbing describes experimental data better than error correction. Erev (1998) proposed a different reinforcement-learning algo- rithm for adjusting the decision boundary in the interrogation paradigm. His algorithm did not involve gradients (i.e., differences between decision boundaries on sequential trials) but assumed that (a) there is a finite set of decision boundaries from which partic- ipants choose, (b) participants store estimates of reward for each value of the decision boundary and update these estimates after each trial, and (c) the probability of choosing a certain decision boundary on a given trial is a function of this estimate. This algorithm is an extension of a reinforcement-learning algorithm described in chapter 2 of Sutton and Barto (1998) and was shown to account for a large number of effects observed in the experimental data. Maddox and Bohil (1998, 2001) and Bohil and Maddox (2003) observed that participants in their generalized interrogation para- digm task (see the section entitled Criteria for Optimality, above) chose decision boundaries closer to the value maximizing reward for stimuli that were easier to discriminate (d� � 2.2) than for more difficult stimuli (d� � 1). They explained this fact by noticing that the reward as a function of decision boundary is steeper for easier than for difficult stimuli and hence that learning of the criterion maximizing reward is more rapid and robust for easier stimuli. Threshold Adaptation and the DDM We now consider threshold adaptation in pure DDM to maxi- mize RR. If a hill-climbing procedure (Myung & Busemeyer, 1989) or Erev’s (1998) method is used, this process is guaranteed to converge on the threshold maximizing the RR because we have shown that there is a single optimal threshold for a given set of task parameters and that RR drops monotonically as the threshold moves away from the optimal one (because the optimal threshold z̃o defined by Equation 51 is the only threshold for which the deriv- ative of RR with respect to z̃ is zero; see Appendix A, Equation A33). Recently, Simen, Cohen, and Holmes (2006) and Simen, Holmes, and Cohen (2005) proposed a different threshold-adaptation model that converges very rapidly to the threshold maximizing the RR. Below, we focus on predictions common to algorithms that iteratively con- verge to optimal thresholds, rather than on their distinctions. Figure 15 shows the RR as a function of the normalized decision threshold (defined above, in the section entitled Optimal Thresh- olds for Different Criteria in the Pure DDM, as z/A) for three different levels of signal-to-noise ratio. Note that the RR is a steeper function of the threshold for higher signal-to-noise ratios. This provides an explanation of the observation made by Maddox and Bohil (1998, 2001) regarding RR maximization in the inter- rogation paradigm and suggests that it should generalize to the free-response paradigm: The easier the task, the closer the decision threshold should be to its optimal value. Furthermore and perhaps most interestingly, considering the effects of adaptive threshold adjustment may explain the frequent observation that participants appear to favor accuracy over (or in addition to) reward maximization (Maddox & Bohil, 1998, 2001). From the perspective of pure RR maximization, this amounts to threshold overestimation. However, this may reflect an adaptive bias that is intrinsic to the threshold estimation procedure. Fig- ure 15 plots RR as a function of threshold. Note that on the right side of the peak (denoting the optimal threshold, z̃o), the curve falls with a shallower slope than on the left side. Thus, overestimation of the threshold by a small value ε gives higher RR than under- estimation by the same amount; that is, RR�z̃o � ε� � RR�z̃o � ε�. (61) Appendix A (see section Threshold Resulting From Learning) shows that the above inequality is satisfied for all signal-to-noise ratios and experimental delays. That is, overestimation of the threshold is in general less costly than underestimation. Therefore, with any uncertainty of estimation, there should be a bias toward threshold overestimation.20 Furthermore, if participants use a 20 These considerations suggest that we should in fact consider the distribution of thresholds (rather than the single deterministic value) that maximizes RR, with the prediction that the mean of this distribution will be greater than the single deterministic value. The characteristics of this distribution will be determined by factors such as RR sampling error and other sources of noise, which are parameters that control the degree of bias toward threshold overestimation. ε−oz ~ o ~ ε+o ~ 0 0.1 0.2 0.3 0.4 0.5 0.5 0.55 0.6 0.65 0.7 0.75 0.8 0.85 0.9 Normalized threshold R e w a rd r a te a=14.1 a=9.1 a=4.0 ( )+oz~RR ( )−o~RR a~ a~ a~ z z z ε ε Figure 15. The reward rate (RR) for the drift diffusion model as a function of the normalized threshold z̃ (shown on the horizontal axis) for D � 1 s, Dp � 0 s, T0 � 0 s, and the values of ã corresponding to those estimated from three sample participants of the experiment described in the text section entitled TAFC Experiment and Fit of DDM (the values are shown in the figure legend; ã � 9.1 corresponds to the participant whose performance was illustrated in Figure 5). z̃o indicates the optimal normalized threshold for the case ã � 14.1, and ε denotes a small deviation. Note that underestimation of the threshold by ε causes greater decrease in the reward rate than overestimation. 728 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN gradient-based learning algorithm to find the threshold, it is easier to establish the sign of the gradient of RR for z � zo, where RR(z) is steeper, than for z � zo, where RR(z) is shallower. Hence, it is easier to discover that the threshold should be increased when z � zo than to discover that it should be decreased for z � zo. 21 These factors suggest an account, strictly in terms of RR maximization, of the often-observed bias toward threshold overestimation with- out having to assume any additional criteria concerning accuracy such as RA and RRm. Biased Decisions When one of the alternatives of the decision process is correct more often than the other (e.g., one stimulus occurs more fre- quently in a TAFC task), then decision makers may use this information about the prior probability of the alternatives to opti- mize their responses. In this section, we consider how this can be addressed formally by the DDM. We begin by reviewing existing theories about performance under conditions of biased alternatives, both when signal strength is kept constant and when it is varied from trial to trial, and compare these with existing experimental data. We then consider how asymmetries in the probability as well as the reward value of each alternative influence the optimal threshold, find the relationship of ER to DT for this threshold, and relate these theoretical results to existing experimental data. Biased Probabilities and the Optimal Starting Point In this section, we review three theories of how the starting point of integration in the pure DDM should depend on prior probabil- ities of the two alternatives (Carpenter & Williams, 1995; Ed- wards, 1965; Link, 1975). Let us use � to denote the probability of the alternative correspond- ing to the upper threshold z being correct. Edwards (1965) showed that the optimal decision process (SPRT) in this case is the DDM with the starting point not at x0 � 0, as for the unbiased case, but at a position x0 reflecting the odds of the prior probabilities of alternatives (cf. Appendix A, section entitled Minimizing ER for Biased Choices): x0 � c2 2A log � 1 � � , or x0 2A c2 � log � 1 � � . (62) Figure 16a confirms that x0 given by Equation 62 is optimal by demonstrating that, for a given threshold, it produces the minimum DT for a fixed ER. Note that according to Equation 62, we recover x0 � 0 for � � 1⁄2 (the unbiased case). More generally, however, the optimal starting point is proportional to the log of the ratio of prior likelihoods for the two alternatives. Hence, as the probability of a given response increases, the optimal starting point moves toward the threshold corresponding to that response. Furthermore, 21 We note that standard reinforcement-learning algorithms for learning a single variable (chapter 2 of Sutton & Barto, 1998) also predict that decision makers will set higher than optimal thresholds. For example, the action-value method with soft-max selection (Sutton & Barto, 1998) would build estimates of the values of RR for different thresholds on the basis of the rewards experienced and choose a new threshold on each trial, with the probability being a monotonic function of the estimated RR for that threshold. Thus, from Inequality 61, the probability of choosing threshold z̃o � ε would be lower than probability of choosing z̃o ε. a) b) 0 0.02 0.04 0.06 0.08 0.1 0.18 0.185 0.19 0.195 0.2 0.205 0.21 Starting point x 0 D T [ s ] 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 -3 -2 -1 0 1 2 3 Π 2 x 0 A /c 2 Min ER Min DT Laming Link VanZandt Figure 16. Optimal starting point for biased decisions. a: Mean decision time ([DT] y-axis) for the biased- probability drift diffusion model (DDM) at fixed accuracy (error rate [ER] � 2%) and different starting points (x-axis). DTs were obtained numerically using Equations A44 and A45 from Appendix A for drift A � 1, noise c � 0.33 (estimates from the participant shown in Figure 5), and probability of one of the alternatives � � 0.7. Dashed line indicates position of the optimal starting point predicted by Equation 62. b: Dependence of the starting point of the pure DDM (scaled; see vertical axis) on the prior probability � of the alternative with positive drift A (horizontal axis). Solid line shows the starting point minimizing DT for fixed ER, obtained from Equation 62. Dashed line shows the starting point minimizing ER for fixed threshold, obtained from Equation 63. Circles indicate starting points estimated from the experiment of Laming (1968) by Link (1975, Table 2), squares indicate starting points estimated by Link from his experiment (Link, 1975, Table 6), and stars indicate starting points estimated from the experiment of Van Zandt, Colonius, and Proctor (2000) by Ratcliff and Smith (2004, Table 8; the value of the drift was taken as the average of mean drifts for the two alternatives: [0.2161 0.3659]/2). 729OPTIMAL DECISION MAKING this effect is amplified as the decision becomes more difficult (i.e., the signal-to-noise ratio decreases). The dependence of the optimal starting point x0 on the prior probability � is shown by the solid line in Figure 16b. The pure DDM with starting point given by Equation 62 minimizes ER in the interrogation paradigm (as shown in the Appendix A section entitled Minimizing ER for Biased Choices) and implements the SPRT in the free-response paradigm, hence it optimizes all four reward-based criteria ana- lyzed in the section A Theory of Optimal Thresholds, above. Link (1975) considered a different criterion of optimality: min- imum ER for fixed decision threshold in the free-response para- digm. Although this may seem similar to the criterion of minimum DT for fixed ER that is optimized by Equation 62, Link showed that the optimal starting point in this case is halfway between zero and that of Equation 62, namely, x0 � c2 4A log � 1 � � or x0 2A c2 � 1 2 log � 1 � � . (63) This dependence of starting point x0 on the prior probability � is shown by the dashed line in Figure 16b. The differential predic- tions of Equations 62 and 63 are contrasted with experimental data in the next section. Carpenter and Williams (1995) proposed a theory for the start- ing point of integration explaining the dependence of DT on prior probability �. However, their model assumes two separate neural integrators, each accumulating evidence for detection of one alter- native (in a manner similar to the race model). As we showed in the section titled Background, above, this type of model cannot be reduced to the DDM, which is the optimal process for the discrim- ination tasks that are the focus of this article; therefore, we do not consider the Carpenter and Williams model further. Experimental Tests of the Optimal Starting Point Although the theories of Edwards (1965) and Link (1975) were proposed several decades ago, we are not aware of a systematic comparison of their predictions with experimental data. In this section, we show that predictions of Edwards’s theory match better than those of Link’s theory with results of three experiments performed by Laming (1968), Link, and Van Zandt et al. (2000) and further analyzed by Ratcliff and Smith (2004). To perform such a comparison, it is necessary to estimate the parameters of the pure DDM (e.g., drift, starting point, and thresh- old) from experimental data for tasks with biased alternatives. Ratcliff and Smith (2004) estimated parameters for the extended DDM (using methods similar to those described above, in the section titled TAFC Experiment and Fit of DDM) from the data of Van Zandt et al. (2000) and found that variability of drift sA and starting point sx were an order of magnitude smaller than other model parameters (mA, z). Therefore, in what follows, we make the simplifying assumption that this task can be described by the pure DDM. Link (1975) made this assumption at the outset and used it to develop the following direct method of parameter estimation from data. Denote the alternative corresponding to the negative threshold in DDM by � and the other alternative, corresponding to the positive threshold, by . Denote the probability of choosing the alternative � if the stimulus is presented by P�� (i.e., this is the probability of an error if stimulus is presented) and analogously P � , P���, and P ��. All these probabilities can be directly estimated from the data (for example, P�� can be esti- mated as the number of trials in which participant chose � while was presented divided by the total number of trials in which was presented). Link showed that the value of the starting point chosen by the participant (scaled by 2A/c2) may be estimated from data using the following equation: x0 2A c2 � 1 2 log�P���P�� P �� P � � , (64) and he computed this quantity for his own experiments and those of Laming (1968). Note that in deriving Equation 64, Link did not assume any theory of how participants choose the starting point but assumed only that responses were generated according to the pure DDM; hence, the estimates from Equation 64 may be used to contrast predictions of Equations 62 and 63. In Figure 16b, we show that the starting points (scaled by 2A/c2) estimated by Ratcliff and Smith (2004) and Link (1975) are closer to the predictions of Equation 62 than those of Equation 63 for all three experiments, and for the data of Laming (1968), this differ- ence is significant (paired t test, p � 0.04). Such an outcome can be expected because the starting point of Equation 62 optimizes criteria directly based on reward (i.e., RR or other measures discussed in the section entitled A Theory of Optimal Thresholds, above), whereas the starting point of Equation 63 minimizes ER for fixed threshold and does not optimize the RR. This result provides support for the hypothesis that decision makers adapt parameters to maximize the experimental reward. Below, we do not discuss the criterion optimized by Equation 63 further, and for simplicity, we refer to the starting point of Equation 62 as optimal. Variable Signal Strength and Adjustment of Drift Rate In this section, we review the argument that when drift varies across trials and one of the alternatives is more probable, optimal performance is obtained by biasing both starting point and drift. We also verify the predictions of this theory with further experi- mental data from the literature. Ratcliff et al. (1999) observed that decisions can be biased toward the more probable alternative within the DDM model in two ways (see Figure 32 of Ratcliff et al., 1999): (a) by moving the starting point toward the threshold for the more probable alterna- tive (as in Equation 62) or (b) by increasing the drift in the direction of the more probable alternative and decreasing it for the other alternative. As shown by Edwards (1965; see the section titled Biased Probabilities and the Optimal Starting Point, above), the optimal strategy for tasks with constant signal strength is to adjust the starting point and not the drift rate. However, if signal strength (e.g., stimulus difficulty) varies among trials within a block, then a correction of the drift rate, in addition to that of the starting point, is required to achieve optimal performance (Yang et al., 2005). Analyses of experimental data indicate that these different strat- egies are indeed used depending on the manipulations of signal strength across trials. In an experiment by Van Zandt et al. (2000), participants made same–different judgments about pairs of letters, and the probability � of one type of stimulus was varied between blocks. Recall from the section Experimental Tests of the Optimal Starting Point, above, that for this experiment, the estimated 730 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN variability of drift sA across trials was an order of magnitude lower than mean drift mA. Ratcliff and Smith (2004) noticed that to accurately describe the data of Van Zandt et al., it sufficed to vary only the starting point x0 to fit conditions of different prior prob- ability � while mean drift mA remained constant (one value of parameter mA was used for different � conditions). By contrast, Ratcliff et al. (1999) reported that for their experiment, in which difficulty was varied across trials within the same block, both starting point x0 and mean drift mA had to be allowed to vary significantly to fit performance in conditions of different prior probability. Furthermore, Ratcliff (1985) estimated parameters of pure DDM from data of Proctor and Rao (1983) and Proctor, Rao, and Hurst (1984) and found that both starting point x0 and drift A varied between conditions of different prior probability. Both experiments of Proctor and Rao and Proctor et al. involved the same task: to discriminate whether two strings of four letters were the same or different where the strings differed by at most one letter. Although the experiments did not involve explicit variability in difficulty across trials, it is reasonable to assume that, for example, noticing a disparity between strings differing in the first letter is easier than for strings differing in the third letter, making such variability implicit for this task design. In summary, when asymmetries in the probability of alternatives are introduced, adjustments in the starting point of integration are sufficient to achieve optimal performance, and this appears to be what participants do. However, when variations in signal strength (such as stimulus difficulty) are also present, then an adjustment in drift rate is also required, and again, there is evidence that partic- ipants respond accordingly. These analyses have interesting implications for the neural network models described earlier and, in particular, for the optimal initial values of unit activities in the balanced mutual inhibition model. First, consider the case of constant signal strength across trials. According to the first of Equations 18 (describing the relationship between the activities of the decision units in the mutual inhibition model and the variable x in the pure DDM), the difference between initial activities of the decision units should be equal to �2x0 (where x0 is given by Equation 62). This can be achieved if the decision unit corresponding to the more probable alternative receives external input before the decision process. However, this input must cease when the signal appears and the decision process starts (implementing a bias in the prior expecta- tion but not the processing of information supporting that alterna- tive). Similar biases were used by Cho et al. (2002; although there they were allowed to persist during processing) in a mutual inhi- bition model to simulate the influence on RT and ER of changes in the local probabilities of stimuli in a sequence (experimentally manipulated by controlling the frequency of repetitions and alter- nations in the sequence of stimuli). In the case of varying signal strength between trials, the analyses above indicate that drift rate should also be modified. According to Equation 28 (describing the relationship between mean drift in the extended DDM and mean inputs to the units of the extended mutual inhibition model), the unit corresponding to the more probable alternative should, in addition to starting with an activity closer to its threshold, also receive external input during the decision process itself. However, the magnitudes of the input before and after onset of the stimulus need not be equal. Below, we focus on the simpler case of constant signal strength across trials. Endogenous Variations in Drift Rate and Starting Point (Extended DDM) In the preceding sections, we considered how parameters of the pure DDM (starting point and drift rate) should be adapted to optimize performance in response to manipulations of exogenous factors—namely, stimulus probability and strength. Furthermore, we observed that there were specific optimal values of these parameters for a given set of task conditions—that is, a fixed adjustment of starting point for a particular stimulus probability and a fixed adjustment of drift rate for a particular distribution of stimulus strengths. These observations should be distinguished, however, from the fact that fits of the DDM to empirical perfor- mance are best when variability of drift and starting point are included in the model (Ratcliff et al., 1999). These concern en- dogenous variability of parameters from trial to trial and should therefore be distinguished from the fixed adjustments of parame- ters that are optimal in response to exogenous factors such as asymmetric stimulus frequency and variable stimulus strength. Indeed, the variability of drift and starting point in the extended DDM can improve fits to empirical data even when stimuli occur with equal frequency and fixed strength (Ratcliff & Rouder, 1998). In this case, such variability is clearly not optimal. In this section, we discuss how such observations can be explained within the optimality framework. One source of the variability of drift in the extended DDM may reflect variability of top-down attention. Although this necessarily compromises optimality of task performance, elsewhere we have argued that such variability may serve an adaptive function on a broader scale, reflecting a trade-off between the value of optimiz- ing performance in the current task and exploring alternative opportunities for reward (Aston-Jones & Cohen, 2005). Similarly, it is possible that the variability of the starting point reflects the function of other adaptive mechanisms operating on incomplete knowledge. For example, if the participant is not told the fixed probability with which each stimulus will occur, this must be inferred from observations about the frequency of their occurrence. Initial estimates will be subject to sampling error and suggest starting points that are not appropriate for the true under- lying probability of the stimuli. As estimates of stimulus frequency are revised, the starting point will be adjusted. In addition to this source of variability, there is substantial evidence that the decision- making apparatus is sensitive to the recent history of stimuli and responses, irrespective of knowledge about their overall probabil- ity. For example, several investigators have demonstrated priming effects based on local sequences of stimuli and responses (even when participants have been told that stimuli occur at random) that can be explained in terms of simple mechanisms sensitive to local repetitions and alternations that bias responding in a manner com- parable to a shift in the starting point of the DDM (e.g., Cho et al., 2002). Although such mechanisms are not optimal for processing truly random events, they may reflect adaptations that are well suited to the processing of more natural stimuli that exhibit local sequential structure. The operation of such mechanisms could con- tribute to variability of starting point captured by the extended DDM. Biased Probabilities and the Optimal Decision Threshold In this section, we show that the decision threshold of the pure DDM maximizing RR is little influenced by the probability bias �, 731OPTIMAL DECISION MAKING but above a certain �, the optimal starting point exceeds the optimal threshold, implying that the best strategy is to always choose the more probable alternative. Edwards (1965) showed that there is a unique value of the decision threshold for the pure DDM that minimizes BR and derived conditions that it must satisfy for different prior probabil- ities of alternatives. Similar to the case of BR, there is a unique value of the decision threshold maximizing the RR that satisfies the following equation: e2z̃ã � 1 � 2ã�Dtotal � z̃� � �1 � 2��log � 1 � � . (65) This expression is derived in Appendix A (Equation A50). Note that when � � 1⁄2 , the last term of Equation 65 vanishes, and it simplifies to the condition for the optimal threshold in the unbiased case of Equation 51. As the probability of the more frequent alternative � deviates from 1⁄2 , the optimal threshold decreases slightly, as shown for sample parameters in Figure 17a. The modest effect of � on the optimal threshold contrasts with its more profound effect on optimal starting point: As � grows, the optimal starting point x0 increases without bound toward the threshold (as discussed in the previous section and illustrated in Figure 17a). Above a certain probability bias �, the optimal starting point exceeds the optimal threshold. In this case, the strategy maximizing RR is to forgo integration altogether and always choose the more probable alternative immediately upon stimulus onset (i.e., DT � 0). That is, the task transitions from a discrimination to a signal-detection task. The point at which this occurs is determined by setting x0/A � zo/A � z̃o in Equation 65 and depends on ã and Dtotal. The critical signal-to-noise ratio at which the optimal starting point reaches the optimal threshold is given by ãc � 2� � 1 1 � � � 2� log � 1 � � 2Dtotal . (66) Note that, as for the optimal threshold, this expression depends only on the total delay Dtotal and not individually on D or Dp. Similarly, the critical intertrial delay at which the starting point reaches the threshold is given by Dtotal c � 2� � 1 1 � � � 2� log � 1 � � 2ã . (67) In other words, for any signal-to-noise ratio that is below ãc or intertrial delay shorter than Dtotal c , integration does not improve RR, and information about the biased probabilities alone is suffi- cient for optimal decisions. Figure 18c plots a surface of critical delays Dtotal c as a function of ã (� A2/c2) and �. For delays shorter than Dtotal c , optimal decision makers should immediately choose the most frequent alternative without integrating. Note that Dtotal c decreases to 0 as � tends to 0.5 for all ã because, as we have shown, for unbiased alternatives (and all nonzero values of Dtotal, A, and c), the optimal strategy requires some integration. Also note that Dtotal c decreases as ã ([A/c]2) increases, reflecting the greater value of integration for more informative stimuli. Figure 17b shows ER as a function of �, when x0 and z are set to their optimal values, and signal-to-noise ratio ã is fixed. As � increases, ER also increases (because thresholds come in; cf. Figure 17a) as long as decision making still relies on integration. When x0 reaches the optimal threshold (e.g., as � is increased), ER exactly matches that achieved by always selecting the more probable alternative, namely, limx03z̃o ER � 1 � �. Then, after the switch to prior- based decision making (i.e., signal detection), as � further in- a) b) c) 0.5 0.6 0.7 0.8 0.9 1 0 0.05 0.1 0.15 0.2 x 0 / z o x 0 z o 0.5 0.6 0.7 0.8 0.9 1 0.01 0.02 0.03 0.04 0.05 0.06 0.07 Π E R 0 0.1 0.2 0.3 0.4 0.5 0 0.1 0.2 Error Rate N o rm a liz e d D e c is io n T im e =0.5 =0.6 =0.7 =0.8 =0.9 Π Π Π Π Π Π Figure 17. Maximization of reward rate for biased decisions. a: The optimal threshold zo (solid line) and the optimal starting point x0 (dotted line) as functions of prior probability � (x-axis) for fixed parameters A � 1, c � 0.33 (values corresponding to the data of Figure 5), and Dtotal � 1. There are no data points for � � 0.93 because for these probability biases, the optimal strategy does not involve integration of input. b: Error rate ([ER] y-axis) as a function of probability bias (x-axis) for fixed parameters A � 1, c � 0.33, and Dtotal � 1, and for optimal values of z and x0 shown in Panel a. c: The optimal performance curves generalized for biased decisions. The five curves correspond to different prior probabilities �. The horizontal axis shows ER; the vertical axis shows decision time normalized by Dtotal. The right endpoint of each curve corresponds to immediate responding with ER � 1 � �. 732 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN creases, ER decreases. That is, the ER at the transition point is, nonintuitively, the maximum ER achieved for any value of � (assuming optimal performance). These relationships make inter- esting predictions regarding empirical performance, for example, that ER should be jointly determined by the probability bias (�) and Dtotal until it reaches the immediate response limit 1 � � (Equation 62). A study to test these predictions has been performed, and data are currently being analyzed (P. A. Simen, personal communication, August 23, 2006). Relationship of ER to DT for Biased Stimuli Analogous to the unbiased case, we can also compute optimal performance curves for RR maximization in the biased case by reexpressing z̃ and ã as functions of ER, DT, and � (assuming that participants set their starting points optimally according to Equa- tion 62). Doing so (using Equations A46 and A47 of Appendix A), we obtain z̃ � DT 1 � 2ER � g��� log 1 � ER ER , (68) where g��� � �1 � 2��log � 1 � � , (69) and ã � 1 � 2ER � g��� log 1 � ER ER 2DT log 1 � ER ER . (70) Substituting the above equations into the optimal threshold con- dition of Equation 65 and rearranging terms, we obtain a general- ized optimal performance curve for the biased case: a) b) 0 2 4 6 8 10 -0.08 -0.06 -0.04 -0.02 0 0.02 0.04 0.06 0.08 x 0 D total Probability Reward proportion 0.2 0.3 0.4 0.5 0.6 0.7 0.8 -0.08 -0.06 -0.04 -0.02 0 0.02 0.04 0.06 0.08 x 0 Probability / Reward proportion Probability Reward proportion c) d) 0.5 0.6 0.7 0.8 0.9 2 3 4 5 0 1 2 3 4 5 Bias Probability Π(A/c) 2 D to ta l c [ s ] 0.5 0.6 0.7 0.8 2 3 4 5 0 1 2 3 4 5 Biased reward r(A/c) 2 D to ta l c [ s ] Figure 18. Comparison of optimal decision strategies for biases in the probability (�) and reward proportion (r) allocated to the two alternatives. a: The optimal starting point x0 as a function of Dtotal for fixed A � 1, c � 0.33 (values corresponding to the data of Figure 5), and with � � 0.7, r � 0.5, for the solid line and r � 0.7, � � 0.5, for the dotted line. b: The optimal starting point as function of � (solid line) and r (dotted line) for fixed A � 1, c � 0.33, and Dtotal � 2. c: Surface of critical total delays (Dtotal c ) as a function of signal-to-noise ratio ã and biased prior probability � for one of the two alternatives. d: Surface of critical total delays (Dtotal c ) as function of ã and biased reward proportion r allocated to one of the two alternatives. 733OPTIMAL DECISION MAKING DT Dtotal � �1 � 2ER�log 1 � ER ER � g��� 1 � 2ER ER � log 1 � ER ER � g��� . (71) Figure 17c shows the optimal performance curves given by Equa- tion 71 for sample values of �. Optimal Decisions for Biased Rewards In this section, we describe the optimal starting point and critical delays for the case in which both alternatives are equally likely but one alternative is associated with a greater reward value than the other. For TAFC, this case can be described by allocating a fraction r of reward for each correct response to one alternative and a fraction (1 � r) to the other, where r lies between 1⁄2 and 1. For example, when r � 1⁄2 , the two alternatives are equally rewarded (i.e., unbiased); when r � 3⁄4 , the reward for the correct response to the first alternative is three times higher than that to the second alternative; and when r � 1, only the correct response to the first alternative is rewarded. This situation resembles that for biased probabilities, but simu- lations indicate that there is an important difference regarding the optimal starting point that yields maximal RRs. For biased re- wards, the optimal starting point depends also on task delay Dtotal, unlike the case of biased probabilities (see the section entitled Biased Probabilities and the Optimal Starting Point, above) in which starting points depend only on c, A, and �. On the basis of numerical results, we find that the optimal starting point of the pure DDM for biased rewards appears to obey the following relationships: x0 3 c2 2A log r 1 � r , for small values of Dtotal, (72) and x0 3 c2 4A log r 1 � r , for large values of Dtotal. (73) Comparing the above equations with Equations 62 and 63, it is apparent that for small Dtotal, the optimal starting point for biased rewards depends on r, exactly as the optimal starting point for biased probabilities depends on �. For large Dtotal, however, the optimal starting point for biased rewards is halfway between zero and the optimal starting point for biased probabilities (with equiv- alent values of � and r). Interestingly, this is the same dependence as in Equation 63 (describing the starting point minimizing ER for fixed DT). In general, our simulations indicate that the optimal starting point for biased rewards moves monotonically as Dtotal increases from the value given in Equation 72 to that of Equation 73. Figure 18a illustrates how optimal starting points depend on Dtotal with fixed A, c, �, and r for biased rewards versus biased probabilities; Figure 18b illustrates how the starting point varies with � versus r for fixed ã and Dtotal. As for biased probabilities, we may also derive a surface of critical delays Dtotal c for biased rewards that is analogous to that of Figure 18c; for delays shorter than Dtotal c , optimal decision makers should immediately choose the most highly rewarded alternative without integrating. This surface, found via a numerical search, is shown in Figure 18d. Although we are unable to derive an explicit expression analogous to Equation 67 for Dtotal c in this biased reward case, we have verified numerically that Dtotal c has the same dependence on signal-to-noise ratio ã for fixed reward bias r � 1⁄2 as it does for probability bias � � 1⁄2 . That is, Dtotal c 1 ã (74) in both cases. Comparison of Figures 18c and 18d reveals that the critical delay Dtotal c for a given signal-to-noise ratio and reward bias r is longer than the critical delay for the same signal-to-noise ratio and probability bias � equal to r (the surface in Figure 18d lies above the surface in Figure 18c). We note that the starting point minimizing BR with biased rewards has been analyzed by Edwards (1965). Relationship to Neurophysiological Experiments and New Predictions In this section, we compare the predictions of our theory with experiments by Platt and Glimcher (1999), who recorded neural activity during biased decisions, and we make new predictions for modified versions of this experiment. The results of the section titled Biased Probabilities and the Optimal Starting Point, above, suggest that when the two alterna- tives in a TAFC task occur with different probabilities and diffi- culty is constant across trials, the activities of decision neurons associated with each alternative should be modulated according to Equation 62 prior to stimulus presentation. That is, the prestimulus activity of neurons representing a particular alternative should depend on the probability of that alternative and its difficulty, as described by Equation 62 and illustrated in Figure 16b. In contrast, activity during the decision-making period itself should follow the usual DDM, unaffected by the relative probability of the alterna- tives. Platt and Glimcher (1999) trained monkeys to perform a TAFC involving visual stimuli in which they indicated responses by making a saccade to one of two locations. The prior probability � favoring one of the two alternatives varied across blocks of trials from 20% to 80%. Platt and Glimcher observed that just before stimulus presentation, the activity of neurons corresponding to a given alternative grew linearly with the probability of the alterna- tive being correct in that block of trials (see Figure 2b in Platt & Glimcher, 1999). Note that in Figure 16b, the dependence of the optimal starting point on outcome probability is close to linear for probabilities ranging from 20% to 80% (see also Figure 18b). Thus, Equation 62 provides a reasonable description of the empir- ical observations under conditions of biased probability. Platt and Glimcher (1999) also varied the proportion of rewards allocated to one of the alternatives from 20% to 80% on separate blocks of trials (with the same intertrial intervals and task diffi- culty). They observed that the activity of neurons corresponding to a given alternative, just before stimulus presentation, also grew linearly with the proportion of reward to the corresponding alter- native (see Figure 1b in Platt & Glimcher, 1999). Note that in Figure 18b, the dependence of the optimal starting point on r is also close to linear for probabilities ranging from 20% to 80%, 734 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN suggesting that these results can also be explained by Equations 72 and 73. Moreover, Platt and Glimcher (1999) reported that the average slope of prestimulus firing rate as a function of probability bias � was slightly larger than the slope of prestimulus firing rate as a function of reward bias r (11 � 4.5 [SE] vs. 10.5 � 4.5 [SE]). Although the difference is not significant, it is at least qualitatively consistent with the pattern described in the section Biased Prob- abilities and the Optimal Decision Threshold, above. In particular, note that in Figure 18b, the slope of the curve relating optimal x0 to � is slightly higher than that relating x0 to r (the difference depends on Dtotal). Taken together, the results of Platt and Glimcher’s (1999) ma- nipulation of probability and reward suggest that the activities of neurons in area LIP just before response conform to predictions made by the DDM for RR optimization. To our knowledge, however, no experiments have yet been performed in which prob- ability and difficulty are simultaneously varied across blocks but kept constant within blocks. The DDM predicts that in such an experiment, the modulation of prestimulus activity of neurons involved in evidence accumulation (e.g., LIP neurons) should be higher for difficult decisions than for easier (see the section Biased Probabilities and the Optimal Starting Point, above). Similarly, we are not aware of any experiments that systematically manipu- late intertrial delay. As described above, the DDM predicts that prestimulus neural activity should be influenced by Dtotal for biased rewards, but not for biased probabilities. General Discussion In this section, we summarize the theory developed in this article and its main predictions, discuss further extensions of the theory, and consider the significance of our findings for more general issues concerning the mechanisms underlying decision making and cognitive control. Summary This article began with a review of existing models of TAFC performance and demonstrated that under reasonable assumptions and for particular parameter values, all of these models (except the race model) reduce to the simple DDM (Laming, 1968; Ratcliff, 1978; Stone, 1960). In the neural network models, inhibition plays a particularly important role, as this implements differencing of the competing sources of information that is central to DDM. We showed that suitable decay and inhibition values are consistent with data estimated from a typical participant in a TAFC task. A long tradition of work has shown that the DDM is the optimal decision strategy, insofar as it is the fastest to reach a fixed level of accuracy or, alternatively, the most accurate for a given speed of response. The specific trade-off between speed and accuracy in the DDM is determined by the choice of threshold. We reviewed two existing theories of how the threshold of the DDM should be chosen to optimize performance (Edwards, 1965; Gold & Shadlen, 2002) using different criteria for optimality (accuracy and RR). We also provided a formal interpretation of a theory that proposes that human participants use a weighted bal- ance of both criteria (Maddox & Bohil, 1998). We demonstrated that the DDM is the optimal TAFC decision-making mechanism with respect to all of these criteria and that, for a given set of parameters (signal, noise, intertrial delay, and, where applicable, the emphasis on accuracy), there is a single optimal threshold. We examined how this threshold varies as a function of task parame- ters, used this to derive optimal performance curves relating nor- malized DT to ER for all the criteria considered, and generalized these to the extended DDM, which allows for variability of starting points and drift rates. Finally, we extended our analyses to the case of biased proba- bilities and rewards. We showed that predicted effects conform to previously reported observations concerning behavioral perfor- mance (Link, 1975; Ratcliff & Smith, 2004), as well as the activity of neural accumulators under such conditions (Platt & Glimcher, 1999). We also computed optimal performance curves relating speed and accuracy for the biased probability case. The main predictions of our theory consider the paradigm in which participants are required to maximize RR. They are as follows: (a) The decision threshold should depend on task param- eters in a specific way summarized in Figure 12. (b) Decision threshold and behavioral statistics should depend on the sum Dtotal of all task-related delays, as opposed to, for example, being dif- ferentially influenced by error-related penalty delays. (c) For a given ER, the DT achieved by participants should be proportional to Dtotal, and their ratio DT/Dtotal should be equal to the value given by the optimal performance curve (see Figures 13b and 13c, heavy line; Figure 17c). (d) In case of biased decisions, when the delay is below the critical value Dtotal c , participants should stop integrating and always immediately choose the most probable or most rewarded alternative. Furthermore, for a given probability and/or reward bias, the specific delay at which this occurs should vary with signal-to-noise ratio ã (see Figures 18c and 18d). Extensions The theory of optimal performance in TAFC tasks developed in this article has several natural extensions that may contribute to a broader understanding of the mechanisms underlying human de- cision making. Multiple-Choice Decisions Perhaps the most important limitation of the current theory is that it pertains to decisions involving only two alternatives. Even simple decision processes often involve many more alternatives (e.g., retrieving an item from memory, searching a visual display for a target item, etc.). Numerous procedures have been devised for deciding among multiple alternatives (Eisenberg, 1991; Wetherill & Glazebrook, 1986), most involving combinations of SPRTs between the various alternatives. Following the seminal work of Lorden (1977), Dragalin, Tartakovsky, and Veeravalli (1999, 2000) have shown that, in the limiting case of arbitrarily low ER, optimality comparable to that of the SPRT (i.e., the fastest re- sponse for fixed accuracy) is achieved by two procedures known as the multisequential probability ratio tests (MSPRTs). The first MSPRT procedure calculates for each alternative the ratio of its likelihood and the sum of likelihoods of all alternatives consid- ered; the decision is made whenever any of these ratios exceed a certain threshold. Recently, Bogacz and Gurney (in press) demon- strated that many aspects of the anatomy and physiology of a 735OPTIMAL DECISION MAKING circuit involving the cortex and the basal ganglia are precisely those required to implement this version of the MSPRT. The other MSPRT, often referred to as the max-versus-next procedure, com- pares the alternative receiving the most evidence with the next- most supported alternative and terminates when the difference between these exceeds a fixed value (corresponding to the thresh- old in the SPRT). The max-versus-next procedure has been im- plemented in the word-identification model by Ratcliff and Mc- Koon (1997) and provided a good fit to experimental data. In contrast to the MSPRT, Usher and McClelland (2001) pro- posed that a multiple decision process can be modeled by a direct extension of the mutual inhibition model, in which each alternative inhibits and receives inhibition from all others (equivalent to a multiple-choice extension of the pooled inhibition model). This implements a max-versus-average procedure, in which the evi- dence favoring the most supported alternative is compared with the average of the evidence in support of all other alternatives. Usher and McClelland showed that this performed best among several alternative models. Recent analytical and simulation work by McMillen and Holmes (2006) suggests that under certain condi- tions (ER � 10%) the max-versus-average procedure closely ap- proximates the performance of the MSPRT, although as ER ap- proaches zero, it is significantly worse. Moreover, multiunit mutual inhibition models approximate such a procedure. Addi- tional work is needed to fully characterize the dynamics of this procedure. As this work proceeds, it will be interesting to consider how this compares with models that have been developed for multiple-choice decision making in domains such as memory retrieval (e.g., Anderson, 1983; Diller, Nobel, & Shiffrin, 2001) and lexical decisions (e.g., Wagenmakers et al., 2004) and with the work of Roe, Busemeyer, and Townsend (2001). The latter gen- eralized the model combining mutual and feedforward inhibition (described in Equation 34) to three alternatives and used it to explain a number of fundamental empirical results described in multialternative preference literature. An important avenue for future inquiry will be to extend the methods and analyses de- scribed in this article to apply to the domain of multichoice decision making. Optimization and Cognitive Control The evidence reviewed in this article suggests that, at least under some conditions, human decision makers can adapt their behavior to approximate optimal performance. This ability can be consid- ered as a simple but well-defined example of cognitive control. Broadly speaking, cognitive control is the ability to guide and adapt behavior to meet desired goals. The challenge, in psychology and neuroscience, has been to operationalize these constructs in terms that lead to a precise understanding of the mechanisms involved and can generate quantitatively detailed predictions re- garding task performance. The DDM provides a framework for doing so by defining a specific decision-making mechanism with critical parameters that have a direct impact on performance: namely, the drift rate (and its variability), the starting point of integration (and its variability), and the decision threshold. These parameters can be interpreted in terms of psychological processes: signal strength, stimulus difficulty, and the allocation of attention (drift); expectancy biases (starting point); and the speed–accuracy trade-off (threshold). Each of these psychological constructs has been closely associated with control. Within the framework of the DDM, we can think of control as the adjustment of these param- eters to optimize performance. This formulation calls into focus important questions: To what end are these parameters adjusted? That is, what are the objectives of performance, and how does one know when these are being met? The framework provided by the DDM allows us to address these questions in a formally explicit manner by defining an objective, or utility function, that the individual seeks to maximize. We can then more precisely define control as the mechanisms that monitor performance by evaluating this utility function and adjusting parameters of the decision pro- cess to maximize its value. Although performance may never actually achieve the theoretical optimum, the ability to define it provides valuable structure for constructing theories about the mechanisms involved in control and for generating detailed quan- titative predictions that can be tested in empirical studies. In particular, this framework allows us to formally identify and characterize the factors involved in control—that is, the factors that influence an organism’s ability to optimally meet its goals. These factors fall roughly into three broad categories: (a) param- eters of the decision process that can be adjusted to optimize performance, (b) criteria used to guide such adaptations (i.e., the cost functions that the organism uses to determine how effectively it is meeting its goals), and (c) algorithms used to carry out these adaptations. This framework suggests specific directions for ex- tending the DDM to address factors in each of these categories. Parameters. We have focused on TAFC tasks in which signal strength (drift rate) remains constant over the course of a single trial. However, if signal-to-noise ratio varies within a trial, optimal performance requires adjusting the gain of the integrator (i.e., its sensitivity to inputs), as suggested by classical signal-processing theory (Papoulis, 1977). We have begun to characterize the tra- jectories for dynamic gain adjustment that optimize performance in the DDM and various related neural network models (Brown et al., 2005). Work on dynamic gain adjustment has also identified and begun to address an interesting tension between the optimality of a single-layered neural network that implements the DDM (such as the models considered in this article) and the reality that such a network is almost certainly embedded in a multilayered system within the brain (required, among other things, to translate the outcome of the decision process into overt behavior). Numerical optimization studies suggest that dynamic gain adjustment, medi- ated by brainstem neuromodulatory systems that are triggered by the outcome of the relevant DDM implemented in a particular layer, can recover a substantial fraction of the performance of a single-layered system (Brown et al., 2004; Gilzenrat et al., 2004). In the present article, we have assumed that the experimental delay D does not directly affect the parameters of the DDM beyond determining what their optimal values would be. However, it is possible that D interacts with attentional effects and, hence, the drift A. Delay D may also influence biases or variability in the starting point (cf. the preparatory cycle in Brown & Holmes, 2001; Cho et al., 2002), as well as trial-to-trial threshold adaptation, as both of these may plausibly require a certain intertrial duration to take effect. Another critical factor is attention. As noted earlier, assumptions of linearity in processing can be justified by assuming that atten- tion acts to place nonlinear integrators in the most sensitive and 736 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN approximately linear range of their response functions (e.g., Cohen et al., 1990). This suggests that fluctuations in attention, both between and within trials, could have a significant impact on performance. Indeed, such effects have been exploited to model the effects of attention on the dynamics of performance in a variety of paradigms (e.g., Cohen, Servan-Schreiber, & McClelland, 1992; Grossberg & Stone, 1986; Servan-Schreiber, Bruno, Carter, & Cohen, 1998; Sperling, Reeves, Blaser, Lu, & Weichselgartner, 2001). The present work provides a framework for analyzing the influence of such factors, identifying optimal protocols for atten- tional adjustment, and using these as a guide for the design of further empirical studies. For example, there are at least two ways in which attentional mechanisms could modulate processing: One is by gain adjustment (along the lines suggested above); the other is by additive bias adjustment that, interacting with the nonlinear- ity of the response function, can change the dynamic range of the integrator. There has been considerable debate in the behavioral, neurophysiological, and modeling literatures as to which of these better describes attentional influences. However, to our knowl- edge, there is no analytic treatment of this issue within the opti- mality framework. The present framework allows for such a treat- ment, in terms of the influence on drift rate, that can bridge between abstract characterization of behavior and neural imple- mentation. Finally, as we noted earlier, periodic shifts in attention may explain the variability in drift rate that has been observed empirically under a number of conditions. Such shifts of attention may reflect the effects of exogenous factors or a fundamental tension between the exploitation of opportunities for reward in the current task and the value of periodically exploring the possibility of other opportunities for reward (e.g., Aston-Jones & Cohen, 2005). Criteria for optimization. Optimality theory requires that we specify an objective or cost function that defines what is being optimized. This has the virtue of forcing us to be precise but the peril of being too narrow in our assumptions. In this article, we have considered four criteria involving reward and accuracy in various combinations. The importance of reward is plausible given that rewards are, by definition, a form of utility valued and actively sought by the organism. The value of accuracy also seems self- evident given that it is often a proxy for reward (especially when time pressure is not a critical factor). However, these criteria have not taken account of other relevant factors, such as the potential costs associated with behavior (e.g., uncertainty of outcome, en- ergy expenditure, or opportunity costs associated with the pursuit of other types of reward). In particular, behavior that may seem suboptimal under the criteria and tasks considered here may in fact be optimal when richer criteria or task environments are consid- ered. For example, the tendency to explore previously unrewarded alternatives is not optimal in a static environment but could yield higher rewards in a changing environment (Sutton & Barto, 1998). Such factors can readily be explored within the context of the optimization framework and may help guide further empirical research (e.g., Aston-Jones & Cohen, 2005; Yu & Dayan, 2005). Another important consideration is the source of information available to the organism about the outcome of performance and used to adapt behavior. In the simplest case, earned rewards or information about accuracy are immediately available and can be used directly by the mechanisms of adaptation to optimize the parameters of the decision process. However, what about situa- tions in which reward delivery is delayed or information about accuracy is not immediately available? For example, in most human studies, payments based on performance are not made until the end of the experiment. Other forms of feedback can serve as proxies for reward (e.g., a visual display of the dollar amount won). However, in many circumstances, people seem able to adapt their behavior even when no explicit feedback is provided (e.g., Botvinick, Nystrom, Fissell, Carter, & Cohen, 1999; Gratton, Coles, Sirevaag, Eriksen, & Donchin, 1988; Laming, 1979). Mea- surements of brain activity (using both scalp electrical recordings and functional magnetic resonance imaging) have produced strong evidence of neural signals that are responsive to both endogenous and exogenous sources of information about performance (e.g., Carter et al., 1998; Falkenstein, Hohnsbein, Hoormann, & Blanke, 1991; Gehring, Goss, Coles, Meyer, & Donchin, 1993; Holroyd et al., 2004; Nieuwenhuis, Yeung, Holroyd, Schurger, & Cohen, 2004). In modeling work, we have begun to explore neurally plausible mechanisms for performance monitoring (e.g., Botvin- ick, Braver, Barch, Carter, & Cohen, 2001; Holroyd, Yeung, Coles, & Cohen, 2005; Yeung, Botvinick, & Cohen, 2004) that can provide internal indexes of performance and use these to adap- tively adjust behavior without access to explicit information about reward or accuracy. However, to date, such work remains discon- nected from more principled and formally rigorous considerations of optimal performance. By relating models of performance mon- itoring to the ones examined in this article, it may be possible to derive formal principles that better justify existing models and help guide their further development. Algorithms for adaptation. The foregoing considerations as- sume mechanisms for translating information about the outcome of performance into adjustments of parameters in the decision- making process that produce improvements. Above, in the section entitled A Theory of Optimal Thresholds, we suggested the pos- sibility that reinforcement-learning algorithms are a natural candi- date given that they are designed to maximize reward (e.g., Simen et al., 2005, 2006). It remains to be determined, however, to what extent such algorithms can reproduce detailed features of sequen- tial adjustment effects that have been observed in the empirical literature (e.g., Botvinick et al., 1999; Gratton et al., 1988; Kerns et al., 2004; Laming, 1979). It is also possible other mechanisms may be involved in behavioral adaptation. For example, we have shown that simple alternation and repetition detectors, using ex- ponentially decaying averages of prior response history, can pro- duce adjustments in starting points in a mutual inhibition model that accurately simulate human RT and ER effects (Cho et al., 2002). Similarly, Botvinick et al. (2001) used a simple exponen- tially decaying average of response conflict to adjust attentional influences and thresholds, simulating sequential adjustment effects such as posterror slowing. An important goal for further work will be to determine whether these mechanisms converge on parame- ters that produce optimal performance and, if not, how mecha- nisms that do so compare in fitting empirical data. Conclusions We hope in this article to have contributed to the development of a framework for the formal analysis of human decision-making behavior. We have used this framework to examine how existing models relate to the optimal TAFC decision-making process—the 737OPTIMAL DECISION MAKING DDM—and have extended the analysis of optimality to address maximization of reward and accuracy. This has generated insights into issues relevant to both psychology and neuroscience, as well as their shared interests. For example, theories of optimal perfor- mance make strong predictions about how human decision makers seeking to maximize reward should trade speed against ac- curacy—a phenomenon that pervades experimental research. At the neural level, our analyses make predictions about underlying mechanisms and how they may implement optimal performance. Confirmation of these predictions would at once strengthen con- fidence in our framework and help adjudicate between competing neural network models of behavior. Most importantly, we believe that our approach offers hope that complex neural systems respon- sible for behavior can, under reasonable assumptions, yield to simpler, more abstract descriptions that are tractable to formal analysis and yet remain faithful to and can be used to make predictions about behavior. Success in this effort promises a prin- cipled understanding of the neural mechanisms underlying psy- chological function and overt behavior akin to the one that has emerged from physics relating atomic structure to the macroscopic properties of matter. References Abramowitz, M., & Stegun, I. A. (1984). Handbook of mathematical functions with formulas, graphs, and mathematical tables. New York: Wiley. Aksay, E., Gamkrelidze, G., Seung, H. S., Baker, R., & Tank, D. W. (2001). In vivo intracellular recording and perturbation of persistent activity in a neural integrator. Nature Neuroscience, 4, 184–193. Anderson, J. R. (1983, April 1). Retrieval of information from long-term memory. Science, 220, 25–30. Anderson, J. R. (1990). The adaptive character of thought. Hillsdale, NJ: Erlbaum. Aston-Jones, G., & Cohen, J. D. (2005). An integrative theory of locus coeruleus–norepinephrine function: Adaptive gain and optimal perfor- mance. Annual Review of Neuroscience, 28, 403–450. Barnard, G. A. (1946). Sequential tests in industrial statistics. Journal of Royal Statistical Society, 8(Suppl.), 1–26. Belovsky, G. E. (1984). Herbivore optimal foraging: A comparative test of three models. American Naturalist, 124, 97–115. Bender, C. M., & Orszag, S. A. (1978). Advanced mathematical methods for scientists and engineers. New York: McGraw-Hill. Bialek, W., Rieke, F., de Ruyter van Steveninck, R. R., & Warland, D. (1991, June 28). Reading a neural code. Science, 252, 1854–1857. Billingsley, P. (1995). Probability and measure. New York: Wiley. Blakemore, C., & Campbell, F. W. (1969). On the existence of neurones in the human visual system selectively sensitive to the orientation and size of retinal images. Journal of Physiology (London), 15, 237–260. Bogacz, R., & Cohen, J. D. (2004). Parameterization of connectionist models. Behavioral Research Methods, Instruments, and Computers, 36, 732–741. Bogacz, R., & Gurney, K. (in press). The basal ganglia and cortex imple- ment optimal decision making between alternative actions. Neural Com- putation. Bohil, C. J., & Maddox, W. T. (2003). On generality of optimal versus objective classifier feedback effects on decision criterion learning in perceptual categorization. Memory & Cognition, 31, 181–198. Botvinick, M., Braver, T. S., Barch, D., Carter, C., & Cohen, J. D. (2001). Conflict monitoring and cognitive control. Psychological Review, 108, 625–652. Botvinick, M., Nystrom, L., Fissell, K., Carter, C. S., & Cohen, J. D. (1999, November 11). Conflict monitoring vs. selection-for-action in anterior cingulate cortex. Nature, 402, 179–181. Brainard, D. H. (1997). The psychophysics toolbox. Spatial Vision, 10, 433–436. Britten, K. H., Shadlen, M. N., Newsome, W. T., & Movshon, J. A. (1993). Responses of neurons in macaque MT to stochastic motion signals. Visual Neuroscience, 10, 1157–1169. Brown, E., Gao, J., Holmes, P., Bogacz, R., Gilzenrat, M., & Cohen, J. D. (2005). Simple networks that optimize decisions. International Journal of Bifurcations and Chaos, 15, 803–826. Brown, E., Gilzenrat, M., & Cohen, J. D. (2004). The locus coeruleus, adaptive gain, and the optimization of simple decision tasks (Tech. Rep. No. 04-02). Princeton, NJ: Princeton University, Center for the Study of Mind, Brain, and Behavior. Brown, E., & Holmes, P. (2001). Modeling a simple choice task: Stochastic dynamics of mutually inhibitory neural groups. Stochastics and Dynam- ics, 1, 159–191. Brunel, N., & Latham, P. (2003). Firing rate of noisy quadratic integrate- and-fire neurons. Neural Computation, 15, 2281–2306. Bull, C. D., Metcalfe, N. B., & Mangel, M. (1996). Seasonal matching of foraging to anticipated energy requirements in anorexic juvenile salmon. Proceedings of the Royal Society, Series B, 263, 13–18. Busemeyer, J. R., & Diederich, A. (2002). Survey of decision field theory. Mathematical Social Sciences, 43, 345–370. Busemeyer, J. R., & Myung, I. J. (1992). An adaptive approach to human decision making: Learning theory and human performance. Journal of Experimental Psychology: General, 121, 177–194. Busemeyer, J. R., & Rapoport, A. (1988). Psychological models of de- ferred decision making. Journal of Mathematical Psychology, 32, 91– 134. Busemeyer, J. R., & Townsend, J. T. (1992). Fundamental derivations from decision field theory. Mathematical Social Sciences, 23, 255–282. Busemeyer, J. R., & Townsend, J. T. (1993). Decision field theory: A dynamic-cognitive approach to decision making in an uncertain envi- ronment. Psychological Review, 100, 432–459. Cannon, S. C., Robinson, D. A., & Shamma, S. (1983). A proposed neural network for the integrator of the oculomotor system. Biological Cyber- netics, 49, 127–136. Carpenter, R. H. S., & Williams, M. L. L. (1995, September 7). Neural computation of log likelihood in control of saccadic eye movements. Nature, 377, 59–62. Carter, C. S., Braver, T. S., Barch, D. M., Botvinick, M. M., Noll, D. C., & Cohen, J. D. (1998, May 1). Anterior cingulate cortex, error detection and the online monitoring of performance. Science, 280, 747–749. Cho, R. Y., Nystrom, L. E., Brown, E., Jones, A. D., Braver, T. S., Holmes, P. J., & Cohen, J. D. (2002). Mechanisms underlying dependencies of performance on stimulus history in a two-alternative forced-choice task. Cognitive Affective and Behavioral Neuroscience, 2, 283–299. Cohen, J. D., Dunbar, K., & McClelland, J. L. (1990). On the control of automatic processes: A parallel distributed processing account for the Stroop effect. Psychological Review, 97, 332–361. Cohen, J. D., Servan-Schreiber, D., & McClelland, J. L. (1992). A parallel distributed processing approach to automaticity. American Journal of Psychology, 105, 239–269. DeGroot, M. H. (1988). A conversation with George A. Barnard. Statistical Science, 3, 196–212. Diederich, A., & Busemeyer, J. R. (2003). Simple matrix methods for analyzing diffusion models of choice probability, choice response time, and simple response time. Journal of Mathematical Psychology, 47, 304–322. Diller, D. E., Nobel, P. A., & Shiffrin, R. M. (2001). An ARC-REM model for accuracy and response time in recognition and cued recall. Journal of Experimental Psychology: Learning, Memory, and Cognition, 27, 414–435. 738 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN Ditterich, J., Mazurek, M. E., & Shadlen, M. N. (2003). Microstimulation of visual cortex affects the speed of perceptual decisions. Nature Neu- roscience, 6, 891–898. Dragalin, V. P., Tartakovsky, A. G., & Veeravalli, V. V. (1999). Multihy- pothesis sequential probability ratio tests: Part I. Asymptotic optimality. IEEE Transactions on Information Theory, 45, 2448–2461. Dragalin, V. P., Tartakovsky, A. G., & Veeravalli, V. V. (2000). Multihy- pothesis sequential probability ratio tests: Part II. Accurate asymptotic expansions for the expected sample size. IEEE Transactions on Infor- mation Theory, 46, 1366–1383. Dunbar, R. I. M. (1984). Reproductive decisions: An economic analysis of Gelada baboon social strategies. Princeton, NJ: Princeton University Press. Edwards, W. (1965). Optimal strategies for seeking information: Models for statistics, choice reaction times, and human information processing. Journal of Mathematical Psychology, 2, 312–329. Eisenberg, B. (1991). Multihypothesis problems. In B. K. Ghost & P. K. Sen (Eds.), Handbook of sequential analysis (pp. 229–244). New York: Mercel Dekker. Erev, I. (1998). Signal detection by human observers: A cut-off reinforce- ment learning model of categorization decisions under uncertainty. Psy- chological Review, 105, 280–298. Ermentrout, G. B. (1994). Reduction of conductance-based models with slow synapses to neural nets. Neural Computation, 6, 679–695. Falkenstein, M., Hohnsbein, J., Hoormann, J., & Blanke, L. (1991). Effects of crossmodal divided attention on late ERP components: II. Error processing in choice reaction tasks. Electroencephalography and Clin- ical Neurophysiology, 78, 447–455. Feller, W. (1968). An introduction to probability theory and its applica- tions. New York: Wiley. Gardiner, C. W. (1985). Handbook of stochastic methods (2nd ed.). New York: Springer. Gehring, W. J., Goss, B., Coles, M. G. H., Meyer, D. E., & Donchin, E. (1993). A neural system for error-detection and compensation. Psycho- logical Science, 4, 385–390. Ghosh, B. K. (1970). Sequential tests of statistical hypotheses. Reading, MA: Addison-Wesley. Gilzenrat, M. S., Brown, E. T., Aston-Jones, G., & Cohen, J. D. (2004). Locus coeruleus, adaptive gain, and the optimization of decision tasks [Abstract] (Program No. 899.6). Retrieved from the 2004 Abstract Viewer and Itinerary Planner on the Society for Neuroscience Web site, http://sfn.scholarone.com Gold, J. I., & Shadlen, M. N. (2001). Neural computations that underlie decisions about sensory stimuli. Trends in Cognitive Sciences, 5, 10–16. Gold, J. I., & Shadlen, M. N. (2002). Banburismus and the brain: Decoding the relationship between sensory stimuli, decisions and reward. Neuron, 36, 299–308. Gold, J. I., & Shadlen, M. N. (2003). The influence of behavioral context on the representation of a perceptual decision in developing oculomotor commands. Journal of Neuroscience, 23, 632–651. Goldman, M. S., Levine, J. H., Major, G., Tank, D. W., & Seung, H. S. (2003). Robust persistent neural activity in a model integrator with multiple hysteretic dendrites per neuron. Cerebral Cortex, 13, 1185– 1195. Good, I. J. (1979). Studies in the history of probability and statistics: XXXVI. A. M. Turing’s statistical work in World War II. Biometrika, 66, 393–396. Gratton, G., Coles, M. G., Sirevaag, E. J., Eriksen, C. W., & Donchin, R. J. (1988). Pre- and poststimulus activation of response channels: A psy- chophysiological analysis. Journal of Experimental Psychology: Human Perception and Performance, 14, 331–344. Grossberg, S. (1988). Nonlinear neural networks: Principles, mechanisms, and architectures. Neural Networks, 1, 17–61. Grossberg, S., & Stone, G. (1986). Neural dynamics of attention switching and temporal-order information in short-term memory. Memory & Cog- nition, 14, 451–468. Hanes, D. P., & Schall, J. D. (1996, October 18). Neural control of voluntary movement initiation. Science, 274, 427–430. Herrnstein, R. J. (1961, June 30). Stereotypy and intermittent reinforce- ment. Science, 133, 2067–2069. Herrnstein, R. J. (1997). The matching law. Cambridge, MA: Harvard University Press. Higham, D. J. (2001). An algorithmic introduction to numerical simulation of stochastic differential equations. SIAM Review, 43, 525–546. Hill, C. M. (1898). On choice. American Journal of Psychology, 9, 587– 590. Holmes, P., Lumley, J. L., & Berkooz, G. (1996). Turbulence, coherent structures, dynamical systems and symmetry. Cambridge, England: Cambridge University Press. Holroyd, C. B., Nieuwenhuis, S., Yeung, N., Nystrom, L., Mars, R. B., Coles, M. G. H., & Cohen, J. D. (2004). Dorsal anterior cingulate cortex shows fMRI response to internal and external error signals. Nature Neuroscience, 7, 497–498. Holroyd, C. B., Yeung, N., Coles, M. G. H., & Cohen, J. D. (2005). A mechanism for error detection in speeded response time tasks. Journal of Experimental Psychology: General, 134, 163–191. Kahneman, D., & Tversky, A. (1984). Choices, values, and frames. Amer- ican Psychologist, 39, 341–350. Kerns, J. G., Cohen, J. D., MacDonald, A. W., III, Cho, R. Y., Stenger, V. A., & Carter, C. S. (2004, February 13). Anterior cingulate conflict monitoring and adjustments in control. Science, 303, 1023–1026. Koulakov, A. A., Raghavachari, S., Kepecs, A., & Lisman, J. E. (2002). Model for a robust neural integrator. Nature Neuroscience, 5, 775–782. LaBerge, D. A. (1962). A recruitment theory of simple behavior. Psy- chometrika, 27, 375–396. Laming, D. R. J. (1968). Information theory of choice-reaction times. New York: Wiley. Laming, D. (1979). Choice reaction performance following an error. Acta Psychologica, 43, 199–224. Lehmann, E. L. (1959). Testing statistical hypotheses. New York: Wiley. Levine, D. S., & Elsberry, W. R. (Eds.). (1997). Optimality in biological and artificial networks? Mahwah, NJ: Erlbaum. Ling, D. S. F., & Benardo, L. S. (1995). Recruitment of GABAA inhibition in rat neocortex is limited and not NMDA dependent. Journal of Neu- rophysiology, 74, 2329–2335. Link, S. W. (1975). The relative judgment theory of two choice response time. Journal of Mathematical Psychology, 12, 114–135. Link, S. W., & Heath, R. A. (1975). A sequential theory of psychological discrimination. Psychometrika, 40, 77–105. Loewenstein, G., & Thaler, R. (1989). Anomalies: Intertemporal choice. Journal of Economic Perspectives, 3, 181–193. Logan, G. D. (2002). An instance theory of attention and memory. Psy- chological Review, 109, 376–400. Logan, G. D., & Bundesen, C. (2003). Clever homunculus: Is there an endogenous act of control in the explicit task-cuing procedure? Journal of Experimental Psychology: Human Perception and Performance, 29, 575–599. Lorden, G. (1977). Nearly-optimal sequential tests for finitely many pa- rameter values. Annals of Statistics, 5, 1–21. Maddox, W. T., & Bohil, C. J. (1998). Base-rate and payoff effects in multidimensional perceptual categorization. Journal of Experimental Psychology: Learning, Memory, and Cognition, 24, 1459–1482. Maddox, W. T., & Bohil, C. J. (2001). Feedback effects on cost-benefit learning in perceptual categorization. Memory & Cognition, 29, 598– 615. Major, G., Baker, R., Aksay, E., Mensh, B., Seung, H. S., & Tank, D. W. (2004). Plasticity and tuning by visual feedback of the stability of a 739OPTIMAL DECISION MAKING neural integrator. Proceedings of the National Academy of Sciences, USA, 101, 7739–7744. Maritz, J. S., & Jarrett, R. G. (1978). A note on estimating the variance of the sample median. Journal of the American Statistical Association, 73, 194–196. Mazurek, M. E., Roitman, J. D., Ditterich, J., & Shadlen, M. N. (2003). A role for neural integrators in perceptual decision making. Cerebral Cortex, 13, 1257–1269. McBain, C. J., & Dingledine, R. (1993). Heterogeneity of synaptic gluta- mate receptors on CA3 stratum radiatum interneurons. Journal of Phys- iology (London), 462, 373–392. McElree, B., & Dosher, B. A. (1989). Serial position and set size in short-term memory: The time course of recognition. Journal of Exper- imental Psychology: General, 118, 346–373. McMillen, T., & Holmes, P. (2006). The dynamics of choice among multiple alternatives. Journal of Mathematical Psychology, 50, 30–57. Moehlis, J., Brown, E., Bogacz, R., Holmes, P., & Cohen, J. D. (2004). Optimizing reward rate in two alternative choice tasks: Mathematical formalism (Tech. Rep. No. 04-01). Princeton, NJ: Princeton University, Center for the Study of Brain, Mind, and Behavior. Mozer, M. C., Colagrosso, M. D., & Huber, D. H. (2002). A rational analysis of cognitive control in a speeded discrimination task. In T. Dietterich, S. Becker, & Z. Ghahramani (Eds.), Advances in neural information processing systems (Vol. 14, pp. 51–57). Cambridge, MA: MIT Press. Myung, I. J., & Busemeyer, J. R. (1989). Criterion learning in a deferred decision making task. American Journal of Psychology, 102, 1–16. Neyman, J., & Pearson, E. S. (1933). On the problem of the most efficient tests of statistical hypotheses. Philosophical Transactions of the Royal Society of London, Series A, 231, 289–337. Nieuwenhuis, S., Yeung, N., Holroyd, C. B., Schurger, A., & Cohen, J. D. (2004). Sensitivity of electrophysiological activity from medial frontal cortex to utilitarian and performance feedback. Cerebral Cortex, 14, 741–747. Oaksford, M., & Chater, N. (1998). Rational models of cognition. Oxford, England: Oxford University Press. Olshausen, B. A., & Field, D. J. (1996, June 13). Emergence of simple-cell receptive field properties by learning a sparse code for natural images. Nature, 381, 607–609. Omurtag, A., Knight, B. W., & Sirovich, L. (2000). On the simulation of large populations of neurons. Journal of Computational Neuroscience, 8, 51–63. Pachella, R. G. (1974). The interpretation of reaction time in information- processing research. In B. Kantowitz (Ed.), Human information process- ing: Tutorial in performance and recognition (pp. 41–82). Hillsdale, NJ: Erlbaum. Palmer, J., Huk, A. C., & Shadlen, M. N. (2005). The effect of stimulus strength on the speed and accuracy of a perceptual decision. Journal of Vision, 5, 376–404. Papoulis, A. (1977). Signal analysis. New York: McGraw-Hill. Pelli, D. G. (1997). The VideoToolbox software for visual psychophysics: Transforming numbers into movies. Spatial Vision, 10, 437–442. Pike, A. R. (1966). Stochastic models of choice behavior: Response prob- abilities and latencies of finite Markov chain systems. British Journal of Mathematical and Statistical Psychology, 21, 161–182. Pitz, G. F., & Reinhold, H. (1968). Payoff effects in sequential decision making. Journal of Experimental Psychology, 77, 249–257. Platt, M. L., & Glimcher, P. W. (1999, July 15). Neural correlates of decision variables in parietal cortex. Nature, 400, 233–238. Proctor, R. W., & Rao, K. V. (1983). Evidence that the same–different disparity is not attributable to response bias. Perception & Psychophys- ics, 34, 72–76. Proctor, R. W., Rao, K. V., & Hurst, P. W. (1984). An examination of response bias in multiletter matching. Perception & Psychophysics, 35, 464–476. Rapoport, A., & Burkheimer, G. B. (1971). Models for deferred decision making. Journal of Mathematical Psychology, 8, 508–538. Ratcliff, R. (1978). A theory of memory retrieval. Psychological Review, 83, 59–108. Ratcliff, R. (1980). A note on modelling accumulation of information when the rate of accumulation changes over time. Journal of Mathematical Psychology, 21, 178–184. Ratcliff, R. (1985). Theoretical interpretations of the speed and accuracy of positive and negative responses. Psychological Review, 92, 212–225. Ratcliff, R. (1988). Continuous versus discrete information processing: Modeling accumulation of partial information. Psychological Review, 95, 238–255. Ratcliff, R., Cherian, A., & Segraves, M. A. (2003). A comparison of macaque behavior and superior colliculus neuronal activity to predic- tions from models of two choice decisions. Journal of Neurophysiology, 90, 1392–1407. Ratcliff, R., Gomez, R., & McKoon, G. (2004). A diffusion model account of the lexical decision task. Psychological Review, 111, 159–182. Ratcliff, R., & McKoon, G. (1997). A counter model for implicit priming in perceptual word identification. Psychological Review, 104, 319–343. Ratcliff, R., & Rouder, J. N. (1998). Modeling response times for two- choice decisions. Psychological Science, 9, 347–356. Ratcliff, R., & Rouder, J. N. (2000). A diffusion model account of masking in two-choice letter identification. Journal of Experimental Psychology: Human Perception and Performance, 26, 127–140. Ratcliff, R., & Smith, P. L. (2004). A comparison of sequential sampling models for two-choice reaction time. Psychological Review, 111, 333– 367. Ratcliff, R., Thapar, A., & McKoon, G. (2003). A diffusion model analysis of the effects of aging on brightness discrimination. Perception & Psychophysics, 65, 523–535. Ratcliff, R., & Tuerlinckx, F. (2002). Estimating parameters of the diffu- sion model: Approaches to dealing with contaminant reaction times and parameter variability. Psychonomic Bulletin & Review, 9, 438–481. Ratcliff, R., Van Zandt, T., & McKoon, G. (1999). Connectionist and diffusion models of reaction time. Psychological Review, 106, 261–300. Reed, A. V. (1973, August 10). Speed–accuracy trade-off in recognition memory. Science, 181, 574–576. Renart, A., Brunel, N., & Wang, X.-J. (2003). Mean-field theory of recurrent cortical networks: From irregularly spiking neurons to working memory. In J. Feng (Ed.), Computational neuroscience: A comprehen- sive approach (pp. 431–490). Boca Raton, FL: CRC Press. Roe, R. M., Busemeyer, J. R., & Townsend, J. T. (2001). Multialternative decision field theory: A dynamic connectionist model of decision mak- ing. Psychological Review, 108, 370–392. Rouder, J. N. (1996). Premature sampling in random walks. Journal of Mathematical Psychology, 40, 287–296. Rowan, T. (1990). Functional stability analysis of numerical algorithms. Unpublished doctoral dissertation, University of Texas at Austin. Schall, J. D. (2001). Neural basis of deciding, choosing and acting. Nature Reviews Neuroscience, 2, 33–42. Schall, J. D., & Thompson, K. G. (1999). Neural selection and control of visually guided eye movements. Annual Review of Neuroscience, 22, 241–259. Servan-Schreiber, D., Bruno, R., Carter, C., & Cohen, J. D. (1998). Dopamine and the mechanisms of cognition: Part I. A neural network model predicting dopamine effects on selective attention. Biological Psychiatry, 43, 713–722. Seung, H. S. (1996). How the brain keeps the eyes still. Proceedings of the National Academy of Sciences, USA, 93, 13339–13344. Seung, H. S. (2003). Amplification, attenuation, and integration. In M. A. 740 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN Adbib (Ed.), The handbook of brain theory and neural networks (2nd ed., pp. 94–97). Cambridge, MA: MIT Press. Seung, H. S., Lee, D. D., Reis, B. Y., & Tank, D. W. (2000). Stability of the memory of eye position in a recurrent network of conductance-based model neurons. Neuron, 26, 259–271. Shadlen, M. N., & Newsome, W. T. (1996). Motion perception: Seeing and deciding. Proceedings of the National Academy of Sciences, USA, 93, 628–633. Shadlen, M. N., & Newsome, W. T. (2001). Neural basis of a perceptual decision in the parietal cortex (Area LIP) of the rhesus monkey. Journal of Neurophysiology, 86, 1916–1936. Shafir, E., & Tversky, A. (1995). Decision making. In E. E. Smith & D. N. Osherson (Eds.), Thinking: An invitation to cognitive science (Vol. 3, 2nd ed., pp. 77–100). Cambridge, MA: MIT Press. Shelley, M., & McLaughlin, D. (2002). Coarse-grained reduction and analysis of a network model of cortical response. Journal of Computa- tional Neuroscience, 12, 97–122. Simen, P. A., Cohen, J. D., & Holmes, P. (2006). Neural implementation of decision threshold changes via reward rate estimates. Manuscript submitted for publication. Simen, P. A., Holmes, P., & Cohen, J. D. (2005). Threshold adaptation in decision making [Abstract] (Program No. 768.15). Retrieved from the 2005 Abstract Viewer and Itinerary Planner on the Society for Neuro- science Web site, http://sfn.scholarone.com Smith, P. L. (1995). Psychophysically principled models of visual simple reaction time. Psychological Review, 102, 567–593. Smith, P. L. (2000). Stochastic dynamic models of response time and accuracy: A foundational primer. Journal of Mathematical Psychology, 44, 408–463. Smith, P. L., & Ratcliff, R. (2004). Psychology and neurobiology of simple decisions. Trends in Neuroscience, 27, 161–168. Smith, P. L., & Van Zandt, T. (2000). Time-dependent Poisson counter models of response latency in simple judgment. British Journal of Mathematical and Statistical Psychology, 53, 293–315. Smith, P. L., & Vickers, D. (1989). Modeling evidence accumulation with partial loss in expanded judgment. Journal of Experimental Psychology: Human Perception and Performance, 15, 797–815. Soetens, E., Deboeck, M., & Hueting, J. (1984). Automatic aftereffects in two-choice reaction time: A mathematical representation of some con- cepts. Journal of Experimental Psychology: Human Perception and Performance, 10, 581–598. Spanier, J., & Oldham, K. B. (1987). An atlas of functions. Washington, DC: Hemisphere Publication Services. Sperling, G., Reeves, A., Blaser, E., Lu, Z.-L., & Weichselgartner, E. (2001). Two computational models of attention. In J. Braun, C. Koch, & J. L. Davis (Eds.), Visual attention and cortical circuits (pp. 177–214). Cambridge, MA: MIT Press. Stevenson, M. K., Busemeyer, J. R., & Naylor, J. C. (1991). Judgement and decision making theory. In M. D. Dunnette & L. M. Hough (Eds.), Handbook of industrial and organizational psychology (Vol. 1, 2nd ed., pp. 283–374). Palo Alto, CA: Consulting Psychologist Press. Stone, M. (1960). Models for choice reaction time. Psychometrika, 25, 251–260. Sutton, R. S., & Barto, A. G. (1998). Reinforcement learning. Cambridge, MA: MIT Press. Thapar, A., Ratcliff, R., & McKoon, G. (2003). A diffusion model analysis of the effects of aging on letter discrimination. Psychology and Aging, 18, 415–429. Tuerlinckx, F. (2004). The efficient computation of the cumulative distri- bution and probability density functions in the diffusion model. Behav- ioral Research Methods, Instruments, and Computers, 36, 702–716. Usher, M., Cohen, J. D., Servan-Schreiber, D., Rajkowski, J., & Aston- Jones, G. (1999, January 22). The role of locus coeruleus in the regu- lation of cognitive performance. Science, 283, 549–554. Usher, M., & McClelland, J. L. (1995). On the time course of perceptual choice: A model based on principles of neural computation (Tech. Rep. No. PDP.CNS.95.5). Pittsburgh, PA: Carnegie Mellon University. Usher, M., & McClelland, J. L. (2001). On the time course of perceptual choice: The leaky competing accumulator model. Psychological Review, 108, 550–592. Van Zandt, T., Colonius, H., & Proctor, R. W. (2000). A comparison of two response time models applied to perceptual matching. Psychonomic Bulletin & Review, 7, 208–256. Vickers, D. (1970). Evidence for an accumulator model of psychophysical discrimination. Ergonomics, 13, 37–58. Vickers, D., Caudrey, D., & Wilson, R. J. (1971). Discriminating between the frequency of occurrence of two alternative events. Acta Psycho- logica, 35, 151–172. Wagenmakers, E.-J., Steyvers, M., Raaijmakers, J. G. W., Shiffrin, R. M., van Rijn, H., & Zeelenberg, R. (2004). A model for evidence accumu- lation in the lexical decision task. Cognitive Psychology, 48, 332–367. Wald, A. (1947). Sequential analysis. New York: Wiley. Wald, A., & Wolfowitz, J. (1948). Optimum character of the sequential probability ratio test. Annals of Mathematical Statistics, 19, 326–339. Wallis, W. A. (1980). The Statistical Research Group, 1942–1945. Journal of the American Statistical Association, 75, 320–330. Wang, X.-J. (2002). Probabilistic decision making by slow reverberation in cortical circuits. Neuron, 36, 1–20. Wetherill, G. B., & Glazebrook, K. D. (1986). Sequential methods in statistics (3rd ed.). New York: Chapman & Hall. Wickelgren, W. A. (1977). Speed–accuracy tradeoff and information pro- cessing dynamics. Acta Psychologica, 41, 67–85. Wilson, H., & Cowan, J. (1972). Excitatory and inhibitory interactions in localized populations of model neurons. Biophysics Journal, 12, 1–24. Wong, K.-F., & Wang, X.-J. (2006). A recurrent network mechanism of time integration in perceptual decisions. Journal of Neuroscience, 26, 1314–1328. Yang, T., Hanks, T. D., Mazurek, M., McKinley, M., Palmer, J., & Shadlen, M. N. (2005). Incorporating prior probability into decision making in the face of uncertain reliability of evidence [Abstract] (Pro- gram No. 621.4). Retrieved from the 2005 Abstract Viewer and Itinerary Planner on the Society for Neuroscience Web site, http://sfn.scholarone .com Yeung, N., Botvinick, M. M., & Cohen, J. D. (2004). The neural bases of error detection: Conflict monitoring and error-related negativity. Psy- chological Review, 111, 931–959. Yu, A. J., & Dayan, P. (2005). Inference, attention, and decision in a Bayesian neural architecture. In L. K. Saul, Y. Weiss, & L. Bottou (Eds.), Advances in neural information processing systems (Vol. 17, pp. 1577–1584). Cambridge, MA: MIT Press. (Appendixes follow) 741OPTIMAL DECISION MAKING Appendix A Mathematical Details of Decision Optimization in Two-Alternative Forced-Choice Tasks In this appendix, we collect and describe mathematical results for first passage, boundaryless, and reflecting-boundary drift diffusion problems. We consider both diffusion and Ornstein–Uhlenbeck (O-U) models. The main tools are drawn from applied probability, the theory of stochastic ordinary differential equations, and classical perturbation and asymptotic methods. Here, we focus on continuous models in the form of stochastic ordinary differential equations, although we first describe how these arise as limits of the discrete Neyman–Pearson and sequential probability statistical tests, which are the optimal methods of deciding between two alternatives on the basis of noisy accumulating data. It turns out that the optimal continuous processes admit rather simple exact formulae for such behavioral observables as mean decision times (DTs) and error rates (ERs). The first section, Probability Ratio Tests, reviews the optimality of the sequential probability ratio test (SPRT) and describes how it becomes the drift diffusion model in the continuum limit. The next section, Optimal Decision for the Free-Response Protocol, considers the free-response protocol, in which participants make choices in their own time, and the third section, Optimal Decisions Under the Interrogation Protocol, addresses the interrogation protocol, in which a decision is deferred until a cue is presented. Finally, the fourth section, The Extended Drift Diffusion and O-U Models, gives results for extended models in which drift rates and initial conditions are variable. Probability Ratio Tests Optimality of the Sequential Probability Ratio Test (SPRT) The SPRT described in the main text is optimal in the following sense. Let P(rej Hi�Hi) be the probability that hypothesis Hi is true but rejected, i � 1, 2. Also, let Ei(N) be the expected value for the number of observations required for a decision to be reached when hypothesis Hi is true, i � 1, 2. The following theorem was first proved by Wald and Wolfowitz (1948); a simpler proof was given by Lehmann (1959; cf. Ghosh, 1970). SPRT optimality theorem: Among all tests (fixed sample or sequential) for which P(rej Hi�Hi) � �i, i � 1, 2, and for which E1(N) and E2(N) are finite, the SPRT with error probabilities P(rej Hi�Hi) � �i, i � 1, 2, minimizes both E1(N) and E2(N). Letting ER denote error rate, and DTSPRT (DTa, respectively) denote the DT for the SPRT (some alternative, respectively) model, the SPRT Optimality Theorem implies that DTSPRT�ER� � DTa�ER�, for all ER. (A1) In the section entitled A Theory of Optimal Thresholds in the main text, we consider reward criteria which depend on ER, DT, and other parameters. A corollary of the SPRT optimality theorem is that the SPRT maximizes any reward criteria R � R(ER, DT(ER)) that is monotonically nonincreasing with respect to DT, that is, for which �R/�(DT) � 0. Indeed, suppose that ERSPRT (ERa, respec- tively) gives the absolute maximum for R for the SPRT (alternative, respectively) model. Then, letting RSPRT max (Ra max, respectively) be the maximum value that R can take using the SPRT (alterna- tive, respectively) model, we have Ra max � R�ERa, DTa�ERa�� � R�ERa, DTSPRT�ERa�� � R�ERSPRT, DTSPRT�ERSPRT�� � RSPRT max . (A2) The first inequality follows from Equation A1 and the fact that R is monotonically nonincreasing, whereas the second one follows from the definition of ERSPRT. Thus, under this simple condition on R, the SPRT is able to achieve the maximum possible value for R for any decision strategy. We now deduce the conditions for which the reward criteria described in the main text are monotonically nonincreasing in DT and, hence, under what conditions one expects the SPRT to be optimal for these criteria. Consider first the reward rate (RR) given by Equation 42. We find that ��RR� ��DT� � � 1 � ER �DT � T0 � D � DpER� 2 , (A3) 742 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN which is always negative because the denominator is always positive and ER � 1. Next, consider the reward/accuracy (RA) function given by Equation 43. Here, ��RA� ��DT� � �c1 ��RR� ��DT� , (A4) which is negative whenever c1 � 0. Next, consider the modified RR given by Equation 44. Here, ��RRm� ��DT� � � c1�1 � ER� � c2ER �DT � Dtotal� 2 . (A5) Because the denominator is always positive, we wish to determine when the numerator is negative. This is just a linear function of ER passing through �c1 at ER � 0 and with slope (c1 c2). Restricting attention to ER � 0.5, we find that RRm is monotonically nonincreasing for c1 � 0 and c1 � c2. Finally, consider the Bayes risk (BR) given by Equation 41. Unlike the other reward criteria, optimal performance minimizes BR, which, in the above framework, is equivalent to maximizing 1/BR. We find that � ��DT� � 1BR� � �c1�c1DT � c2ER�2 , (A6) which is negative for c1 � 0. Thresholds for the SPRT The thresholds Z1 and Z2 in the SPRT (Equation 2 of main text) are related to the ERs �1 and �2 as follows (Lehmann, 1959; Wald, 1947). Consider the set C1 of n-length sequences Y such that the SPRT chooses H1 when Y occurs. That is, for any Y � C1, p1(y1)p1(y2) . . . p1(yn) � Z1p2(y1)p2(y2) . . . p2(yn). Integrating this inequality over all of C1, p1�C1� � Z1p2�C1�, (A7) where pj(C1) is the probability of making Choice 1 given that hypothesis Hj is true. By definition, p1(C1) � 1 � �1, and p1(C2) � �2, so that 1 � �1 � Z1�2 f Z1 � 1 � �1 �2 . Similarly, �1 � Z2�1 � �2� f Z2 � �1 1 � �2 . The inequalities fail to be equalities because it is possible to overshoot the boundaries Z1 or Z2. However, in practice, there is typically little penalty in assuming equality (Lehmann, 1959; Wald, 1947): Z2 � �1 1 � �2 , Z1 � 1 � �1 �2 . (A8) Note that the proof of the SPRT optimality theorem requires that Z2 � 1 � Z1 (Lehmann, 1959). Using Equation A8, this condition becomes �1 1 � �2 � 1 � 1 � �1 �2 . (A9) Thus, we require that �1 � 1 � �2. Now, 1 � �2 is the probability of choosing H2 when H2 is true. Thus, the proof requires that the probability of choosing H2 when H1 is true be less than the probability of choosing H2 when H2 is true. Similarly, it requires that �2 � 1 � �1, that is, that the probability of choosing H1 when H2 is true be less than the probability of choosing H1 when H1 is true. These are, of course, very reasonable conditions for a decision-making procedure. Wald (1947) also gave approximate expressions for the expected numbers of observations Ei(N). Using Equation A8, these may be written (Appendixes continue) 743OPTIMAL DECISION MAKING E1�N� � �1log� �11 � �2� � �1 � �1�log� 1 � �1 �2 � E1� log�p1�y�p2�y��� , and (A10) E2�N� � �1 � �2�log� �11 � �2� � �2log� 1 � �1 �2 � E2� log�p1�y�p2�y��� , (A11) where Ei(log( p1(y)/p2(y))) is the expected value of the argument when Hi is true, i � 1, 2. We also note that the proof by Lehmann (1959) applies to the generalized case of decisions based on biased data. Suppose that the participant has been told (or has deduced) that the probability of drawing from the distribution p1(y) ( p2(y), respectively) is � (1 � �, respectively). Then, the SPRT continues as long as Z2 � �p1n �1 � ��p2n � Z1. Equivalently, the thresholds Zj are simply multiplied by (1 � �)/�; that is, observations are taken as long as 1 � � � Z2 � p1n p2n � 1 � � � Z1. (A12) Thus, if the upper alternative is more probable (� � 1/2), both thresholds are shifted downward, and vice versa. Random Walks and the SPRT Following Stone (1960), Laming (1968) applied the SPRT to a two-alternative forced-choice task. In such a task, on each trial, a randomly chosen stimulus S1 or S2 is shown to the participant. The participant is told to give a response Ri if he or she perceives stimulus Si, i � 1, 2. The response made (which may or may not be correct) and the reaction time (RT) taken to make it are recorded for each trial. Laming (1968) modeled this procedure by supposing that decisions are made on the basis of accumulation of information. Specifically, for each trial, the participant makes a series of brief observations of the stimulus represented by the random sequence y1, y2, . . . , yn. The increment of information gained from (independent) observation yr is defined to be �I r � log�p1�yr�p2�yr�� : (A13) This is the log likelihood ratio (Gold & Shadlen, 2001, 2002), where pi(y) is the probability distribution for y given that stimulus Si was presented, i � 1, 2. Implicitly, the participant has some internal representation of p1(y) and p2(y). At the n th observation, the total information accumulated is I n � � r�1 n �I r � � r�1 n log�p1�yr�p2�yr�� . (A14) Observations continue as long as I2 � I n � I1, where I2 and I1 are constants. The response R2 (R1, respectively) is made at step n if I n � I2 (I n � I1, respectively). Because, from Equation 1 of the main text, I n � log�p1np2n� , we see that the accumulation of information according to this formulation is equivalent to making decisions using the SPRT with I2 � log Z2 and I1 � log Z1 (cf. Gold & Shadlen, 2002; Wald, 1947). 744 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN For example, if the desired ERs are �2 � �1 � ε, which is reasonable if the signals S1 and S2 are equally salient, from Equation A8 we take I2 � log� ε1 � ε� � 0, I1 � log�1 � εε � � �I2 � 0 (A15) (cf. Laming, 1968). (The signs follow from the assumed inequality A9.) If we require equal ERs in the case of signals of unequal salience, with � denoting the probability of S1, then, multiplying the boundaries of Equation A8 and taking logs, we find: I2 � log�1 � �� � � log� ε1 � ε� , I1 � log�1 � �� � � log�1 � εε � . (A16) To maintain I2 � 0 � I1, we must select an ER lower than the smaller of � and 1 � �. Thus, from Equation A14, in logarithmic variables, the trajectory I n is a discrete-time, biased random walk with initial condition zero: A new increment of information arrives, and the trajectory is updated, as the timestep advances from n 3 n 1 (recall that the increments �I r are assumed to be independent and identically distributed). The Continuum Limit of the SPRT Hereafter, we treat the continuous-time limit I(t) of the process described above, in which infinitesimal increments of information arrive at each moment in time. This limit must be taken with some care to preserve the variability present in Equation A14. First, we recall some generalities about the Wiener process W(t). The Wiener process (often called Brownian motion) on the interval [0, T] is a random variable W(t) that depends continuously on t � [0, T] and satisfies the following (Gardiner, 1985; Higham, 2001): • W(0) � 0. • For 0 � s � t � T, W(t) � W(s) � �t � sN(0, 1), where N(0, 1) is a normal distribution with zero mean and unit standard deviation. Because the normal distribution is used, the process is often referred as Gaussian. • For 0 � s � t � u � v � T, W(t) � W(s) and W(v) � W(u) are independent. In numerical simulations, the standard Wiener process is discretized with a timestep dt as dW �dtN�0, 1�. We now describe the continuum limit, which, up to an unimportant scale factor between timesteps n and the continuous time t, proceeds as follows. Let the �I r have mean m and variance D2 (assumed finite). Then, define the family (indexed by M � 1, 2, . . .) of random functions of t � [0, T], where T is some large time, as follows: IM�t� � 1 �M � r�1 k ��I r � m� � 1 M � r�1 k �I r, where k � Mt/T. (A17) Here, Mt/T is the largest integer smaller than Mt/T. Note that the first term of Equation A17 is normalized by 1/�M and the second by 1/M, reflecting the different rates at which fluctuations and means accumulate as the random increments are summed. For any M, IM(t) has mean mt/T and variance D2t/T; for example, from Equation A14, I n has mean mn and variance D2n. Furthermore, the Donsker invariance principle (see theorem 37.8 of Billingsley, 1995), together with the law of large numbers, implies that as M 3 , IM�t� f DW�t� � mt � I�t�, (A18) where W� is a Wiener process and the convergence of the random functions IM� is in the sense of distributions. In other words, the limiting process I(t) satisfies the stochastic differential equation dI � mdt � DdW, I�0� � 0, (A19) with boundaries I2 � 0 � I1. The drift m and variance D 2 of the �I r and hence of Equation A19 depend upon the distributions pi(y) (cf. Equation A13). For example, in the case of Gaussians (Appendixes continue) 745OPTIMAL DECISION MAKING p1�y� � 1 �2��2 e ��y��1�2/�2�2�, p2�y� � 1 �2��2 e ��y��2�2/�2�2�, (A20) with �1 � �2, we have �Ir � log�p1�yr�p2�yr�� � �1 � �2 �2 �yr � �1 � �22 � , (A21) and if Si is presented, the expected value of yr is E(yr) � �i, and the variance is Var(yr) � � 2. Thus, taking expectations and substituting in Equation A21, we obtain E��I r� � � ��1 � �2� 2 2�2 � m, (A22) (the applies if S1 is presented, the � if S2), and in both cases, Var��I r� � �1 � �2 � D 2 (A23) (cf. Gold & Shadlen, 2001, 2002). If each increment �I r is derived from many subobservations (e.g., from different regions of the visual field or from large populations of neurons), this Gaussian assumption is justified by the central limit theorem. In the particular case of Equation A21 in which �1 � ��2 � A, � � c, appropriate to tasks such as the moving dots paradigm in which the alternative stimuli are of equal clarity (e.g., Schall, 2001), the simplified form of Equation A21 implies that the accumulating information I n is simply a scaled version of the running total of observations yr: �I r � 2A c2 yr f I n � � r�1 n �Ir � 2A c2 � r�1 n yr � def 2A c2 yn. (A24) Assuming without loss of generality that S1 is presented, the yr has mean A and variance c 2 so that, in the continuous time limit analogous to Equation A17, the sequence of observations {yr} generates a random process y(t), which satisfies the drift diffusion stochastic differential equation: dy � Adt � cdW; y�0� � 0. (A25) The logarithmic SPRT involving observations �I r is therefore equivalent to solving the first passage problem defined by Equation A25 with thresholds y � z1 � (c 2/2A)Ii and Ii as in Equations A15–A16. We emphasize that the constant drift stochastic differential equation A19 or A25 is a particular limit of the discrete random walk occurring in the SPRT or Neyman–Pearson tests and that more general stochastic differential equations, such as O-U processes, correspond to other (i.e., nonop- timal) decision strategies. In the following sections, we analyze these stochastic processes in both unconstrained (free response) and time-constrained (interrogation) contexts. Optimal Decisions for the Free-Response Protocol As suggested by the above discussion, we model the decision-making process for the two- alternative forced-choice task as a one-dimensional drift diffusion process on the x-axis with two (symmetric) thresholds x � �z. The drift term represents the weight of evidence in favor of one alternative; diffusion arises from unmodeled inputs, represented as white noise. We consider diffusion and O-U models, both of which arise naturally in connectionist models of such tasks, as described in the main text. In the free-response protocol, in which participants are free to respond at any time after stimulus onset, we assume that a decision is made when the sample path first crosses either threshold; thus, we have a first passage problem. Here, we present formulae for the probabilities of first passage through the thresholds and of first passage times to either threshold, as may be derived from the backward Kolmogorov or Fokker–Planck equation (as in Busemeyer & Townsend, 1992; cf. Gardiner, 1985; Moehlis, Brown, Bogacz, Holmes, & Cohen, 2004). These in turn represent expected error and percentage-correct rates and mean DTs. We also derive expres- sions for the RR for these processes and show explicitly that the diffusion model allows higher RRs than are possible from an O-U model. 746 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN The first section, The Drift Diffusion Model, presents ERs, DTs, and RRs for the drift diffusion model and also finds the optimal threshold. The second section, The O-U Model, presents these quantities for the O-U model and then finds the optimal value of �. The third section describes the dependence of the optimal threshold on experimental delays that must be satisfied by any decision maker. The fourth section describes modifications to the theoretical predictions arising from the fact that participants must find the optimal threshold by learning. Finally, the fifth section derives optimal thresholds and optimal performance curves for the alternative reward criteria discussed in the text. As in the main text, we define the RR to be the probability of a correct response divided by the average time between responses. Allowing an imposed delay D � 0 between trials and an additional penalty delay Dp � 0 after incorrect responses and denoting nondecision part of RT by T0, RR � 1 � ER DT � D � T0 � DpER . (A26) We find it more convenient to consider 1/RR below. Similar analyses can be done for the other reward criteria defined in the section entitled A Theory of Optimal Thresholds in the main text. The Drift Diffusion Model In this section, we explicitly calculate ERs, DTs, and RRs for the drift diffusion model. This allows us to derive the crucial formula (Equation A33) for the unique optimal threshold in terms of task delays and the signal-to-noise ratio. The parameter dependence implicit in Equation A33, below, as discussed in the main text, leads to several experimentally relevant predictions about how thresholds should vary with task delays and signal and noise strengths. Consider the constant drift diffusion equation dy � Adt � cdW, y�0� � y0, (A27) with thresholds ay � �z , by � z. Without loss of generality, we take A � 0. Letting y � Ax and defining z̃ � z A � 0, ã � �Ac� 2 � 0, (A28) Equation A27 becomes dx � dt � 1 �ã dW, (A29) with thresholds a � �z̃, b � z̃ and initial condition x0 � y0/A. ERs, Mean DTs, and Reward Rates Using standard techniques for calculating the statistics of the first passage of trajectories of stochastic differential equations through boundaries (Gardiner, 1985; Moehlis et al., 2004; cf. appendix of Busemeyer & Townsend, 1993), it is readily shown that ER � 1 1 � e2z̃ã � � 1 � e�2x0ãe2z̃ã � e�2z̃ã� , (A30) DT � z̃ tanh�z̃ã� � �2z̃�1 � e�2x0ã�e2z̃ã � e�2z̃ã � x0� , and (A31) 1 RR � z̃ � D � T0 � �D � T0 � Dp � z̃�e �2z̃ã � � (1 � e2z̃ã)[(D � T0 � Dp � z̃)(1 � e2x0ã) � x0e2x0ã(1 � e2z̃ã)]e2z̃ã(e2�z̃ x0�ã � 1) � . (A32) Note, in particular, that the ER (Equation A30) may be made as small as we wish for a given drift and noise variance by picking the threshold z̃ � z sufficiently high. (Appendixes continue) 747OPTIMAL DECISION MAKING These expressions allow biased initial data, as suggested by the unequal salience case of the main-text section entitled Relationships Among the Models (cf. Equations A40–A41, below), but for the next subsection, we assume equal salience and unbiased initial data x0 � 0, in which case the expressions in braces in Equations A30–A32 vanish identically. Optimal Thresholds for the Drift Diffusion Model Suppose that we want to know the optimal value of z̃, say, z̃o, which maximizes the RR, or, equivalently, which minimizes 1/RR. Setting � � z̃ � 1RR�� z̃�z̃o � 0, z̃o is found from e2z̃oã � 1 � 2ã�Dtotal � z̃o�, (A33) where Dtotal � D T0 Dp. The left-hand side of Equation A33 vanishes at z̃o � 0 and is monotonically increasing in z̃o, whereas the right-hand side is positive at z̃o � 0 (provided Dtotal is non-negative) and is monotonically decreasing in z̃o. There is thus a unique solution to Equation A33. Moreover, it is a minimum because, using Equation A33 to eliminate Dtotal, we have �2 � z̃2 � 1RR�� z̃�z̃o � 2ãe�2z̃oã�1 � e2z̃oã� � 0. (A34) Thus, RR is maximized with respect to z̃ at z̃ � z̃o(ã, Dtotal). We note that because the left-hand side of (A33) is greater than 2z̃oã, it is necessary that z̃o � Dtotal/2. It is useful to give limiting expressions for Equation A32 for small and large z̃. Taylor-expanding Equation A32 in z̃ about z̃ � 0, we find that for small z̃, 1 RR � 2�D � T0� � Dp � 2ã�D � T0 � Dp�z̃. (A35) On the other hand, using lim z̃3 z̃ ne�z̃ã � 0 (A36) for any integer n � 0, we find that for large z̃, 1 RR � D � T0 � z̃. (A37) Figure A1a shows a plot of 1/RR as a function of z̃, including the small and large z̃ approximations. We note that even though the parameters in the drift diffusion first passage problem may be reduced to two (z̃ and ã), it is still of interest to see how the threshold zo that maximizes RR depends upon the original drift and noise root-mean-square parameters A, c, and on the delay parameters D, Dp, T0. Figure A1c illustrates these dependences and also shows the approximations valid for small and large values of the parameters: zo � A 2 Dtotal, for large c, or small Dtotal , or small A, and (A38) zo � c2 2A log 2A2c2 Dtotal , for small c, or large Dtotal, or large A. (A39) Biased Initial Conditions in the Drift Diffusion Model In the event of unequal salience (� � 1/2), rather than employing the asymmetric boundaries of Equation A16, we may transform by letting y � y (c2/2A)log(�/(1 � �)), and consider the process A19 with biased initial data y�0� � c2 2A log� �1 � �� (A40) 748 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN and symmetric boundaries �z � 0 � z � c2 2A log�1 � εε � . (A41) Thus, when � � 1/2, the process starts closer to the threshold corresponding to the more probable alternative. (Appendixes continue) 0 5 10 15 20 0 5 10 15 20 z o c 0 1 2 3 4 5 0 0.5 1 1.5 2 2.5 3 z o A Exact Large Small 0 2 4 6 8 10 0 10 20 30 40 1 /R R λ = 0.1 0 2 4 6 8 10 0 10 20 30 40 1/ R R λ = 0 0 20 40 60 80 100 0 0.5 1 1.5 2 2.5 3 D total z o 0 2 4 6 8 10 0 10 20 30 40 1 /R R λ = −0.1 z̃ z̃ z̃c) a) b) −0.5 −0.25 0 0.25 0.5 12.4 12.5 12.6 12.7 12.8 12.9 13 13.1 λ 1/ R R −0.5 −0.25 0 0.25 0.5 1 1.5 2 2.5 3 λ D T −0.5 0 0.5 −0.01 0 0.01 0.02 0.03 0.04 0.05 E R λ −0.1 −0.05 0 0.05 0.1 1.9 1.95 2 2.05 2.1 2.15 2.2 λ −0.1 −0.05 0 0.05 0.1 0.0799 0.08 λ z̃ o ( λ ) RR(z̃o ( λ )) d) e) Figure A1. Validity of approximations. a: 1/RR as a function of z̃ for the drift diffusion model with ã � 1, D � 10, and Dp � 20. The solid line shows the exact result given by Equation A32, whereas the dashed lines show the small and large z̃ approximations given by Equations A35 and A37. b: 1/RR as a function of z̃ for the Ornstein–Uhlenbeck model for ã � 1, D � 10, and Dp � 20. Values of � are shown above panels. Here, the s are from the exact formula (Equation A57), and the solid (dot-dashed, respectively) lines are results from Equation A66 to O(�2) (O(�), respectively). The dashed lines show the small and large z̃ approximations given by Equations A67 and A68. c: Threshold zo, which optimizes RR as a function of the original system parameters, with left panel: A � 1, c � 1; middle panel: A � 1, Dtotal � 30; right panel: c � 1, Dtotal � 30. Approximations for small (large, respectively) parameter values are shown as dashed (dotted, respectively) lines. d: Validity of approximations for z̃ � 2, ã � 1, D � 10, and Dp � 20. Here the s are from the exact formulae (Equations A55, A56, and A57), and the solid (dashed, respectively) lines are results from Equations A64, A65, and A66 to O(�2) (O(�), respectively). e: For fixed �, z̃o(�) maximizes RR, giving RR(z̃o(�)). Results for ã � 1, D � 10, and Dp � 20, where z̃o(�) is found from ( s) exact formula A57, (solid line) Equation A66 to O(� 2), and (dashed line) Equation A66 to O(�). DT � decision time; ER � error rate; RR � reward rate. 749OPTIMAL DECISION MAKING As discussed at the end of the section entitled Probability Ratio Tests, above, the SPRT allows for unequal prior stimulus probabilities by biasing the thresholds or, equivalently, biasing the initial condition taken in the drift diffusion model (cf. Equation A40). We consider this only for the (optimal) drift diffusion model (see Equations A27–A29). As above, we denote the probability of stimuli S1 and S2 (drifts � A) as � and 1 � �, respectively, and the ERs and mean DTs as ER(�) and DT(�). The net ER and mean DT are then given by NER � �ER� � � �1 � ��ER���, and NDT � �DT� � � �1 � �� DT���. (A42) We note that ERs and DTs for biased initial data, as given in Equations A30–A31, apply to the case A � 0 but that the reflection transformation x � �x takes sample paths of Equation A29 with A � 0 to those for A � 0; we may thus simply substitute �x0 for x0 in those expressions to obtain ER(�) and DT(�), which yields NER � 1 1 � e2z̃ã � �1 � �e�2x0ã � (1 � �)e2x0ãe2z̃ã � e�2z̃ã � , and (A43) NDT � z̃ tanh z̃ã � 2z̃�1 � �e�2x0ã � (1 � �)e2x0ãe2z̃ã � e�2z̃ã � � �1 � 2��x0. (A44) Substitution of the appropriate (optimal) biased initial condition (see Equation A40), which may be written in the following form in the scaled variables, x0 � y�0� A � 1 2ã log� �1 � �� N e2x0ã � �1 � � , (A45) then gives the following expressions for net ER and DT: NER � 1 1 � e2z̃ã , and (A46) NDT � z̃ tanh z̃ã � �1 � 2�� 2ã log� �1 � �� . (A47) It is interesting to note that for fixed z̃ and ã, the ER takes the same value for all 0 � � � 1 and that DTs decrease symmetrically from the maximum at � � 1/2 to zero at � � 1/(1 e�2z̃ã), for which values the initial condition falls on a threshold. Moreover, the biased initial condition given by Equation A45 also maximizes the RR. Modifying the definition of Equation A26 to read NRR � 1 � NER NDT � D � T0 � DpNER , (A48) a lengthy calculation reveals that � � z̃ �NRR� � � �x0 �NRR� � 0, (A49) with x0 given by Equation A45 and z̃ by the solution z̃o of e2z̃oã � 1 � 2ã�Dtotal � z̃o� � �1 � 2��log� �1 � �� . (A50) We have checked (numerically) that this critical point is indeed a maximum. Hence, noting that the final term in Equation A50 is even about � � 1/2 and strictly negative for � � 1/2, this formula shows explicitly how optimal thresholds are lowered in choice tasks with stimuli of unequal salience. Moreover, as pointed out in the section entitled Biased Probabilities and the Optimal Decision Threshold in the main text, we may compute a relationship among the salience �, the total delay Dtotal, and the signal-to-noise ratio ã at which the optimal bias and optimal threshold coincide. Setting xo � z̃o and replacing them in Equation A50 by means of Equation A45, we obtain 750 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN ã � 2� � 11 � � � 2� log� �1 � �� 2Dtotal . (A51) Note that, as expected, Equation A51 gives ã � 0 for � � 1/2, and ã increases as � increases from 1/2 or Dtotal decreases with � � 1/2. For ã less than the value given by Equation A51, xo � z̃o, which implies that the more salient stimulus should be selected immediately upon presentation. The O-U Model In this section, we present explicit expressions for ERs, DTs, and RRs for the O-U model. Additionally, we develop asymptotic approximations to these complicated expressions that are valid for large thresholds and/or for small deviations � from the drift diffusion model. These latter approximations determine just how suboptimal RRs will become for systems that are not perfectly tuned to achieve constant drift (e.g., for a mutual inhibition model with slightly imbalanced decay and inhibition). We also use our explicit formula for RRs to provide arguments independent of the SPRT to show that optimal RRs are achieved for the drift diffusion processes. In this section, we restrict to equal salience stimuli � � 1/2 and unbiased initial data x0 � 0. Consider the O-U process dy � ��y � A�dt � cdW, (A52) with thresholds ay � �z, by � z. Letting y � � A � � Ax and using z̃, ã as defined in Equation A28, dx � �xdt � 1 �ã dW, (A53) with thresholds a � �z̃ 1/�, b � z̃ 1/�. ERs, Mean DTs, and Reward Rates Suppose we have an unbiased initial condition, that is, y0 � 0 f x0 � 1/�. Then, where erf�z� � 2 �� � 0 z e�t 2 dt denotes the error function, erfc�z� � 2 �� � z e�t 2 dt � 1 � erf�z� is the complementary error function (used below), and D�z� � e�z 2 � 0 z et 2 dt, (A54) which is known as Dawson’s integral, it may be shown that (Moehlis et al., 2004) ER � erf� �ã� (1 � �z̃)� � erf� �ã�� erf� �ã� (1 � �z̃)� � erf� �ã� (1 � �z̃)� � def erfc� erfc� � � 1 erfc��� erfc� � � 1 , (A55) (Appendixes continue) 751OPTIMAL DECISION MAKING DT � 2 � erf� �ã� (1 � �z̃)� � erf� �ã� (1 � �z̃)� � erf��ã�� � erf� �ã� (1 � �z̃)� � � � ã/� � ã/��1 �z̃� D(z)dz erf��ã�� � erf� �ã� (1 � �z̃)� � �ã/��1��z̃� �ã/� D(z)dz� � 2 � � erfc(�) erfc( ) � erfc� erfc( ) D1 � erfc�erfc( ) � 1 D2 erfc(�) erfc( ) � 1 � , and (A56) 1 RR � D � T0 � 2 � D1 � �D � T0 � Dp � 2� D2��erf� � ã � (1 � �z̃)� � erf� �ã�� erf� �ã�� � erf� �ã� (1 � �z̃)�� � D � T0 � 2 � D1 � �D � T0 � Dp � 2� D2�� erfc� erfc( ) � 1 erfc(�) erfc( ) � erfc� erfc( ) � . (A57) Here, erfc� � erfc� �ã�� , erfc� � � erfc� �ã� (1 � �z̃)� , erfc��� � erfc� �ã� (1 � �z̃)� , D1 � � � ã/� � ã/��1 �z̃� D�z�dz , D2 � � �ã/��1��z̃� �ã/� D�z�dz. Note that these formulae apply to both positive and negative �, via the definition of the error function with imaginary argument: 2 �� � 0 z et 2 dt � erfi�z� � i erf��iz�. Asymptotic Approximations ER for large thresholds and � � 0. If � � 0, as the threshold z̃ � z is taken to infinity in Equation A55, we have lim z̃3 ER � 1 2 1 � erf� �ã�� ; � � 0, (A58) which only approaches zero as �3 0 . Therefore, in contrast to the constant drift (� � 0) case of Equation A30, the ER always remains strictly positive if � � 0, even as DTs increase to infinity. ER for large thresholds and � � 0. If � � 0, we have lim z̃3 ER � 0; � � 0. (A59) Therefore, zero ERs are (asymptotically) possible for negative � even when it is nonzero, in contrast to the interrogation protocol, in which case zero ERs occur only when � � 0 (see Equation A94, below). Note, however, that as z̃ 3 with � � 0, DTs rapidly increase to infinity because the probability density of solutions is exponentially confined within the thresholds, suggesting that such a strategy is irrelevant to behavior. ER, DT, and RR for small �. Equipped with the exact expressions (Equations A55–A57), in principle we can numerically calculate ER, DT, and 1/RR for any values of the parameters z̃, 752 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN ã, �, D, T0, and Dp. However, the evaluation of the integrals in the formulae becomes difficult for small �, which turns out to be the region of greatest interest. Also, it is difficult from the exact formulae to see how ER, DT, and 1/RR vary with the parameters. To gain insight into these issues, we now expand the expressions for small �. Note that we treat z̃ as an O(1) quantity to obtain the following expansions. First, we recall the expansion of the complementary error function for large z (Equation 7.1.23 of Abramowitz & Stegun, 1984): erfc�z� � e�z 2 ��z �1 � 12z2 � 34z4 � · · ·� . This gives erfc��� erfc� � � e4z̃ã�1 � �z̃1 � �z̃� �1 � �2ã(1 � �z̃)2 � 3� 2 4ã2(1 � �z̃)4 � · · ·� �1 � �2ã(1 � �z̃)2 � 3� 2 4ã2(1 � �z̃)4 � · · ·� � e4z̃ã�1 � 2z̃� � 2z̃(z̃ã � 1)ã �2� � O��3�, and (A60) erfc� erfc� � � e2z̃ã z̃ 2ã�(1 � �z̃) �1 � �2ã � 3� 2 4ã2 � · · ·� �1 � �2ã(1 � �z̃)2 � 3� 2 4ã2�1 � �z̃)4 � · · ·� � e2z̃ã�1 � z̃(1 � z̃ã)� � z̃2ã (z̃3ã3 � 2z̃2ã2 � 2)�2� � O��3�. (A61) We also use the following expansion for Dawson’s integral from Spanier and Oldham’s (1987) Equation 42:6:6, valid for large z: D�z� � 1 2z � 1 4z3 � 3 8z5 � · · · . This implies that D1 � z̃ 2 � � z̃�1 � z̃ã� 4ã �2 � z̃�9�1 � z̃ã� � 4z̃2ã2� 24ã2 �3 � O��4�, and (A62) D2 � z̃ 2 � � z̃�1 � z̃ã� 4ã �2 � z̃�9�1 � z̃ã� � 4z̃2ã2� 24ã2 �3 � O��4�. (A63) Using these formulae in Equations A55, A56, and A57 gives the approximations ER � ER0 � �ER1 � � 2ER2 � O�� 3�, (A64) where ER0 � 1 1 � e2z̃ã , ER1 � z̃e2z̃ã e4z̃ã � 1 �z̃ã � tanh�z̃ã��, ER2 � z̃e 2z̃ã��4z̃ãe2z̃ã��1 � e2z̃ã� � 2��1 � e2z̃ã�2�1 � e2z̃ã� � z̃3ã3��1 � e2z̃ã��1 � e2z̃ã�2 � 2z̃2ã2�1 � e2z̃ã � e4z̃ã � e6z̃ã��/�2ã��1 � e2z̃ã�2�1 � e2z̃ã�3�, and DT � DT0 � �DT1 � � 2DT2 � O�� 3�, (A65) where (Appendixes continue) 753OPTIMAL DECISION MAKING DT0 � z̃ tanh�z̃ã�, DT1 � z̃� tanh(z̃ã) � z̃ã2ã � 2z̃e 2z̃ã e4z̃ã � 1 [e2z̃ã(1 � tanh(z̃ã)) � (1 � z̃ã)]� , DT2 � z̃��12z̃ 4ã4e2z̃ã��1 � e2z̃ã��1 � e2z̃ã�2 � 9��1 � e2z̃ã�3�1 � e2z̃ã�2 4z̃2ã2��1 � e2z̃ã�3�1 � e2z̃ã � e4z̃ã� � 24z̃3ã3e2z̃ã�1 � e2z̃ã � e4z̃ã � e6z̃ã� � 3z̃ã��1 � e2z̃ã�2�3 � 13e2z̃ã � 13e4z̃ã � 3e6z̃ã�)/�12ã2��1 � e2z̃ã�2�1 � e2z̃ã�3�, and 1 RR � A0 � �A1 � � 2A2 � O�� 3�, (A66) where A0 � z̃ � D � T0 � �D � T0 � Dp � z̃�e �2z̃ã, A1 � z̃ (1 � z̃ã)(1 � e�2z̃ã)2ã � Dtotale�2z̃ã � (Dtotal � z̃)z̃ãe�2z̃ã�e 2z̃ã � 1 e2z̃ã � 1� , and A2 � z̃��6z̃ 4ã4�1 � e2z̃ã�2 � 3z̃ã��1 � e2z̃ã���5 � 2e2z̃ã � 3e4z̃ã � 4ãDtotal� 3��1 � e2z̃ã�2�3��1 � e2z̃ã� � 4ãDtotal� � 6z̃ 3ã3��1 � 4e2z̃ã � e4z̃ã � ã�1 � e2z̃ã�2Dtotal� � 4z̃2ã2����1 � e2z̃ã�3 � 3ã��1 � 2e2z̃ã � e4z̃ã�Dtotal�)/�12ã 2e2z̃ã��1 � e2z̃ã�2�. Here, the O(�2) expressions were obtained using Mathematica. Notice that for � � 0, Equations A64, A65, and A66 are identical to Equations A30, A31, and A32. We verify the validity of these approxi- mations in Figure A1b. RR for small � and large thresholds. It is also instructive to find approximations for 1/RR for small and large z̃; to obtain these, we start with the expression for 1/RR valid to O(�2), then consider the limit in z̃. Using an analogue to Equation A36, we find that for small z̃, 1 RR � 2�D � T0� � Dp � 2ã�D � T0 � Dp�z̃, (A67) as for the drift diffusion model (cf. Equation A35). For large z̃, 1 RR � D � z̃ � � z̃ 2 �1ã � z̃� � �2z̃�9(1 � z̃ã) � 4z̃ 2ã2 12ã2 � 3 �2z̃3 3 for z̃ 3 . �� 0�. (A68) The validity of these results is examined in Figure A1d. Optimizing Reward Rates for Unbiased Data We now show that (z̃, �) � (z̃o, 0), where z̃o is found from Equation A33, minimizes 1/RR, that is, maximizes RR. First, using Equation A33, we have � � z̃ � 1RR�� �z̃,����z̃o,0� � �A0 �z̃ � z̃�z̃o � 0. (A69) Now, from Equation A66, � �� � 1RR� � � z̃,����z̃o,0� � A1� z̃�z̃o � z̃oe �2z̃oã (1 � z̃oã)(e2z̃oã � 1)2ã � Dtotal � (Dtotal � z̃o)z̃oã�e 2z̃oã � 1 e2z̃oã � 1� . (A70) Solving Equation A33 for e2z̃oã and substituting into Equation A70, we find that all terms cancel, that is, 754 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN � �� � 1RR� � � z̃,����z̃o,0� � 0. (A71) The point (z̃, �) � (z̃o, 0) is called a stationary point because conditions in Equations A69 and A71 are satisfied. The condition for the stationary point (z̃, �) � (z̃o, 0) to be a local optimum involves the Hessian of 1/RR evaluated at the stationary point, that is, H � � �2 ��2 � 1RR�� �z̃,����z̃o,0� �2 �z̃�� � 1RR�� �z̃,����z̃o,0� �2 �z̃�� � 1RR�� �z̃,����z̃o,0� �2 �z̃2 � 1RR�� �z̃,����z̃o,0� � . (A72) The stationary point is a local minimizer (maximizer, respectively) of 1/RR if H is positive (negative, respectively) definite, that is, if H has two positive (two negative, respectively) eigen- values. If H has one positive and one negative eigenvalue, then the stationary point is called a saddle point, and it is neither a local minimizer nor a local maximizer. From Equation A34, �2 � z̃2 � 1RR�� �z̃,����z̃o,0� � �2A0 �z̃2 � z̃�z̃o � 2ãe�2z̃oã�1 � e2z̃oã� � 0. (A73) Using this, we conclude that if det(H) � 0, then H is positive definite. Using Equation A33 to eliminate Dtotal, �2 ��2 � 1RR� � � z̃,����z̃o,0� � 2A2� z̃�z̃o � z̃o�15�e 2z̃oã � 1�2 � 9z̃oã�e 4z̃oã � 1� � 3z̃o 3ã3�e4z̃oã � 1� � 2z̃o 2ã2�1 � 10e2z̃oã � e4z̃oã�� 6ã2e2z̃oã�e2z̃oã � 1� , and �2 � z̃�� � 1RR�� �z̃,����z̃o,0� � �A1 �z̃ � z̃�z̃o � z̃o�1 � e 2z̃oã��1 � e2z̃oã � z̃oã�1 � e 2z̃oã�� e2z̃oã�1 � e2z̃oã� . From these expressions, after simplifying, the condition that det(H) � 0 becomes 0 � det�H� � z̃o�1 � e 2z̃oã��15�e2z̃oã � 1�3 � 4z̃o 2ã2�e2z̃oã � 1�3 � 12z̃o 3ã3e2z̃oã�1 � e2z̃oã� � 12z̃oã�e 2z̃oã � 1�2�1 � e2z̃oã�)/�3ãe4z̃oã�e2z̃oã � 1�2�. (A74) For example, for ã � 1, D � 10, Dp � 20, and T0 � 0, we find that z̃o � 2.02115 and that H � � 3.9253 �2.2487�2.2487 2.0351� , det�H� � 2.9317 � 0; thus, (z̃, �) � (z̃o, 0) is a local minimizer of 1/RR, that is, a local maximizer of RR. For reference, the eigenvalues of H for these parameters are 5.4194 and 0.5410. Although we have not been able to prove that det(H) is positive for all possible parameter values, it is found numerically to be true for all choices considered (Moehlis et al., 2004). We can interpret these results as follows: Given �, it is possible to choose z̃o(�)—say, by choosing the threshold z—to maximize the RR; however, it is even better to first adjust so that � � 0, then choose z̃ to maximize RR. This is illustrated in Figure A1e, which also emphasizes that care must be used in applying the O(�) formulae. Dependence of the Optimal Threshold on Experimental Delays In this section, we show that the dependence of the optimal threshold on D Dp (rather than D and Dp separately) is true for any decision maker. Consider a decision maker whose ER(z) and RT(z) are functions of the decision threshold z. As for the previous decision models, for the optimal (Appendixes continue) 755OPTIMAL DECISION MAKING threshold, the derivative of 1/RR must be equal to zero. Using elementary calculations, we compute the derivative � �z � 1RR� � RT��z� � ER��z��D � Dp� � RT��z� ER�z� � RT�z� ER��z��1 � ER�z��2 . Note that the above derivative does not depend on D and Dp separately but depends only on D Dp. Therefore, the optimal threshold must also depend only on D Dp for any decision maker. Threshold Resulting From Learning In this subsection, we consider the case in which a small error of ε is made in estimation of the optimal threshold z̃o. We show that overestimation of the threshold results in higher RRs than underestimation of the threshold, that is, RR� z̃o � ε� � RR�z̃o � ε� � 0. (A75) From Taylor expansion, we obtain RR� z̃o � ε� � RR�z̃o� � RR��z̃o�ε � RR��z̃o� 2 ε2 � RR��z̃o� 6 ε3 � O�4� � O�5�, and RR� z̃o � ε� � RR�z̃o� � RR��z̃o�ε � RR��z̃o� 2 ε2 � RR��z̃o� 6 ε3 � O�4� � O�5�. Because z̃o is the threshold maximizing RR, RR�(z̃o) � 0; hence, RR� z̃o � ε� � RR�z̃o � ε� � RR��z̃o� 3 ε3 � O�5�. To prove Equation A75, it therefore suffices to show that RR�(z̃o) � 0. In the beginning of this section, we noticed that instead of considering RR, it is more convenient to consider its inverse, 1/RR; let us denote it by f � 1/RR. Using the chain rule and the fact that f �(z̃o) � 0, we compute that RR�� z̃o� � �3 �z̃ 3 � 1f �z̃o�� � � f ��z̃o� �f �z̃o�� 2 . Because the denominator of the above equation is positive, for small ε the inequality given by Equation A75 is equivalent to f �(z̃o) � 0. Elementary calculations show that f ��z̃o� � �4ã 2e�2z̃oã�3 � 2ã�Dt � z̃o��, and substituting the condition for the optimal threshold (see Equation A33) into this equation, we obtain f ��z̃o� � �4ã 2e�2z̃oã�2 � e2z̃oã� � 0, which proves Equation A75. Other Reward Criteria Here, we consider three further reward criteria discussed in the main text, deriving optimal thresholds and optimal performance curves for each. We assume equal stimulus salience (� � 1/2) and unbiased initial conditions (x0 � 0). Bayes Risk The first criterion is the BR given by Equation 41 in the main text, which is a special case of the criteria considered by Edwards (1965), who also obtained the following two equations. Because ER decreases exponentially and DT grows faster than linearly with z̃, BR has a unique critical point, a minimum. The optimal threshold z̃o (that minimizes BR for given ã, Dtotal, c1, and c2) is given by substituting Equations A30–A31 with x0 � 0 into Equation 41, differentiating with respect to z̃, and setting the result equal to zero, which yields 756 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN e2z̃oã � e�2z̃oã 2ã � 2z̃o � c2 c1 � def q. (A76) (As noted in the main text, the weight ratio q must have the units of time for consistency.) Substituting for z̃ � z̃o and ã in terms of ER and RT from Equations 55–56, we then obtain the following family of optimal performance curves: DT q � �1 � 2ER�log�1 � ERER � 2 log�1 � ERER � � 11 � ER � 1ER . (A77) Clearly, we require c2(q) strictly positive. The maximum of this optimal performance curve always lies to the left of the corresponding maximum for RR (cf. Figure 13 in the main text). The Reward/Accuracy Function Next, we consider the RA function given by Equation 43 where we assume Dp � 0. Repeating the above procedure and differentiating with respect to z̃ to find the optimal threshold, we obtain a quotient whose denominator never vanishes and whose numerator vanishes if z̃ � z̃o with �1 � e�2z̃oã � 2ã�Dtotal � z̃o�e �2z̃oã��e2z̃oã � 1�2 2ãe2z̃oã�z̃o�1 � e �2z̃oã� � Dtotal�1 � e �2z̃oã��2 � c2 c1Dtotal � def q Dtotal . (A78) Because RR has a unique critical point (a maximum) and ER is monotonically decreasing as a function of z̃, satisfaction of Equation A78 yields the unique maximum of RA for given set task parameters. Substituting for z̃ � z̃o and ã, after some algebra, we obtain 1 � ER log�1 � ERER ��DtotalDT � 11 � 2ER� ER log�1 � ERER ��1 � DtotalDT � 2 � q DT Dtotal . (A79) This quadratic equation in DT/Dtotal may be solved to give a family of optimal performance curves parameterized by q, the relative weight of errors: DT Dtotal � E � 2q � �E2 � 4q�E � 1� 2q , (A80) where E � � 1 ER log�1 � ERER � � 1 1 � 2ER� . (A81) (See Figure 13b in the main text.) Observe that E is precisely the ER expression that appears in Equation 58 for RR; indeed, as q3 0 the right-hand side of Equation A80 converges on Equation 58, confirming that the negative square root is the appropriate choice. Moreover, computing the derivative of the right-hand side of Equation A80 with respect to ER, we find that the peak in the optimal performance curves falls at the same ER regardless of the value of the weight ratio q. This value corresponds to dE dER � 0 f log�1 � ERER � � 2� ER log�1 � ERER � 1 � 2ER � 2 � 1 1 � ER f ER � 0.174. (A82) The Modified Reward Rate Finally, we consider RRm given by Equation 44, where we again set Dp � 0. Again substituting for ER and RT and rearranging, we obtain (Appendixes continue) 757OPTIMAL DECISION MAKING 1 RRm � z̃�1 � e�2z̃ã� � Dtotal�1 � e �2z̃ã� 1 � c2 c1 e�2z̃ã ; (A83) differentiation with respect to z̃ then leads to the following condition for a critical point of RRm. e2z̃oã � 1 � 2ã�Dtotal � z̃o� 1 � e�2z̃oã � 2ã�Dtotal � z̃o� � c2 c1 � def q. (A84) (Exactly as for RA, that this corresponds to a maximum of RRm follows from the fact that it is the sum of a function with a single maximum and a function decreasing in z̃.) Finally, substituting for z̃ � z̃o and ã, we obtain a third family of optimal performance curves: DT Dtotal � �1 � q�� 1 ER � q 1 � ER log�1 � ERER � � 1 � q 1 � 2ER� �1 . (A85) For q � 0 (c2 � 0, c1 � 0), this reduces to Equation 58 as expected. Optimal Decisions Under the Interrogation Protocol We now suppose that participants are interrogated at a fixed time after stimulus onset and are required to respond as soon as possible after interrogation. The appropriate model is again a drift diffusion model, but now, sample paths are assumed to evolve until interrogation, at which instant, we interpret the probability of responses R1 and R2 by asking if a given sample path is closer to the threshold at y � z or the threshold at y � �z, respectively. If no limits are imposed on the sample paths (i.e., they are allowed to evolve freely without bound), this is the continuum analog of the (optimal) Neyman–Pearson test. This case is considered in this section, in which the formula (Equation A92) for the ER as a function of model parameters and interrogation time is developed. This formula demonstrates the qualitative difference between long-time interrogations of the drift diffusion model, which yield vanishingly few errors, and long-time interrogations of the O-U model, which always give nonzero ERs. We then explicitly demonstrate that the drift diffusion model yields optimal ERs for all possible interrogation times and model parameters (see the section entitled Highest Accuracy for Fixed DTs: The Interrogation Paradigm, in main text). Specifically, we evaluate the integrals of the probability distribution of solutions p(x, t) of the forward Kolmogorov or Fokker–Planck equation for solutions to the appropriate stochastic differ- ential equation between � and 0 and 0 and , respectively to evaluate the expected percentage- correct rates and ERs. Note that a sample path may cross and recross either threshold multiple times or cross neither during the interval before interrogation. We again consider the O-U model of Equation A52: dy � ��y � A�dt � cdW. (A86) Including the limit �3 0, this encompasses both the cases treated above. As shown in Section 3.2 of Busemeyer and Townsend (1992), the probability p(y, t)dy that a solution of Equation A86 occupies a point in [y, y dy] at time t is p�y, t� � 1 �2��2�t� exp �(y � �(t)) 2 2�2(t) , (A87) with ��t� � A � �e�t � 1� � y0e �t, and �2�t� � c2 2� �e2�t � 1�, (A88) where we have assumed the (general, possibly biased) initial condition p(y, 0) � �(y � y0) corresponding to starting all paths of Equation A86 at y(0) � y0. Note that the expressions of Equation A88 for mean and variance hold for both positive and negative � and that as �3 0, they approach the corresponding expressions for the drift diffusion model: 758 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN ��t����0 � At � y0, and � 2�t����0 � c 2t. (A89) Assuming that the upper threshold y � z represents the correct alternative, the probabilities of correct and incorrect choices being made upon interrogation at time t are therefore P�correct� � 1 � ER � � 0 p�y, t�dy, and P�incorrect� � ER � � � 0 p�y, t�dy. (A90) Evaluating these integrals, we obtain (cf. Section 3.2 of Busemeyer and Townsend, 1992) P�correct� � � ���/�2�2� 1 �� e �u2du � 1 2 1 � erf� ��2�2� , and (A91) P�incorrect� � ER � 1 2 1 � erf� ��2�2� . (A92) Inserting the appropriate expressions for �(t) and �2(t) into Equation A92, we see an important qualitative difference between the drift diffusion and O-U models for asymptotically large values of the interrogation time t. For the drift diffusion model (Equation A89), lim t3 ER � 0, (A93) whereas for the O-U model (Equation A88), lim t3 ER � 1 � erf� Ac����� � 0. (A94) Thus, as discussed in the section entitled Interrogation Paradigm in the main text, the O-U model gives nonzero ERs for infinite-time interrogations, whereas the drift diffusion model gives perfect performance in this case. Minimizing ER for Unbiased Choices We first consider the case of unbiased initial data, appropriate to choice tasks with alternatives of equal probability. Using Equation A88 with y0 � 0, the argument of the error functions in Equations A91–A92 takes the form � �2�2 � def f ��; A, c� � A c � �e �t � 1� ��e�t � 1� . (A95) Because erf� is a monotonically increasing function of its argument on (� , ), the probability of making a correct decision will be maximized (and the ER minimized) by selecting the maximum admissible value of this expression. The appropriate constraints are to fix A and t and maximize Equation A95 over � � (� , ). We claim that the unique (global) maximum is achieved for � � 0: lim �30 f ��; A, c� � A c � t2 . (A96) To prove this, it suffices to show that �f /�� � 0 at � � 0 and that �f /�� is strictly positive (negative, respectively) for � � 0 (� � 0, respectively). We compute �f �� � A 2c ���e �t � 1� e�t � 1 2�te �t � e2�t � 1 �2�e�t � 1�2 �def A2c F��, t��2�te�t � e2�t � 1�, (A97) where F(�, t) is a bounded positive quantity for � � 0, t � 0, and the expression as a whole vanishes (� ��t5/2) at � � 0. The final quantity in parentheses in Equation A97 is positive (negative, respectively) for � � 0 (� � 0, respectively), as required. We conclude that the optimal strategy is to set � � 0. (Appendixes continue) 759OPTIMAL DECISION MAKING Minimizing ER for Biased Choices We now repeat the calculations allowing biased initial data and unequal prior probabilities for the two alternatives. As in our review of SPRT in the first section of this appendix, let � denote the probability of a stimulus corresponding to the upper threshold, with drift A, and let 1 � � correspond to �A. Letting ER(�) � ER(�A, �, c, x0) denote the ERs in the two cases, the net ER (NER) is NER � �ER� � � �1 � �� ER���. (A98) ER( ) is given by substitution of the general (y0 � 0) expressions of Equation A88 into Equation A92. To obtain ER(�), we observe that the reflection transformation y � �y takes sample paths of Equation A86 with A � 0 to those for A � 0; we may thus simply substitute �y0 for y0 in Equation A88, obtaining NER � 1⁄2�1 � �erf�f � � �1 � ��erf�f���, (A99) where f � � f���, y0; A, c� � A c � �e �t � 1� ��e�t � 1� � y0 c � �e 2�t e2�t � 1 , (A100) and, for future use, �f � �y0 � � 1 c � �e 2�t e2�t � 1 � def ��fy0, and �f � �� � A 2c F��, t��2�te�t � e2�t � 1� � y0 2c�� �e �t(e2�t � 1 � 2�t) (e2�t � 1)3/ 2 � �def �f�1 � �f�2. (A101) To minimize the NER, we compute the partial derivatives of Equation A99: � �y0 �NER� � 1 �� ��� exp��� f �2� � �1 � ��exp��� f ��2���fy0, and (A102) � �� �NER� � � 1 �� ��� exp��� f �2� � �1 � ��exp��� f ��2���f�1 � �� exp��� f �2� � �1 � ��exp��� f ��2���f�2�. (A103) Setting Equation A102 equal to zero and using Equation A100, we obtain exp�� f �2 � � f ��2� � � 1 � � f 4Ay0e �t c2�e�t � 1� � log� �1 � �� , (A104) and substituting Equation A104 into Equation A103 and using the properties of �f�1 derived directly below Equation A97, we conclude that � � 0 and y0 � c2 2A log� �1 � �� (A105) at the critical point. To check that this is indeed a minimum, we compute the Hessian matrix of second partial derivatives at Equation A105, obtaining �2 �y0 2 �NER� � 2 �� � exp��� f �2�� f � f ����fy0� 2 � 2 �� � exp��� f �2� A �2tc3 , �2 ��2 �NER� � 2 �� � exp��� f �2�� f � f����f�2� 2 � 2 �� � exp��� f �2� Ay0 2t3/ 2 4�2c3 , and �2 �y0�� �NER� � 2 �� � exp��� f �2�� f � f����fy0�f�2� � 2 �� � exp��� f �2� Ay0�t 2�2c3 . (A106) 760 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN The second variation is therefore positive semidefinitely, vanishing only along the line y0 � c2 2A log� �1 � �� 1 � �t2 , and direct computations of NER (for all parameters we sampled) show that the point (see Equation A105) is indeed a minimum along this line. The Extended Drift Diffusion and O-U Models In this section, we consider variable drift rates A and initial values x0. In the first subsection, we derive ER and DT expressions for the extended drift diffusion model. Instead of explicitly writing analogues for the extended O-U process, in the second subsection we argue that for an O-U process in which only the drift varies from trial to trial, optimal performance in the interrogation protocol still results from the choice � � 0. Finally, in the third subsection, we give a simple argument that determines a lower bound on the ER for both the extended drift diffusion and the extended O-U models that holds for both the interrogation and free-response protocols. ER and DT for the Extended Drift Diffusion Model in the Free-Response Protocol Averaging Over Uniform Distribution of Initial Conditions We now let the initial condition y0 be uniformly distributed in the range [�sx, sx] with probability density p�y0� � � 12sx �sx � y0 � sx 0 otherwise . Recalling the coordinate change x � y/A, this implies that x0 has probability density p�x0� � � A2sx �sx /A � y0 � sx /A 0 otherwise . The average of ER(x0) from Equation A30 over such starting points is ER!x0 � 1 1 � e2z̃ã � �1 � A 2sx � ��sx/A� sx/A e�2x0ãdx0 e2z̃ã � e�2z̃ã � . Evaluating this integral and defining s̃x � sx/A, we find that ER!x0 � 1 1 � e2z̃ã � � 1 4ãs̃x �e2ãs̃x � e�2ãs̃x� � 1 e2z̃ã � e � 2z̃ã � , (A107) and similarly, from Equation A31, that DT!x0 � z̃ tanh�z̃ã� � �2z̃ � z̃ 2ãs̃x (e2ãs̃x � e�2ãs̃x) e2z̃ã � e � 2z̃ã � . (A108) Additional Averaging Over a Gaussian Distribution of Drift Rates We now additionally allow the drift rate to be Gaussian distributed with mean mA and variance sA 2: p�A� � 1 �2�sA2 e���A�mA� 2/ 2sA 2 �. The resulting averages are ER!x0,A � � � p�A� ER!x0dA, and (A109) (Appendixes continue) 761OPTIMAL DECISION MAKING DT!x0,A � � � p�A� DT!x0dA. (A110) To carry out these integrals, we must first rewrite Equations A107–A108 to explicitly display their dependence on A: ER!x0,A � � � 1 �2�sA2 e���A�mA� 2/ 2sA 2 � � 1 1 � e2Az/c 2 � � c2 4Asx (e2Asx /c 2 � e�2Asx /c 2 ) � 1 e2zA/c 2 � e�2zA/c 2 ��dA, (A111) DT!x0,A � � � 1 �2�sA2 e���A�mA� 2/ 2sA 2 � � z A tanh� zAc2� � � 2z A � zc2 2A2sx (e2Asx /c 2 � e�2Asx /c 2 ) e2zA/c 2 � e�2zA/c 2 ��dA. (A112) Defining the parameters â � mA 2/c2, ŝx � sx/mA, ŝA � sA/mA, and ẑ � z/mA, and changing variables to q � A/mA, these expressions become ER!x0,A � � � 1 �2�s̃A2 e���q�1� 2/ 2s̃A 2 � � 1 1 � e2ãz̃q � � 1 4ãs̃xq (e2ãs̃xq � e�2ãs̃xq) � 1 e2ãz̃q � e�2ãz̃q ��dq, and (A113) DT!x0,A � � � 1 �2�s̃A2 e���q�1� 2/ 2s̃A 2 � � z̃ q tanh�ãz̃q� � � 2z̃ q � z̃ 2ãs̃xq 2 (e 2ãs̃xq � e�2ãs̃xq) e2ãz̃q � e � 2ãz̃q ��dq. (A114) Note that these expressions involve only the four combined parameters â, ŝx , ŝA, and ẑ, rather than the five original parameters. That is, analogous to the case for the pure drift diffusion model, only the ratios of the other parameters relative to mA enter. Approximations The integrals of Equations A113–A114 cannot be evaluated explicitly but may be approximated to second order using Laplace’s method (e.g., Bender & Orszag, 1978) to obtain ER!x0,A � ER!x0� â��mA2/c2� � ŝA 2 2 "ER, and (A115) DT!x0,A � DT!x0� â��mA2/c2� � ŝA 2 2 "DT, (A116) where the first terms are, respectively, Equations A107 and A108 evaluated at â � mA 2 /c2 and the correction terms are given by the second derivatives of the terms in square brackets with respect to q, evaluated at q � 1. Explicitly (where we drop the hats on a, z, and sx for clarity of reading): "ER � a 2z2 sech2�az� tanh�az� � � e2a(�sx z)2asx(�1 � e4az)3 ((�1 � e4asx)(�1 � e4az)2 � 8a3sxe 2asx(1 � 6e4az � e8az)z2 � 2a(�1 � e4az)(sx(1 � e 4asx)(�1 � e4az) � (�1 � e4asx)(1 � e4az)z) � 4a2e2a(sx 2z)(�2(sx 2 � 3z2)sinh(2asx) (sx � z) 2 sinh (2a(sx � 2z)) � (sx � z) 2 sinh (2a(sx � 2z))))� , and 762 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN "DT � �2z��tanh�az� � az sech 2�az��1 � az tanh�az��� � e2a��sx z�zasx(�1 � e4az)3 (�3(�1 � e4asx)(�1 � e4az)2 � 8a3sxe2asx(1 � 6e4az � e8az)z2 4a(�1 � e4az)(sx(1 � e 2asx � e4asx)(�1 � e4az) � (�1 � e4asx)(1 � e4az)z) � 4a2ea�sx 4z�(1 � e2asx)(�2(sx 2 � 3z2)sinh(asx) � (sx � z) 2 sinh(a(sx � 4z)) �sx � z� 2 sinh(a(sx � 4z))))�. Note that, as above, the terms in braces vanish in the case where initial conditions are concentrated at the origin, that is, y0 � x0 � 0 (so that sx � ŝx � 0). Figure A2 demonstrates the validity of these approximations for small ŝA. Optimal Values of � for the O-U Model With Variable Drift in Interrogation Protocol In this section, we consider a version of the O-U model in which drift is selected at the beginning of each trial from a normal distribution p(A) with mean mA and standard deviation sA. For simplicity, we assume that the starting point x0 � 0. As shown by Usher and McClelland (2001), according to Equation A87, the solutions of this model at time t have normal distribution with the following mean and variance: ��t� � mA � �e�t � 1�, and �2�t� � c2 2� �e2�t � 1� � sA 2 �2 �e�t � 1�2. Hence, the probability of error at the interrogation time t is equal to ER�t� � �� mA � (e�t � 1) � c22� (e2�t � 1) � sA 2 �2 �e�t � 1�2� , where is the standard cumulative normal distribution function. To find the value of � that minimizes ER(t), we calculate the derivative of ER(t) with respect to � and find the following condition for this derivative to equal zero: e2�t � 2�te�t � 1 � 0. This condition is satisfied when � � 0, so that this corresponds to a critical point in ER(t). Simulations verify that this critical point is indeed a minimum. Lower Bounds on ER Due to Variable Drift In this section, we show that if drift rates are drawn from a Gaussian density p(A) with mean mA � 0 and standard deviation sA, then the ER at any interrogation time or, in the free-response protocol, the ER for any threshold is always greater than or equal to 0.2 0.4 0.6 0.8 1 0.05 0.075 0.125 0.15 0.175 0.2 0.4 0.6 0.8 1 2.2 2.4 2.6 2.8 Figure A2. Error rate (ER) and decision time (DT) for the extended drift diffusion model with parameter values â � 1, ŝx � 1, ẑ � 2. Solid lines are exact values from numerical integration of Equations A113–A114; dotted lines are from second-order approximate formulae derived above. (Appendixes continue) 763OPTIMAL DECISION MAKING ERb � � � 0 p�A�dA for both the extended drift diffusion and O-U models. To see this, first assume as usual that initial conditions x0 are drawn from a uniform density q(x0) within [�sx, sx] and define r(A, x0) to be the ER for fixed values of drift and initial condition for the model at hand. Then, ER � � �sx sx dx0q�x0� � � dAp�A�r�A, x0� � � �sx sx dx0q�x0� � � 0 dAp(A)r(A, x0) � � 0 dAp(A)r(A, x0) . Note that the factors in the integrands are positive and that because mA � 0, p(�A) � p(A) when A � 0. This gives ER � � �sx sx dx0q�x0� � � 0 dAp(A)r(A, x0) � � � 0 dAp(A)r(�A, x0) . Next, we observe that r(A, x0) � 1 � r(�A, �x0) due to the symmetry of the O-U and drift diffusion models with respect to reflection around x � 0 and the definition of r as one minus the fraction of correct responses. This yields ER � � �sx sx dx0q�x0� � � 0 dAp(A)r(A, x0) � � � 0 dAp(A)[1 � r(A, �x0)] � � �sx sx dx0q�x0� � � 0 dAp(A)r(A, x0) � � � 0 dAp(A) � � � 0 dAp(A)r(A, �x0) . Because q(x0) � q(�x0), the first and last terms cancel, and the second term, together with the fact that #�sx sx dx0q(x0) � 1, gives the desired lower bound. 764 BOGACZ, BROWN, MOEHLIS, HOLMES, AND COHEN Appendix B Experimental Method Participants These were 20 adults (9 men and 11 women) recruited via announcements posted around the Princeton University campus. They were predominantly Princeton undergraduate and graduate students (average age: 20 years). Participants were paid one cent for each correct choice. To further increase motivation, partici- pants were informed that the one who earned the most would receive an additional prize of $100, which was awarded at the end of the experiment. The experiment was approved by the Institu- tional Review Panel for Human Subjects of Princeton University, and all participants expressed written consent for participation. Stimuli and Apparatus We used the same stimuli that have been used in other studies of decision making (e.g., Gold & Shadlen, 2003; Palmer, Huk, & Shadlen, 2005). The display was a field of randomly moving dots, all of which appeared within a 5° circular aperture in the center of the screen. Dots were white squares 2 � 2 pixels (0.7° square) displayed against a black background, with a density of 16.7 dots/degree2/s (6 dots per frame). On each trial, a fraction of the dots moved in a single direction over time, corresponding to that trial’s correct direction, while the remaining dots were randomly repositioned over time. On each frame, 11% of the dots were independently selected as the coherently moving dots and were shifted 0.2° from their position for each 40 ms (3 video frames) elapsed, corresponding to a speed of 5°/s (either leftward or rightward). The remaining dots were replotted in random positions on each frame. The display was generated in MATLAB on a Macintosh computer, using the Psychophysics Toolbox extension (Brainard, 1997; Pelli, 1997) and software written by Josh Gold. Procedure Participants were instructed to gain as many points as possible by deciding, for each trial, whether the prevailing motion of the dots was left or right and to indicate their responses by pressing the M key (rightward motion) or the Z key (leftward motion) on a standard keyboard (the mapping of keys to the right and left responses was not counterbalanced across participants). After each correct response, participants were informed by a short beep that the response was correct and that they had scored a point. There was no feedback after incorrect responses. After each response, participants were required to release the key, and there was a delay D before presentation of the next stimulus (D was kept constant within each block but varied across blocks). On some blocks (see below), an additional delay Dp was imposed after error responses. During these delay intervals, the current score was displayed in the center of the screen. Design Trials were blocked by delay condition. This was manipulated to test predictions made by the drift diffusion model (discussed in the section entitled Optimal Thresholds for Different Criteria in the Pure DDM in the main text). There were four delay conditions: (a) D � 0.5 s, (b) D � 1 s, (c) D � 2 s, and (d) D � 0.5 s and Dp � 1.5 s (in the first three conditions, Dp � 0). Each block lasted 7 min (block length was limited by fixing its overall duration rather than by the number of trials completed within it). One block of trials was run for each delay condition, except for Condition 3 (D � 2 s) for which two blocks were run to permit a sufficient number of trials for analysis (because, in this delay condition, trials lasted longer). Hence, in total, the experiment consisted of five blocks of trials randomly ordered across participants. Before the start of the experiment, participants had three blocks of practice in which they did not receive money for correct choices. Participants were informed about the number of blocks and their duration and that blocks differed in delays but were not told the exact durations of delays. Received July 9, 2004 Revision received May 29, 2006 Accepted June 5, 2006 � 765OPTIMAL DECISION MAKING