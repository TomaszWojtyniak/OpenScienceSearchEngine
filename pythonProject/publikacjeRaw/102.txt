Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ doi:10.5194/bg-12-1483-2015 © Author(s) 2015. CC Attribution 3.0 License. Comparison of ten packages that compute ocean carbonate chemistry J. C. Orr1, J.-M. Epitalon2, and J.-P. Gattuso3,4 1LSCE/IPSL, Laboratoire des Sciences du Climat et de l’Environnement, CEA-CNRS-UVSQ, Gif-sur-Yvette, France 2Geoscientific Programming Services, Fanjeaux, France 3CNRS-INSU, Laboratoire d’Océanographie de Villefrance, Villefranche-sur-mer, France 4Sorbonne Universités, UPMC Univ. Paris 06, Observatoire Océanologique, Villefranche-sur-mer, France Correspondence to: J. C. Orr (james.orr@lsce.ipsl.fr) Received: 24 March 2014 – Published in Biogeosciences Discuss.: 4 April 2014 Revised: 24 January 2015 – Accepted: 31 January 2015 – Published: 9 March 2015 Abstract. Marine scientists often use two measured or mod- eled carbonate system variables to compute others. These carbonate chemistry calculations, based on well-known ther- modynamic equilibria, are now available in a dozen pub- lic packages. Ten of those were compared using common input data and the set of equilibrium constants recom- mended for best practices. Current versions of all 10 pack- ages agree within 0.2 µatm for pCO2, 0.0002 units for pH, and 0.1 µmol kg−1 for CO 2− 3 in terms of surface zonal-mean values. That represents more than a 10-fold improvement rel- ative to outdated versions of the same packages. Differences between packages grow with depth for some computed vari- ables but remain small. Discrepancies derive largely from differences in equilibrium constants. Analysis of the sensi- tivity of each computed variable to changes in each con- stant reveals the general dominance of K1 and K2 but also the comparable sensitivity to KB for the AT–CT input pair. Best-practice formulations for K1 and K2 are implemented consistently among packages. Yet with more recent formu- lations designed to cover a wider range of salinity, packages disagree by up to 8 µatm in pCO2, 0.006 units in pH, and 1 µmol kg−1 in CO 2− 3 under typical surface conditions. They use different proposed sets of coefficients for these formula- tions, all of which are inconsistent. Users would do well to use up-to-date versions of packages and the constants recom- mended for best practices. 1 Introduction Our ability to assess ocean carbon uptake and associated im- pacts from ocean acidification relies on an accurate represen- tation of the marine carbonate system. Fortunately, the sea- water carbonate system is well constrained, allowing any two of its variables to be used to calculate all others, given associ- ated temperature T , salinity S, pressure P , and nutrient con- centrations. For example, it is common to measure or sim- ulate two conservative variables, dissolved inorganic carbon CT and total alkalinity AT, and then compute from associ- ated thermodynamics the corresponding pH, partial pressure of carbon dioxide pCO2, concentrations of aqueous CO ∗ 2 as well as carbonate CO 2− 3 and bicarbonate HCO − 3 ions, and the related Revelle factor and saturation states of aragonite �A and calcite �C. It is the CO2-driven changes in these variables that drive the biological impacts from ocean acid- ification (Gattuso and Hansson, 2011; Kroeker et al., 2013; Wittmann and Pörtner, 2013) and degrade most the ocean’s capacity to absorb CO2 (Sarmiento et al., 1995; Orr, 2011). These equilibrium computations are made with numerous software packages, either those developed and used by in- dividual scientists or, more commonly, those that have been made available publicly. The latter have become indispens- able for many ocean scientists, whether they study marine chemistry or impacts of ocean acidification on marine biota. Yet how packages differ is seldom addressed. Lewis and Wal- lace (1998) documented differences in basic variables among three existing packages at a time when no such package Published by Copernicus Publications on behalf of the European Geosciences Union. 1484 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages was publicly available. Provided with the same input, com- puted output from the three packages differed by 21 µatm for pCO2, 0.16 units for pH, and 15 µmolkg −1 for CO 2− 3 as well as HCO − 3 . Packages used different pH scales, different for- mulations for some of the constants (K1, K2, KB, and KS), and different definitions of total alkalinity, all apparently hard-coded. These differences prompted Lewis and Wallace (1998) to develop a publicly available package, CO2SYS, which provides many options to select from the available pH scales and constants while being based primarily on recom- mendations from Dickson and Goyet (1994). Since that time, other packages have also been developed and released pub- licly, yet to this day no study has been published that com- pares their results. One may assume, given continued efforts to establish and refine procedures for best practices (Dick- son and Goyet, 1994; Dickson et al., 2007; Dickson, 2010), that differences among currently available packages are less than what was found 17 years ago. But even that poor level of agreement has not been established. A quantitative un- derstanding of the accuracy and precision of these packages is needed to rigorously compare studies that aim to assess, e.g., air–sea CO2 fluxes and thresholds associated with ocean acidification. Ten publicly available software packages were included in this comparison. The first was CO2SYS, but that now ex- ists in four different variants: the original program written in QBasic and running on DOS (Lewis and Wallace, 1998), two variants as Excel spreadsheets (Pierrot et al., 2006; Pelletier et al., 2007), and most recently a variant as MATLAB scripts (van Heuven et al., 2011). We will refer to these packages as CO2SYS-QBasic, CO2SYS-Excel-Pierrot, CO2SYS-Excel- Pelletier, and CO2SYS-MATLAB. Another package, csys, was also written in MATLAB, but it was released a decade earlier as a supplement to the book by Zeebe and Wolf- Gladrow (2001). The development of csys inspired seacarb, an R library (R Development Core Team, 2012) released 2 years later (Proye and Gattuso, 2003) and frequently im- proved with new revisions (Gattuso et al., 2015). About the same time as the release of the two Excel variants of CO2SYS, the swco2 package was also released with a simi- lar spreadsheet interface but a distinct library of core routines written in Visual Basic (Hunter, 2007). Three years later, oceanographers saw the release of two new carbonate chem- istry packages, CO2calc and ODV, both of which also exploit the core CO2SYS code. While CO2calc provided a new tool for Mac, PC, and iOS (Robbins et al., 2010), ODV provided carbonate chemistry calculations as an add-on to an already widely used visualization and analysis tool (Schlitzer, 2002). Parallel to those developments for the observational and ex- perimental communities, the Ocean Carbon-Cycle Model In- tercomparison Project (OCMIP) provided routines to com- pute surface pCO2 and air–sea CO2 fluxes from simulated AT and CT (Orr et al., 1999). Those were adapted to in- clude the full suite of other carbonate system variables (Orr et al., 2005), then later improved and released publicly as the mocsy package (Orr and Epitalon, 2015). To assess the con- sistency of these packages, we compared results generated by running them with common sets of constants, pH scales, and input data. Two other public packages, AquaEnv (Hofmann et al., 2010) and SolveSAPHE (Munhoven, 2013), were not in- cluded in this comparison. AquaEnv is particularly suited to aquatic chemical model generation in freshwater and estuar- ies; however, we found it to be designed for high-end users, e.g., finding no examples to quickly convert all of its results from its default free hydrogen ion scale to the total hydrogen ion scale, as recommend for best practices. SolveSAPHE de- fines the state of the art for the algorithm used to solve the pH-alkalinity equation because of its greater efficiency and stability. It always converges even under extreme conditions. Its solver routines have already been adopted by one of the packages (mocsy 2.0), but SolveSAPHE itself does not pro- vide an adequate user interface for simple use, as needed for this comparison. We limit this study to package comparison. For brevity, we avoid redocumenting the associated approaches and al- gorithms, which are now commonly used and for which abundant literature already exists (e.g., Dickson et al., 2007; Munhoven, 2013). Likewise, we do not address the debate raised by Hoppe et al. (2012) concerning poor agreement be- tween measured pCO2 and that computed from AT and CT, a disaccord found to be worse than in previous studies by marine chemists (e.g., Lueker et al., 2000). Nonetheless, we go beyond simply identifying differences between packages; we also seek to identify their causes. Our goal was to inspire subsequent package developments while facilitating evalua- tion and tightening agreement. Once packages are shown to provide essentially the same results, they can be legitimately chosen based on convenience, efficiency, functionality, and a user’s programming experience. Some users may well prefer spreadsheet-based programs (CO2SYS-Excel-Pierrot, CO2SYS-Excel-Pelletier, CO2calc, and swco2). Others who use ODV for general oceanographic data analysis and visu- alization can easily compute carbonate system variables us- ing its predefined derived-variable facility. Users with some programming experience may prefer packages that are avail- able in languages that they are already familiar with. They can choose from CO2SYS-MATLAB and csys in MATLAB, seacarb in R, swco2 in Visual Basic, and mocsy in Fortran. Python programmers can use either mocsy or seacarb. 2 Methods To compare all publicly available packages, our approach was to install them in one location, define common input data and constants, and use those with each package to generate a data archive for centralized analysis. Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1485 Table 1. Carbonate system software packages. Package Language Version Reference CO2SYSa QBasic 1.05 Lewis and Wallace (1998) CO2SYSb Excel 24 Pelletier et al. (2007) CO2SYSa Excel 2.1 Pierrot et al. (2006) CO2SYSa MATLAB 1.1 van Heuven et al. (2011) CO2calcc Visual Basic 1.3.0 Robbins et al. (2010) csysd MATLAB 04–2014 Zeebe and Wolf-Gladrow (2001) ODVe C++ 4.5.0 Schlitzer (2002) mocsyf Fortran 95 2.0 Orr and Epitalon (2015) seacarbg R 3.0.6 Gattuso et al. (2015) swco2h Excel 2 Hunter (2007); Mosley et al. (2010) swco2h Visual Basic 2 Hunter (2007) a http://cdiac.ornl.gov/oceans/co2rprt.html b http://www.ecy.wa.gov/programs/eap/models.html c http://pubs.usgs.gov/of/2010/1280/ d http://www.soest.hawaii.edu e http://odv.awi.de/ f http://ocmip5.ipsl.jussieu.fr/mocsy g http://cran.r-project.org/package=seacarb h http://neon.otago.ac.nz/research/mfc/people/keith_hunter/software/swco2/ 2.1 Packages and reference All publicly available software packages (Table 1) take two ocean carbonate system variables as input and compute the others from basic thermodynamics. All 10 packages were first downloaded in November 2012. Our earliest findings led developers to update two packages (CO2calc and seacarb). Another three packages (csys, mocsy, and CO2SYS-Excel- Pelletier) were updated following publication of our discus- sion paper (Orr et al., 2014). Different results from some older versions of these packages are briefly shown in one figure to illustrate the discrepancies associated with running software that is out of date. The remaining comparison refers only to the latest version of each package. To compare packages, it was necessary to define a com- mon reference. Although check values exist for most of the equilibrium constants (Dickson et al., 2007), none are avail- able for computed variables. Hence we chose CO2SYS as a relative reference for three reasons: (1) it was the first pub- licly available package; (2) its core routines already serve as the base code for two other packages (CO2calc and ODV); and (3) its documentation and code reveal the intense effort that its developers have put into ferreting out the right coeffi- cients from the literature and the most appropriate version of formulations for the constants. Our choice of the reference had to be refined, how- ever, because, as mentioned, CO2SYS comes in four vari- ants: the original in QBasic running on DOS (Lewis and Wallace, 1998), two others that run with Excel (Pelletier et al., 2007; Pierrot et al., 2006), and finally MATLAB code (van Heuven et al., 2011). The original variant is still used by some, but it does not provide options to use formulations for K1 and K2 from Lueker et al. (2000), as recommended for best practices (Dickson et al., 2007). Thus, we reduced our choices for the reference to the other three variants of Table 2. Computational time required to process the GLODAP- WOA2009 gridded data producta. Package Total time Run time Write time swco2 (Excel) 897.1 CO2calc 91.2 ODV 73.3 seacarb (R)b 58.3 swco2 (Visual Basic) 28.0 csys (MATLAB)c 7.7 CO2SYS (Excel-Pelletier)d 7.2 CO2SYS (MATLAB)c 5.9 5.5 0.4 mocsy (Fortran 95) 0.5 0.2 0.3 a Time required in minutes to treat 958 557 ocean grid points. b Time does not include calculation of the Revelle factor. c Time for code run under octave; it may run faster under MATLAB. d CO2SYS-Excel-Pelletier run on a 2.2 GHz Intel Core 2 duo T7500 under Windows 7 and Excel 2007. e All other packages run on a 2.0 GHz Intel Pentium dual-core T4200 under Linux or Windows Vista. CO2SYS (MATLAB and both Excel variants), all of which provide options to use all constants recommended for best practices (with one minor exception). All three versions give nearly identical results (Fig. 1). But they differ significantly from the original version run with the closest substitutes for Lueker et al.’s K1 and K2, namely the previous refits by Dickson and Millero (1987) of the same measured constants from Mehrbach et al. (1973) (DM87). With that older set of K1 and K2, however, the original version produces results that match those from the Excel-Pierrot version when also run with DM87. Another requirement was efficiency, since one aspect of our comparison required use of a global-scale input data set with nearly 1 million records (Table 2). Thus we further narrowed our choice of the reference to the most efficient variants, CO2SYS-MATLAB and CO2SYS-Excel- Pelletier. Finally, we chose CO2SYS-MATLAB as the refer- ence because it was the most efficient and because its source code was easiest for us to inspect, modify, and rerun for sen- sitivity tests. This arbitrary choice of the relative reference was necessary for our comparison, but it does not imply that the chosen reference is necessarily error free. 2.2 Features The 10 packages compute results from the same thermody- namic equilibria, but software features differ, including avail- able input pairs, pH scales, and constants. Package diversity covers all commonly used operating systems: all packages run on Windows, eight packages on Mac OSX, and five pack- ages on Linux and Unix (Table 3). Source code is available in seven packages in standard programming languages (QBa- sic, Visual Basic, MATLAB, R, Fortran 95), thereby allow- ing code validation and improvements by users on all three operating systems mentioned above. The number of possible input pairs of carbonate system variables varies widely be- tween packages, from 1 to 20 (Table 4). The mocsy package www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 http://cdiac.ornl.gov/oceans/co2rprt.html http://www.ecy.wa.gov/programs/eap/models.html http://pubs.usgs.gov/of/2010/1280/ http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/CO2_System_in_Seawater/csys.html http://odv.awi.de/ http://ocmip5.ipsl.jussieu.fr/mocsy http://cran.r-project.org/package=seacarb http://neon.otago.ac.nz/research/mfc/people/keith_hunter/software/swco2/ 1486 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Temperature (°C) ∆ p C O 2 (µ a tm ) 0 10 20 30 40 50 − 2 5 − 1 5 − 5 0 Matlab (BP) Excel Pierrot (DM87) Excel Pierrot (BP) Excel Pelletier (BP) QBasic (DM87) Salinity (practical scale) 0 10 20 30 40 50 − 1 .0 − 0 .5 0 .0 0 .5 Matlab (BP) Excel Pierrot (DM87) Excel Pierrot (BP) Excel Pelletier (BP) QBasic (DM87) Pressure (db) 0 2000 4000 6000 8000 0 .0 0 .2 0 .4 0 .6 0 .8 Matlab (BP) Excel Pierrot (DM87) Excel Pierrot (BP) Excel Pelletier (BP) QBasic (DM87) ∆ C O 32 − (µ m o l k g −1 ) 0 10 20 30 40 50 − 2 .0 − 1 .0 0 .0 Matlab (BP) Excel Pierrot (DM87) Excel Pierrot (BP) Excel Pelletier (BP) QBasic (DM87) 0 10 20 30 40 50 − 0 .1 0 .0 0 .1 0 .2 0 .3 0 2000 4000 6000 8000 0 .0 0 0 .1 0 0 .2 0 0 .3 0 Matlab (BP) Excel Pierrot (DM87) Excel Pierrot (BP) Excel Pelletier (BP) QBasic (DM87) ∆ p H ( to ta l s ca le ) 0 10 20 30 40 50− 0 .0 0 2 0 .0 0 2 0 .0 0 6 0 .0 1 0 Matlab (BP) Excel Pierrot (DM87) Excel Pierrot (BP) Excel Pelletier (BP) QBasic (DM87) 0 10 20 30 40 50 − 0 .0 0 2 0 .0 0 0 0 .0 0 2 0 2000 4000 6000 8000 − 0 .0 0 1 5 − 0 .0 0 0 5 Matlab (BP) Excel Pierrot (DM87) Excel Pierrot (BP) Excel Pelletier (BP) QBasic (DM87) Figure 1. Differences (1) between the variants of CO2SYS relative to the reference MATLAB code for variables computed from AT and CT. Differences are shown across ranges of T (left), S (center), and P (right) for pCO2 (top), CO 2− 3 (middle), and pH (bottom). The three most recent variants (MATLAB and both Excel versions) are run with constants recommended for best practices (BP). The QBasic variant does not offer the same K1 and K2, so we used an earlier refit by Dickson and Millero (1987) of the same data (DM87) and compared it to one Excel version also with DM87. treats only one input pair: AT–CT, the two carbonate sys- tem variables carried by models. The four CO2SYS variants and its two derivatives (CO2calc and ODV) allow the user to select from six commonly measured pairs (AT–CT, AT–pH, AT–pCO2, CT–pCO2, CT–pH, and pH–pCO2); in addition, they allow equivalent pairs where fCO2 replaces pCO2. The csys package provides 10 more input pairs by allowing pair members to include one or more of the three inorganic carbon species CO∗ 2 , HCO − 3 , and CO 2− 3 . Although the two former species can only be calculated, promising new techniques are being developed to measure the latter (Byrne and Yao, 2008; Martz et al., 2009; Easley et al., 2013). Yet despite csys’s enhanced number of input pairs, it limits pCO2 to be used as input only when combined with pH. The two remaining packages, seacarb and swco2, include the same 16 pairs as csys but also add four others, all including pCO2. Computed variables are affected by the choice of the pH scale and the constants. All packages allow users to work on the total pH scale as recommended for best practices (Ta- ble 5) and as used for this comparison. The mocsy package provides only the total scale, while the others allow for con- version to the free scale. The others also allow users to work on the seawater scale except for csys. The 4 CO2SYS vari- ants as well as CO2calc and swco2 also offer the NBS scale. The choice of the pH scale affects the values of the constants for which H+ is part of the equilibrium equation. ForK1 and K2, the CO2SYS variants and derivatives offer a large range of choices (Table 6). Yet most of those may now be consid- ered out of date, having been replaced by more recent assess- ments, sometimes with some of the same data. All packages except CO2SYS-QBasic offer the K1 and K2 formulations from Lueker et al. (2000), as recommended for best prac- tices. Six packages also offer the most recent formulations for K1 and K2 that have been proposed as more appropriate for low-salinity waters (Millero, 2010). The formulations for K1 and K2 from the two latter studies are used individually in this comparison to assess associated differences between packages. For the other constants, all packages provide the formulations recommended for best practices, except forKF, a difference shown later to have no consequence. Some packages also offer additional features. For exam- ple, CO2SYS variants and CO2calc allow users to compute variables at a temperature that differs from the in situ value. Some also distinguish different components of total alkalin- ity, including those from total B, P, and Si. The seacarb pack- age provides explicit functions to the user to allow conver- Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1487 Table 3. Operating system and code details for each package. CO2SYS OS & details Q B a si c E x c e la M a tl a b C O 2 c a lc O D V c sy s se a c a rb sw c o 2 m o c sy Linux/Unix • • • • • Windows • • • • • • • • • Mac OS • • • • • • • iOS • Public source code • • • • • • User programmable • • • •c • Software platform Ed Mb Mb Rf, h Ee F g, h a Both variants: CO2SYS-Excel-Pierrot and CO2SYS-Excel-Pelletier. b Package runs under MATLAB (commercial software) or octave (free software). c Spreadsheet interface is not code; core library is callable (Visual Basic) but not modifiable. d Package runs under Excel. e Package runs under Excel (commercial) or LibreOffice (free and open source). f Package runs under R. g Fortran 95 code. h Also runs under Python. Table 4. Available input pairs for each package. CO2SYSb Pair QBasic Excela Matlab CO2calcb ODVb csys seacarbc swco2c mocsy AT–CT • • • • • • • • • AT–pCO2 • • • • • • • AT–pH • • • • • • • • AT–CO 2− 3 • • • AT–CO b 2 • • • AT–HCO − 3 • • • CT–pCO2 • • • • • • • CT–pH • • • • • • • • CT–CO 2− 3 • • • CT–CO b 2 • • • CT–HCO − 3 • • • pCO2–pH • • • • • • • • pCO2–CO 2− 3 • • pCO2–HCO − 3 • • pH–CO 2− 3 • • • pH–COb 2 • • • pH–HCO − 3 • • • CO 2− 3 –COb 2 • • • CO 2− 3 –HCO − 3 • • • COb 2 –HCO − 3 • • • a Both variants: CO2SYS-Excel-Pierrot and CO2SYS-Excel-Pelletier. b CO2SYS, CO2calc, and ODV also allow input pairs containing fCO2 instead of pCO2. c seacarb and swco2 include user-callable functions to convert between pCO2 and fCO2. sion of pH and constants between the free, total, and seawa- ter scales; other packages make such conversions internally but do not provide user-callable functions. The seacarb pack- age also offers functions to help design perturbation exper- iments to investigate effects of ocean acidification (Gattuso and Lavigne, 2009). Two packages, mocsy and seacarb, al- low users to account for pressure effects on subsurface fCO2 and pCO2 following Weiss (1974); other packages neglect these pressure effects. www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1488 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Table 5. Available pH scales for each package. CO2SYS pH scale Q B a si c E x c e la M a tl a b C O 2 c a lc O D V c sy s se a c a rb c sw c o 2 c m o c sy NBS • • • • • Free • • • • • • • • Total • • • • • • • • • Seawater • • • • • • • Convert pH between scales • • • Convert Ks between scales • • a Both variants: CO2SYS-Excel-Pierrot and CO2SYS-Excel-Pelletier. b All packages convert pH and Ks between scales, internally. c Some packages have user-callable routines to make these conversions between scales. Table 6. Available constants for each package. CO2SYS Constant Q B a si c E x c e la M a tl a b C O 2 c a lc O D V c sy s se a c a rb sw c o 2 m o c sy K1 and K2 (Lueker et al., 2000) • • • • • • • • (Roy et al., 1993) • • • • • • • • (Goyet and Poisson, 1989) • • • • • (Hansson, 1973a, b) b • • • • • (Mehrbach et al., 1973)b • • • • (Millero, 1979) • • • • • (Mojica Prieto and Millero, 2002) • • • (Cai and Wang, 1998) • • (Millero et al., 2006) • • • • • (Millero, 2010) • • • • • K0 (Weiss, 1974) • • • • • • • • • KB (Dickson, 1990b) • • • • • • • • • KF (Perez and Fraga, 1987) • • KF (Dickson and Riley, 1979) • • • • • • • • • KW (Millero, 1995) • • • • • • • • • KS (Dickson, 1990a) • • • • • • • • • KS (Khoo et al., 1977) • • • • • K1P, K2P, K3P (Millero, 1995) • • • • • • • • • KSi (Millero, 1995) • • • • • • • • KA (Mucci, 1983) • • • • • • • • KC (Mucci, 1983) • • • • • • • • a Both variants: CO2SYS-Excel-Pierrot and CO2SYS-Excel-Pelletier. b Refit by Dickson and Millero (1987). 2.3 Input data To compare packages, we used two different kinds of in- put data. A first analysis compared variables computed in each package as a function of latitude and depth using as input the three-dimensional gridded data products for AT and CT from the Global Ocean Data Analysis Project (GLO- DAP; Key et al., 2004) combined with comparable products from the 2009 World Ocean Atlas (WOA2009) for T (Lo- carnini et al., 2010), S (Antonov et al., 2010), and concen- trations of total dissolved inorganic phosphorus PT and to- tal dissolved inorganic silicon SiT (Garcia et al., 2010). We will refer to this combined gridded input data as GLODAP- WOA2009. A second analysis focused on comparing pack- Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1489 ages while separating the effects of physical input variables (T , S, and P ) on computed variables. For that, we started with five commonly used input pairs: AT–CT, AT–pH, AT– pCO2, CT–pCO2, and CT–pH. Then for each pair, we com- puted the other carbonate system variables over ranges of T , S, and P , assuming zero nutrient concentrations. More pre- cisely, all other carbonate system variables were first calcu- lated with one package (seacarb) fromAT = 2300 µmolkg −1 and pCO2 = 400µatm at global average surface conditions (T = 18 ◦C, S = 35, and P = 0db). Then two surface data sets were produced for each pair (and each package) by vary- ing T and S, individually, and recalculating all other carbon- ate system variables from the fixed input pair. For the first, T was varied from−2 to 50 ◦C, while for the second S was var- ied from 0 to 50. In both cases, pressure was held at 0 db. To assess how packages differ below the surface, we used the same approach, varying pressure between 0 and 10 000 db and maintaining S = 35. But pressure corrections are highly sensitive to temperature (Sect. 2.7), so for each package we made two data sets: (1) holding T = 2 ◦C (typical of the deep open ocean) and (2) holding T = 13 ◦C (typical of deep wa- ters of the Mediterranean Sea). 2.4 Best-practices comparison Comparisons were made using the total pH scale and con- stants recommended for best practices by Dickson et al. (2007). The equilibrium constant for the solubility of CO2 in seawater K0 is from Weiss (1974). The equilibrium con- stants K1 and K2 are from Lueker et al. (2000), who refit the constants determined by Mehrbach et al. (1973) to the total pH scale. The formulation for KB is from Dickson (1990b) and is also on the total pH scale. Formulations for KW, K1P, K2P, K3P, and KSi are from Millero (1995), who provides equations for the seawater scale, and those are converted to the total scale. The formulation for KS is from Dickson (1990b) on the free scale (see above). The solubility prod- ucts for aragonite KA and for calcite KC are from Mucci (1983). All these are equilibrium constants given in terms of concentrations, not activities. The only constant for which the formulation was not that recommended by Dickson et al. (2007) is KF, because that best-practices formulation (Perez and Fraga, 1987) is not offered by most CO2SYS variants, CO2calc, nor ODV. Instead, we used the KF formulation by Dickson and Riley (1979) on the total scale, which is offered by all packages and recommended by Dickson and Goyet (1994). Dickson et al. (2007) state that results from the two formulations are in reasonable agreement. Additionally, all packages used consistent formulations for total concentrations of boron (Uppström, 1974), sulfur (Mor- ris and Riley, 1966), fluoride (Riley, 1965), and Ca2+ (Ri- ley and Tongudai, 1967), each proportional to salinity. Nine packages compute saturation states for aragonite�A and cal- cite �C from the product of the concentrations of Ca 2+ and CO 2− 3 divided by the corresponding solubility product, either for aragonite KA or calcite KC (Mucci, 1983), respectively. Only the csys package does not provide output for �A and �C. To simplify comparison, most figures plot results as ab- solute differences: computed values are shown after subtract- ing off corresponding results from the reference. 2.5 Sensitivity tests The most extensive comparison was made with AT–CT as input, the only pair that is available in all packages. With that pair, packages were also compared in terms of how their computed variables were affected by nutrient concentrations, i.e., by varying PT and SiT across their observed ranges in the ocean. Additionally, the same pair was used to quantify effects of two important developments since the best prac- tices were published in 2007. For the first, we quantified ef- fects on computed variables of Lee’s (2010) assessment that the total boron concentration in the ocean may be 4 % larger than considered previously (Uppström, 1974). For the sec- ond, we assessed impacts of using Millero’s (2010) new K1 and K2 formulations, which are designed to cover a wider range of input S and T relative to the intended range for rec- ommended constants (Lueker et al., 2000). 2.6 Constants To better assess the most likely causes of differences in com- puted carbonate system variables, we also compared associ- ated constants. For the four packages where source code was available and easily modified (CO2SYS-MATLAB, csys, seacarb, mocsy), we used existing routines or slightly modi- fied versions to output all the constants for the same physical input data (T , S, and P ) that we used for computing vari- ables. For CO2SYS-Excel-Pelletier, the constants are also available. For swco2, we retrieved its constants using its doc- umented parameter numbers and its routine to extract any- thing with a parameter number. For packages where source code was not available, we computed constants from out- put variables when possible. With output from CO2calc and CO2SYS-Excel-Pierrot, we computed its K0, K1, K2, KB, KW, KA, and KC; from ODV output, we computed its K0, K1, K2, KA, and KC. 2.7 Pressure corrections Until recently, no public package accounted for pressure ef- fects on K0 (needed to convert CO ∗ 2 to fCO2) and the cor- responding fugacity coefficient Cf (needed to convert fCO2 to pCO2) as originally proposed (Weiss, 1974, Eqs. 5 and 9). Instead, the total pressure term in those equations was simply assigned to be that of the atmosphere only (1 atm). Hence, their computed subsurface fCO2 and pCO2 may be consid- ered as being referenced to the surface. These pressure ef- fects are accounted for, however, in the latest versions of two packages, mocsy 2.0 and seacarb 3.0.6. Both allow users to compute fCO2 and pCO2 in three ways: (1) the same “com- www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1490 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages mon” approach that computes K0 and Cf with total pressure of 1 atm and in situ T , (2) the “potential” approach that like- wise uses atmospheric pressure only but also uses potential temperature θ instead of in situ T , and (3) the “in situ” ap- proach that uses the true total pressure (atmospheric + hy- drostatic) and in situ T . Other packages offer only the first approach. For the other equilibrium constants, all packages make pressure corrections following the approach of Millero (1995). That is, the effect of P on each equilibrium constant Ki is given by the equation ln ( K P i /K 0 i ) =−(1Vi/RTk)P + (0.51κi/RTk)P 2 , (1) where the left-hand side contains the ratio between Ki at depth (P in bars) and at the surface (P at 0 bars), R is the gas constant, Tk is temperature in K, 1Vi is the partial molal volume, and 1κi is the change in compressibility. The latter two variables differ for each constant and were fitted empiri- cally by Millero (1995) to be quadratic in temperature: 1Vi = a0+ a1Tc+ a2T 2 c , (2) 1κi = b0+ b1Tc+ b2T 2 c , (3) where Tc is temperature in ◦C. Some of these original coef- ficients (Millero, 1995, Table 9) contained typographical er- rors as identified in the code and documentation of CO2SYS- QBasic (Lewis and Wallace, 1998, Appendix). Nonetheless, these errors have persisted in some of the packages as well as in the literature (e.g., Millero, 2007). To help amend this situ- ation, Table 7 lists these coefficients for each constant where known errors have been corrected. To determine the fidelity of packages to this array of coefficients, we studied available source code and evaluated patterns of discrepancies in results by carrying out sensitivity tests to decipher fingerprints char- acteristic of previous errors. Although the same approach is used by all packages to make pressure adjustments (Eqs. 2 and 3), it is based on ex- tremely limited data. Thus it may not be particularly accu- rate. For example for K1 and K2, there are differences of 3 and 8% between adjusted values from Millero (1983) and data from Culberson and Pytkowicz (1968) for deep water at 2◦C at 10000 dbar. Although improving the accuracy of the pressure adjustments to equilibrium constants should be a high priority for future research, our aim here is to assess package precision. 2.8 What is significant? If software packages with identical input cannot agree to within much less than the measurement precision of a com- puted variable (e.g., pCO2), then their varied use would add substantially to the total uncertainty. To avoid this situation, it is necessary for these tools to have a numerical precision that is far superior to the measurement precision. By numeri- cal precision, we mean their agreement, including all coding differences and errors as well as the usually much smaller nu- merical round-off error. Therefore, we arbitrarily define the cutoff level for numerical precision to be 10 times smaller than the best measurement uncertainty (Dickson, 2010, Ta- ble 1.5). A package that agrees with a given variable from the reference package within the numerical cutoff specified in Table 8 will be referred to here as having a negligible dis- crepancy relative to the reference; conversely, a package with a greater difference for a given variable will be considered to have a significant discrepancy. 3 Results Because the CO2SYS variants agree so closely (Fig. 1), sub- sequent comparison usually shows results only for CO2SYS- MATLAB (our reference). Packages were compared in terms of how computed variables differed with latitude and depth (using global gridded data) and how individual physical vari- ables and chemical choices affected results (using simplified data). Packages were also compared in terms of computa- tional efficiency. 3.1 Global gridded data In this section, all variables are computed from the GLODAP-WOA2009 gridded input data. With those data, we first compare two new approaches to the common ap- proach of computing subsurface fCO2 and pCO2, in two packages. Then we expand comparison to all packages and other variables. The mocsy and seacarb packages offer the three ap- proaches to compute fCO2 and pCO2 (Sect. 2.7). Both packages agree within 0.008% (0.03 µatm at the surface) for each approach for each of the two variables (Tables 9 and 10). While the two packages always compare well through- out the water column, the three approaches diverge as depth increases, as detailed in our companion paper for one pack- age (Orr and Epitalon, 2015, Figs. 1 and 3). Differences be- tween common and potential pCO2 reach 7 µatm at 5000 m, while differences between potential and in situ pCO2 are much larger. The latter is 5% greater than the former at 100 m but 18 times larger at 5000 m. Differences between potential and in situ fCO2 are smaller because they involve pressure corrections only to K0 and not Cf . Yet they still differ by more than a factor of 2 at 5000 m. Subsequent comparison of pCO2 shows just the common approach, the only one offered by all packages. More generally, surface zonal means from all packages agree within 0.2 µatm for pCO2, 0.006 µmol kg −1 for CO∗ 2 , 0.0002 units for pH, 0.1 µmol kg−1 for CO 2− 3 , 0.004 for �A, and 0.1 for the Revelle factor (Fig. 2). Packages diverge as pressure increases, but agreement generally remain within a factor of 2 of that seen at the surface (Fig. 3). There are two exceptions: the disagreement in pH is 5 times larger Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1491 Table 7. Coefficients used in Eqs. (2) and (3) to correct for effect of pressure on equilibrium constants. K a0 a1 a2 b0 b1 b2 K1 −25.50 0.1271 0 −0.00308 −0.877×10 −4 0 K2 −15.82 −0.0219 0 0.00113 −1.475×10 −4 0 KB −29.48 0.1622 −0.002608 −0.00284 0 0 KW −20.02 0.1119 −0.001409 −0.00513 −0.794×10 −4 0 KS −18.03 0.0466 −0.000316 −0.00453 −0.900×10 −4 0 KF −9.78 −0.0090 −0.000942 −0.00391 −0.540×10 −4 0 KC −48.76 0.5304 0 −0.01176 −3.692×10 −4 0 KA −45.96 0.5304 0 −0.01176 −3.692×10 −4 0 K1P −14.51 0.1211 −0.000321 −0.00267 −0.427×10 −4 0 K2P −23.12 0.1758 −0.002647 −0.00515 −0.900×10 −4 0 K3P −26.57 0.2020 −0.003042 −0.00408 −0.714×10 −4 0 KHS −14.80 0.0020 −0.000400 0.00289 −0.540×10 −4 0 KNH4 −26.43 0.0889 −0.000905 −0.00503 −0.814×10 −4 0 KSi −29.48 0.1622 −0.002608 −0.00284 0 0 KHS and KNH4 are the constants for dissociation of hydrogen sulfide and ammonium (Millero, 1995); other constants are defined in the text. Table 8. Desired measurement and numerical uncertainties. Uncertainties Variable Measurement Numerical Units AT 1 0.1 µmolkg −1 CT 1 0.1 µmolkg −1 pCO2 1 0.1 µatm CO 2− 3 1 0.1 µmolkg−1 pH 0.003 0.0003 pK0 0.002 0.0002 pK1 0.01 0.001 pK2 0.02 0.002 pKi (other) 0.01 0.001 at 5000 m, where csys is 0.001 larger than other packages, which agree within 0.0003; for the Revelle factor Rf , pack- ages agree within 0.02 throughout the water column except for seacarb, whose discrepancy grows to 0.2 at 5000 m. Al- though seacarb computes Rf with an efficient analytical for- mula (Frankignoulle, 1994), that approach neglects effects of PT and SiT on total alkalinity, unlike the less efficient nu- merical approach used in other packages (Orr and Epitalon, 2015). Overall, discrepancies among packages are larger at depth, but they remain negligible (Table 8) except for pH and pCO2. Yet agreement was not always so close. For some per- spective, the same CO2SYS-MATLAB reference was also compared to older versions of four packages: CO2calc (ver- sion 1.0.4 revised on 18 June 2013), csys (version revised on 3 February 2010), seacarb (version 2.3.3 revised on 2 April 2010), and an early predecessor of mocsy developed by Orr et al. (2005) but not released publicly. Discrepan- cies relative to the same reference were once larger, e.g., more than 10 times as much for pCO2, pH, and CO 2− 3 (Fig. 4). With the mocsy precursor, there are significant dis- crepancies in pCO2 reaching up to 1.5 µatm at the surface. Those grow with depth, e.g., reaching 4 µatm at 5000 m. At the same depth, there are discrepancies in CO 2− 3 reaching 0.5 µmol kg−1 and in pH up to 0.007. Subsurface discrepan- cies are mainly due to two common modeling approxima- tions that were corrected in the first public release of mocsy (Orr and Epitalon, 2014). With CO2calc v1.0.4, surface dis- crepancies reach up to 2 µatm in pCO2, up to 1.3 µmol kg −1 in CO 2− 3 , and up to 0.007 in pH. Those discrepancies are associated with coding errors in the K1 and K2 formula- tions from Lueker et al. (2000), errors that were corrected in CO2calc version 1.2.0. With the previous version of csys, surface pCO2 is about 1 µatm lower than the reference be- cause that variable was mislabeled; it was actually fCO2. As for seacarb v2.3.3, there are no significant discrepancies. However, with an even earlier version of seacarb (v2.0.3 re- leased in 2008, not shown), the only package that maintains public access to all previous versions, discrepancies at depth are much larger (e.g., −7 µmol kg−1 in CO 2− 3 and −0.165 in pH at 4000 m). Because earlier versions of packages often have much larger discrepancies, users would be wise to keep their carbonate system software up to date. Previous analysis has illustrated how discrepancies vary spatially across the global ocean, but the realistic gridded in- put data sets that were exploited did not allow us to isolate how discrepancies vary with individual physical variables and chemical input options. We will now focus on those fac- tors, individually, by exploiting simple artificial input data. www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1492 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Figure 2. Global zonal-mean surface values for variables computed from gridded data products for AT and CT from GLODAP (Key et al., 2004) combined with T , S, and nutrients from the 2009 World Ocean Atlas (WOA2009) (Locarnini et al., 2010; Antonov et al., 2010; Garcia et al., 2010). Curves are shown for each package and variable after subtracting off corresponding results for the CO2SYS-MATLAB reference. The csys package does not provide results for �A and the Revelle factor. It also neglects nutrient alkalinity, but its curves were adjusted to include the effects of PT and SiT as computed by mocsy. Figure 3. Global-mean vertical profiles of variables computed from the same gridded data products as in Fig. 2. For each software package, corresponding results from the reference (CO2SYS-MATLAB) have been subtracted. The csys curves are adjusted as in Fig. 2. In all comparisons, the csys results are computed with the option ocdflag= 1; its discrepancies would be larger with ocdflag= 0. Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1493 Table 9. Oceanic fCO2 a from three approachesb in two packages. Common Potential In situ Depth (m) mocsy seacarb mocsy seacarb mocsy seacarb 0 331.99 331.97 331.99 331.97 331.99 331.97 10 332.17 332.15 332.16 332.13 332.62 332.59 50 348.50 348.48 348.42 348.40 350.85 350.83 100 399.82 399.79 399.65 399.62 405.28 405.25 500 628.72 628.68 627.67 627.62 674.20 674.15 1000 671.15 671.10 669.24 669.19 773.06 773.01 2000 551.12 551.08 548.18 548.14 733.22 733.17 5000 438.05 438.02 430.74 430.71 900.90 900.83 a Area-weighted global means computed from the GLODAP-WOA2009 gridded data set. b Following Weiss (1974), fCO2 = [ CO∗ 2 ] / ( K0 exp [ (1−P)v̄CO2 /RT ]) , The exponential term vanishes when P is set to 1 atm (common and potential approaches) but is intended to represent total pressure (in situ approach). The potential approach uses θ in place of in situ T (common and in situ approaches) in the above equation and in the calculation of K0. Table 10. Oceanic pCO2 a from three approachesb in two packages. Common Potential In situ Depth (m) mocsy seacarb mocsy seacarb mocsy seacarb 0 333.15 333.12 333.15 333.12 333.1 333.1 10 333.33 333.30 333.31 333.28 334.9 334.9 50 349.73 349.70 349.65 349.62 358.3 358.3 100 401.27 401.24 401.09 401.06 421.6 421.6 500 631.24 631.20 630.19 630.14 826.0 825.9 1000 673.95 673.90 672.03 671.98 1175.3 1175.2 2000 553.48 553.44 550.53 550.49 1729.7 1729.6 5000 439.95 439.92 432.62 432.58 7976.1 7975.6 a Area-weighted global means from same gridded input data as in Table 9. b Following Weiss (1974), pCO2 = fCO2/Cf, where Cf = exp [( B + 2x2 2 δ12 ) P/RT ] and P is the total pressure (atmospheric + hydrostatic) as adopted for the in situ approach; the other two approaches assume that P is only atmospheric pressure. The potential approach also uses θ in place of in situ T . 3.2 Physical factors Packages were compared with five common input pairs with the same simple data sets where T , S, and P were var- ied individually. All packages were compared with the AT– CT pair. Comparison with the four other pairs excluded the mocsy package, which is designed to use only AT–CT. Com- parison with two of the pairs, AT–pCO2 and CT–pCO2, ex- cluded the csys package, which does offer pCO2 as an input variable but only when paired with pH. 3.2.1 AT–CT With the AT–CT pair, packages agree within 0.2 µatm in pCO2, 0.05 µmolkg −1 in CO 2− 3 , and 0.0004 in pH across the observed ranges of ocean T and S at surface pressure (Fig. 5). Surface discrepancies are significant only for one variable from one package, pCO2 from ODV, but those re- main quite small (less than twice our arbitrary numerical cut- off of 0.1 µatm). Away from the surface, in the open ocean with its cold deep waters at around 2 ◦C, pressure corrections in all packages do not add significantly to the discrepancies seen at the surface. Yet some deep waters can be warmer, for instance around 13 ◦C in the Mediterranean Sea. At that temperature, inconsistencies would be more apparent if they were due to errors in coefficients of pressure corrections, which are quadratic functions of temperature (Eqs. 2 and 3). One package, swco2, does indeed exhibit substantial discrep- ancies with deep water at 13◦C but only negligible discrep- ancies at 2◦C. At 5000 db, its discrepancies at 13 ◦C reach −2 µatm for pCO2,+1 µmolkg −1 for CO 2− 3 , and+0.002 for pH. Discrepancies in other packages remain negligible even at 13◦C. www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1494 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Figure 4. Global zonal-mean surface values (top) and global-mean vertical profiles (bottom) from outdated versions of packages for pCO2 (left), CO 2− 3 (middle), and pH (right) as computed from GLODAP AT and CT as in Figs. 3 and 2. The four older versions include CO2calc (v1.0.4), csys (from 3 February 2010), seacarb (v2.3.3), and mocsy (non public predecessor from Orr et al., 2005). As before, results are shown after subtracting off corresponding results from the same CO2SYS-MATLAB reference. 3.2.2 AT–pH With the AT–pH input pair (Fig. 6), surface discrepancies between packages remain negligible for all variables. All packages agree within 0.02 µatm in pCO2, 0.02 µmolkg −1 in CO 2− 3 , and 0.08 µmolkg−1 in CT across ranges of observed T and S. Below the surface, the swco2 package’s subsurface discrepancies remain negligible with the pressure correction at 2 ◦C, but for water at 13 ◦C they start to become significant below 4000 db. For the other packages, pressure corrections lead to negligible discrepancies for all variables. 3.2.3 AT–pCO2 With the AT–pCO2 input pair (Fig. 7), surface discrepan- cies are always negligible. The five packages differ by less than 0.05 µmolkg−1 in CT and 0.015 µmolkg −1 in CO 2− 3 . Likewise for pH, packages generally agree within 0.0001; only CO2calc exhibits larger variability (within ±0.0004), but those variations are randomly distributed with a mean near zero, a consequence of CO2calc’s limited output pre- cision of only 3 decimal places for pH. The pressure cor- rection when performed at 2◦C does not add significant dis- crepancies, unlike that performed at 13◦C, for which discrep- ancies in swco2 grow linearly with pressure, e.g., reaching +1 µmolkg−1 in CT,+0.1 µmolkg −1 in CO 2− 3 , and+0.0002 in pH at 5000 db. 3.2.4 CT–pH With the CT–pH input pair (Fig. 8), there is similar agree- ment for all packages across ranges of surface T and S. Pack- ages agree within 0.0015 µatm for pCO2, 0.007 µmolkg −1 for CO 2− 3 , and 0.1 µmolkg−1 forAT at surface pressure. With CT–pH, unlike with previously analyzed pairs, the swco2 package’s pressure corrections do not induce substantial dis- crepancies in computed subsurface pCO2 and CO −2 3 , even at 13 ◦C. Yet swco2 does have significant discrepancies in computed subsurface AT (e.g., 1 µmolkg −1 at 4000 db); con- versely, with the pressure correction at T = 2 ◦C, swco2’s AT discrepancies are negligible, consistent with previous pat- terns. In contrast, there is little temperature sensitivity asso- ciated with the slight yet always negligible subsurface dis- crepancies from ODV. 3.2.5 CT–pCO2 With the CT–pCO2 input pair (Fig. 9), all of the five pack- ages have negligible surface discrepancies for computed AT (≤ 0.1 µmolkg −1), CO 2− 3 (≤ 0.01 µmolkg−1), and pH (≤ 0.003 units). Out of the five packages offering both the CT–pCO2 and the CT–pH input pairs (excluding csys and mocsy), only swco2 develops significant subsurface discrep- ancies and only at 13 ◦C for one variable, in both cases. At that temperature, the swco2 package’s discrepancies in com- puted AT grow linearly with depth, reaching 1 µmolkg −1 at 4000 db, similar to those seen with the CT–pH input pair Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1495 Temperature (°C) ∆ p C O 2 (µ a tm ) 0 10 20 30 40 50 − 0 .1 0 .0 0 .1 0 .2 0 .3 Salinity (practical scale) 0 10 20 30 40 50 0 .0 0 0 .0 5 0 .1 0 0 .1 5 CO2SYS CO2calc csys seacarb mocsy ODV swco2 Pressure (db), T=2°C 0 2000 4000 6000 8000 − 0 .0 4 0 .0 0 0 .0 4 Pressure (db), T=13°C 0 2000 4000 6000 8000 − 3 − 2 − 1 0 CO2SYS CO2calc csys seacarb mocsy ODV swco2 ∆ C O 32 − (µ m o l k g −1 ) 0 10 20 30 40 50 − 0 .0 5 − 0 .0 3 − 0 .0 1 0 .0 1 0 10 20 30 40 50 − 0 .0 5 − 0 .0 3 − 0 .0 1 0 2000 4000 6000 8000 − 0 .0 4 0 .0 0 0 .0 2 0 2000 4000 6000 8000 0 .0 0 .5 1 .0 1 .5 CO2SYS CO2calc csys seacarb mocsy ODV swco2 ∆ p H ( to ta l s ca le ) 0 10 20 30 40 50− 1 e − 0 3 0 e + 0 0 1 e − 0 3 0 10 20 30 40 50− 1 e − 0 3 0 e + 0 0 1 e − 0 3 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 CO2SYS CO2calc csys seacarb mocsy ODV swco2 Figure 5. Variables computed from AT and CT for each package minus corresponding results from CO2SYS-MATLAB. The computed pCO2 (top), CO 2− 3 (middle), and pH (bottom) are shown across ranges of T (column 1), S (column 2), and P when T = 2 ◦C (column 3) and when T = 13 ◦C (column 4). For each range, there is one curve per package and per variable. Temperature (°C) ∆ p C O 2 (µ a tm ) 0 10 20 30 40 50 − 0 .0 1 5 − 0 .0 0 5 Salinity (practical scale) 0 10 20 30 40 50 − 0 .0 1 5 − 0 .0 0 5 Pressure (db), T=2°C 0 2000 4000 6000 8000 − 0 .0 2 5 − 0 .0 1 5 − 0 .0 0 5 CO2SYS CO2calc csys seacarb ODV swco2 Pressure (db), T=13°C 0 2000 4000 6000 8000 0 .0 0 0 .1 0 0 .2 0 CO2SYS CO2calc csys seacarb ODV swco2 ∆ C O 32 − (µ m o l k g −1 ) 0 10 20 30 40 50 − 0 .0 1 0 − 0 .0 0 5 0 .0 0 0 0 10 20 30 40 50 − 0 .0 0 8 − 0 .0 0 4 0 .0 0 0 0 .0 0 4 0 2000 4000 6000 8000− 0 .0 0 6 0 .0 0 0 0 .0 0 4 0 .0 0 8 0 2000 4000 6000 8000 0 .0 0 .1 0 .2 0 .3 0 .4 CO2SYS CO2calc csys seacarb ODV swco2 ∆ C T (µ m o l k g −1 ) 0 10 20 30 40 50 − 0 .0 6 − 0 .0 2 0 .0 0 0 10 20 30 40 50 − 0 .0 6 − 0 .0 4 − 0 .0 2 0 .0 0 CO2SYS CO2calc csys seacarb ODV swco2 0 2000 4000 6000 8000 − 0 .1 0 − 0 .0 5 0 .0 0 0 .0 5 0 2000 4000 6000 8000 0 .0 1 .0 2 .0 3 .0 CO2SYS CO2calc csys seacarb ODV swco2 Figure 6. Variables computed from AT and pH with each package minus corresponding results from CO2SYS-MATLAB. Shown are com- puted pCO2 (top), CO 2− 3 (middle), and CT (bottom) across ranges of T (column 1), S (column 2), and P when T = 2 ◦C (column 3) and when T = 13 ◦C (column 4). www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1496 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Temperature (°C) ∆ C T (µ m o l k g −1 ) 0 10 20 30 40 50 − 0 .0 5 − 0 .0 3 − 0 .0 1 0 .0 1 Salinity (practical scale) 0 10 20 30 40 50 − 0 .0 5 − 0 .0 3 − 0 .0 1 CO2SYS CO2calc seacarb ODV swco2 Pressure (db), T=2°C 0 2000 4000 6000 8000 − 0 .0 4 − 0 .0 2 0 .0 0 0 .0 2 CO2SYS CO2calc seacarb ODV swco2 Pressure (db), T=13°C 0 2000 4000 6000 8000 0 .0 0 .5 1 .0 1 .5 2 .0 CO2SYS CO2calc seacarb ODV swco2 ∆ C O 32 − (µ m o l k g −1 ) 0 10 20 30 40 50 − 0 .0 1 5 − 0 .0 0 5 0 .0 0 5 CO2SYS CO2calc seacarb ODV swco2 0 10 20 30 40 50 − 0 .0 1 0 − 0 .0 0 6 − 0 .0 0 2 CO2SYS CO2calc seacarb ODV swco2 0 2000 4000 6000 8000 − 0 .0 0 6 − 0 .0 0 2 0 .0 0 2 0 2000 4000 6000 8000 0 .0 0 0 .0 5 0 .1 0 0 .1 5 0 .2 0 ∆ p H ( to ta l s ca le ) 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000 − 2 e − 0 4 2 e − 0 4 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 Figure 7. Variables computed from AT and pCO2 with each package minus corresponding results from CO2SYS-MATLAB. Shown are computed CT (top), CO 2− 3 (middle), and pH (bottom) across ranges of T (column 1), S (column 2), and P when T = 2 ◦C (column 3) and when T = 13 ◦C (column 4) for each package. Packages not included are mocsy, which allows only the AT–CT pair, and csys, which does not allow pCO2 as an input variable. Temperature (°C) ∆ p C O 2 (µ a tm ) 0 10 20 30 40 50− 0 .0 0 1 5 − 0 .0 0 0 5 Salinity (practical scale) 0 10 20 30 40 50 − 1 e − 0 3 0 e + 0 0 1 e − 0 3 Pressure (db), T=2°C 0 2000 4000 6000 8000 − 0 .0 1 5 − 0 .0 0 5 0 .0 0 5 CO2SYS CO2calc csys seacarb ODV swco2 Pressure (db), T=13°C 0 2000 4000 6000 8000 − 0 .0 2 0 − 0 .0 1 0 0 .0 0 0 CO2SYS CO2calc csys seacarb ODV swco2 ∆ C O 32 − (µ m o l k g −1 ) 0 10 20 30 40 50 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS CO2calc csys seacarb ODV swco2 0 10 20 30 40 50 0 .0 0 0 0 .0 0 1 0 .0 0 2 0 .0 0 3 0 .0 0 4 0 2000 4000 6000 8000 0 .0 0 0 0 .0 1 0 0 .0 2 0 0 2000 4000 6000 8000 0 .0 0 0 0 .0 1 0 0 .0 2 0 CO2SYS CO2calc csys seacarb ODV swco2 ∆ A T (µ m o l k g −1 ) 0 10 20 30 40 50 0 .0 0 0 .0 4 0 .0 8 0 10 20 30 40 50 0 .0 0 0 .0 2 0 .0 4 0 .0 6 0 .0 8 CO2SYS CO2calc csys seacarb ODV swco2 0 2000 4000 6000 8000 − 0 .0 5 0 .0 0 0 .0 5 0 .1 0 0 2000 4000 6000 8000 − 3 − 2 − 1 0 CO2SYS CO2calc csys seacarb ODV swco2 Figure 8. Variables computed from CT and pH with each package minus corresponding results from CO2SYS-MATLAB. Shown are com- puted pCO2 (top), CO 2− 3 (middle), and AT (bottom) across ranges of T (column 1), S (column 2), and P when T = 2 ◦C (column 3) and when T = 13 ◦C (column 4) for each software package. Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1497 (Fig. 8). As before with the low-temperature correction, dis- crepancies in swco2’s AT remain negligible. Considering results from the five input pairs together, we can now make several general comments. For all intents and purposes, surface discrepancies remain negligible. The only exception is pCO2 computed by ODV with the AT–CT in- put pair, but its discrepancies still remains less than one-fifth of the best measurement precision. Subsurface discrepancies are not significantly worse than those at the surface, i.e., for common deep waters at 2◦C. Conversely, with deep waters at 13◦C, characteristic of the Mediterranean Sea, one pack- age (swco2) does exhibit significant subsurface discrepan- cies. Yet even under those extreme conditions, swco2 dis- crepancies above 1000 m remain less than the best measure- ment precision. They concern either computed AT or other variables computed when AT is a member of the input pair. 3.3 Chemical factors In Sect. 3.2, we compared differences among packages while varying physical input for different input pairs. Here we as- sess differences due to chemical factors, namely accounting for alkalinity from silicic and phosphoric acids (nutrient al- kalinity) and opting for potentially important developments since publication of the best-practices guide (Dickson et al., 2007). 3.3.1 Nutrients Both PT and SiT contribute to the total alkalinity. Thus they affect computed carbonate alkalinity AC when their concen- trations are significant and one member of the input pair is AT. One of the packages, csys, neglects this nutrient alkalin- ity, assuming PT and SiT concentrations are always zero. All other packages account for nutrient alkalinity. Two of those exhibit discrepancies relative to CO2SYS-MATLAB that be- come significant as nutrient concentrations are increased to the maxima observed in the ocean (Fig. 10). Discrepancies for swco2 grow linearly with nutrient concentrations, reach- ing −0.2 µatm in pCO2, +0.07 µmolkg −1 in CO 2− 3 , and +0.0002 units in pH. These discrepancies are largely associ- ated with SiT; those from PT are more than 10 times smaller. For CO2calc, discrepancies in pH seem to reach up to nearly 0.001, but those are due to the precision in CO2calc’s pH output (given to only three decimal places). These differences between packages are at least 70 times smaller than the actual changes in computed variables at- tributable to alkalinity from PT and SiT. With the AT–CT input pair, this nutrient alkalinity increases computed pCO2 by 6 µatm for average surface waters in the Southern Ocean and by 12 µatm for average deep waters (below 2000 m); si- multaneously, CO 2− 3 is reduced by about 2 µmolkg−1 in the same waters (Orr and Epitalon, 2015). 3.3.2 Total boron Relative to the standard formulation for total boron (Upp- ström, 1974), the new formulation (Lee et al., 2010) repre- sents about a 3% increase of borate alkalinity throughout the ocean. Hence we first assessed whether or not packages gave consistent responses when changing from the standard to the new formulation. For the six packages that allow for the new formulation (CO2SYS-MATLAB, both CO2SYS-Excel variants, CO2calc, mocsy, and seacarb), computed changes agree within 0.15 µatm for pCO2, 0.02 µmolkg −1 for CO 2− 3 , and 0.00006 for pH, i.e., with the AT–CT pair across ob- served ranges of T , S, and P (Fig. 11). With other input pairs, agreement is closer still, but the comparison is limited to fewer packages (mocsy treats only AT–CT). Much larger are the actual changes themselves. With the AT–CT pair, given global average surface conditions (T = 18◦C, S = 35), changing from the standard to the new formulation for to- tal boron increases pCO2 by 5.7 µatm, decreases CO 2− 3 by 2.1 µmolkg−1, and decreases pH by 0.0056 units. Changes are generally smaller with the AT–pH and AT–pCO2 pairs (e.g., −0.3 and −0.4 µmolkg−1 for CO 2− 3 , respectively). Conversely, with the CT–pH and CT–pCO2 pairs, changes are negligible for all computed carbonate system variables except total alkalinity. 3.3.3 K1 and K2 The formulations for K1 and K2 from Lueker et al. (2000) are recommended for best practices (Dickson et al., 2007), but they are intended to be restricted to waters with S be- tween 19 and 43 and T between 2 and 35 ◦C. For waters with physical conditions outside of those ranges, there are no rec- ommended K1 and K2 formulations. However, formulations exist, such as those from the most recent reassessment by Millero (2010), which are applicable over wider ranges of S (1–50) and T (0–50 ◦C). With an analysis analogous to that shown in Fig. 5 (Sect. 3.2.1), we replaced formulations for K1 and K2 from Lueker et al. (2000) with those from Millero (2010) to assess the consistency of computed variables in the six packages that include this newer option (CO2SYS-MATLAB, both CO2SYS-Excel variants, CO2calc, seacarb, and mocsy). With the AT–CT pair, four out of six packages agree closely at surface pressure across ranges of T and S (Fig. 12). Con- versely, CO2calc differs from the CO2SYS-MATLAB refer- ence by up to −12 µatm in pCO2, −1.2 µmolkg −1 in CO 2− 3 , and +0.006 units in pH. Discrepancies are also found for seacarb, reaching up to −20 µatm in pCO2, ±0.2 µmolkg −1 in CO 2− 3 , and −0.0025 units in pH. However, seacarb’s discrepancies at the surface are inconsistent with its neg- ligible subsurface discrepancies. Pressure corrections alter CO2calc’s discrepancies by less than +1 µatm in pCO2, −0.05 µmolkg−1 in CO 2− 3 , and −0.001 units in pH, changes that are notably less than its surface discrepancies. Although www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1498 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Temperature (°C) ∆ A T (µ m o l k g −1 ) 0 10 20 30 40 50 − 0 .0 2 0 .0 2 0 .0 4 0 .0 6 0 .0 8 Salinity (practical scale) 0 10 20 30 40 50 0 .0 0 0 .0 2 0 .0 4 0 .0 6 CO2SYS CO2calc seacarb ODV swco2 Pressure (db), T=2°C 0 2000 4000 6000 8000 − 0 .0 2 0 .0 0 0 .0 2 0 .0 4 Pressure (db), T=13°C 0 2000 4000 6000 8000 − 2 .0 − 1 .5 − 1 .0 − 0 .5 0 .0 CO2SYS CO2calc seacarb ODV swco2 ∆ C O 32 − (µ m o l k g −1 ) 0 10 20 30 40 50 − 0 .0 1 0 0 .0 0 0 0 .0 0 5 0 .0 1 0 0 10 20 30 40 50 − 0 .0 1 0 0 .0 0 0 0 .0 0 5 0 .0 1 0 0 2000 4000 6000 8000 − 0 .0 0 4 0 .0 0 0 0 .0 0 4 0 2000 4000 6000 8000 − 0 .0 0 4 0 .0 0 0 0 .0 0 4 ∆ p H ( to ta l s ca le ) 0 10 20 30 40 50− 1 e − 0 3 0 e + 0 0 1 e − 0 3 0 10 20 30 40 50− 1 e − 0 3 0 e + 0 0 1 e − 0 3 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 Figure 9. Variables computed from CT and pCO2 with each package minus corresponding results from CO2SYS-MATLAB. Shown are computed AT (top), CO 2− 3 (middle), and pH (bottom) across ranges of T (column 1), S (column 2), and P when T = 2 ◦C (column 3) and when T = 13 ◦C (column 4) for each package. fewer packages offer the Millero (2010) formulations for K1 and K2, the resulting differences between packages reach levels that are orders of magnitude larger than with the Lueker et al. (2000) formulations. 3.4 Computational efficiency Besides the accuracy and precision of the different pack- ages that compute carbonate system variables, some users with large data sets may be concerned with computational efficiency. To assess differences in computation time be- tween packages, we chose to use the global gridded data set described in Sect. 3.1. With nearly 1 million ocean grid points, the computational time needed to compute all car- bonate system variables varies by more than a factor of 1800 between packages (Table 2). The slowest package (swco2- Excel) required more than half a day, while the fastest (mocsy) needed 30 s. Packages based on spreadsheets are generally slower than those run by directly calling routines with programming languages (Fortran 95, MATLAB, Visual Basic). The latter are usually coded so that the equilibrium calculations are made one time for each set of input data, whereas spreadsheets often repeat the same set of calcula- tions for each computed variable (each cell). An exception is CO2SYS-Excel-Pelletier, whose execution time rivals that of CO2SYS-MATLAB. Fortunately, even with the slowest of the packages shown in Table 2, the computational time is triv- ial for most observational analysis efforts, because the num- ber of samples is much smaller. Hence developers of most packages have not concerned themselves with computational efficiency. Nonetheless, for very large data sets and for mod- els, which may have millions of grid cells to treat every time step, computational efficiency is critical. 4 Discussion To diagnose why computed variables differ between pack- ages, we computed their sensitivities to each constant, as- sessed errors in individual constants, and used both to assign causes. 4.1 Sensitivity to individual constants A computed variable y is affected by errors in all input vari- ables (including constants as well as members of the input pair), each denoted here as xi (for i = 1,2, . . .n). Thus, we calculated the sensitivity ratio as the relative change of y to the relative change in each xi , namely ∂y/y : ∂xi/xi . These sensitivity ratios were determined numerically in three suc- cessive steps. First, we calculated variables with seacarb un- der our standard conditions (S = 35, T = 18◦C, P = 0 db, and zero nutrients, along with CT = 2058.185 and AT = 2300 µmolkg−1). Then, we increased each input variable by 1 % (∂xi/xi = 0.01), individually, and recalculated out- Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1499 PT and SiT (µmol kg−1) p C O 2 (µ a tm ) 0 1 2 3 4 − 0 .2 0 − 0 .1 0 0 .0 0 co2sys co2calc seacarb mocsy ODV swco2 SiT (µmol kg−1) 0 50 100 150 200 − 0 .2 0 − 0 .1 0 0 .0 0 co2sys co2calc seacarb mocsy ODV swco2 PT (µmol kg−1) 0 1 2 3 4 − 0 .0 1 0 0 .0 0 0 0 .0 0 5 C O 32 − (µ m o l k g −1 ) 0 1 2 3 4 0 .0 0 0 .0 2 0 .0 4 0 .0 6 co2sys co2calc seacarb mocsy ODV swco2 0 50 100 150 200 0 .0 0 0 .0 2 0 .0 4 0 .0 6 co2sys co2calc seacarb mocsy ODV swco2 0 1 2 3 4− 0 .0 0 6 − 0 .0 0 2 0 .0 0 2 p H ( to ta l s ca le ) 0 1 2 3 4 − 8 e − 0 4 − 4 e − 0 4 0 e + 0 0 0 50 100 150 200 − 8 e − 0 4 − 4 e − 0 4 0 e + 0 0 0 1 2 3 4 − 8 e − 0 4 − 4 e − 0 4 0 e + 0 0 Figure 10. Effect of nutrients on variables computed from AT and CT with each package minus results for CO2SYS-MATLAB. Shown are effects on computed pCO2 (top), CO 2− 3 (middle), and pH (bottom) across the observed oceanic ranges of PT (right), SiT (center), and their combined effect (left) for each package. Results from the two CO2SYS Excel variants are not shown, but both agree with the reference. Results for csys are not included as it assumes that nutrient concentrations are always zero. put variables with seacarb for each perturbation. Finally, we took the difference between the first and second computa- tions to obtain the proportional change in the computed vari- able ∂y/y. Table 11 shows these sensitivity ratios for each variable and constant. Sensitivities of computed variables to input AT, CT, K0, and K1 are much like those from Dickson and Riley (1978), who used the same approach but with differ- ent software, input data, and values for constants. Yet our sensitivities to K2 differ. Although only ∼ 30 % smaller for computed CO∗ 2 , pCO2, and H +, they are 7 times larger for CO 2− 3 as well as �A and �C. The former moderate reduc- tions occur because the K2 from Lueker et al. (2000) at stan- dard conditions is 30 % greater than Dickson and Riley’s (pK2 = 9.115). Conversely, our sevenfold-greater sensitivity of CO 2− 3 toK2 is mysterious. It does not appear to come from our numerical derivative, which we have verified by comput- ing analytical solutions by hand in other pairs when feasible. However, part of the difference could derive from slightly different approaches: Dickson and Riley (1978) used AC as an input variable, while we used AT. With the AT–CT input pair, the sensitivities to K1 and K2 generally dominate, as expected from Dickson and Ri- ley (1978). There is a similarly large sensitivity to K0 when computing pCO2 and fCO2. The sensitivities to other con- stants have not been discussed previously. We find a large sensitivity to KB, even surpassing that to K1 for computed H+, HCO − 3 , CO 2− 3 , �A, and �C. The sensitivity to KW is also significant but remains 14 to 26 times smaller than that forKB. The sensitivity to other constants remain small (abso- lute values less than 0.001), except for the solubility products KA and KC, which are inversely proportional to �A and �C (large negative sensitivities of −1). Sensitivities differ with other input pairs as shown by Dickson and Riley (1978). These sensitivities are fundamental to the classic propa- gation of relative errors that has already been applied to the carbonate system (Dickson and Riley, 1978; Dickson et al., 2007). In that, the uncertainty u of computed variable y is expressed as u(y) y = √√√√ n∑ i=1 ( ∂y/y ∂xi/xi )2( u(xi) xi )2 , (4) www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1500 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Temperature (°C) p C O 2 (µ a tm ) 0 10 20 30 40 50 − 0 .1 5 − 0 .1 0 − 0 .0 5 0 .0 0 co2sys co2calc seacarb mocsy Salinity (practical scale) 0 10 20 30 40 50 − 0 .0 8 − 0 .0 4 0 .0 0 co2sys co2calc seacarb mocsy Pressure (db) 0 2000 4000 6000 8000 − 0 .0 6 − 0 .0 4 − 0 .0 2 0 .0 0 co2sys co2calc seacarb mocsy C O 32 − (µ m o l k g −1 ) 0 10 20 30 40 50 0 .0 0 0 0 .0 0 5 0 .0 1 0 0 .0 1 5 0 .0 2 0 co2sys co2calc seacarb mocsy 0 10 20 30 40 50 0 .0 0 0 0 .0 0 5 0 .0 1 0 0 .0 1 5 0 .0 2 0 co2sys co2calc seacarb mocsy 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 5 0 .0 1 0 0 .0 1 5 0 .0 2 0 co2sys co2calc seacarb mocsy p H ( to ta l s ca le ) 0 10 20 30 40 50 − 6 e − 0 4 0 e + 0 0 4 e − 0 4 0 10 20 30 40 50 − 5 e − 0 4 5 e − 0 4 1 e − 0 3 0 2000 4000 6000 8000 − 5 e − 0 4 0 e + 0 0 5 e − 0 4 co2sys co2calc seacarb mocsy Figure 11. Effect of increased total boron on variables computed from AT and CT with each package minus results for CO2SYS-MATLAB. Shown are the effects of the increased boron (Lee et al. (2010) minus Uppström (1974)) on computed pCO2 (top), CO 2− 3 (middle), and pH (bottom) across ranges of T (left), S (center), and P (right). The Lee et al. (2010) formulation is included in six packages: CO2SYS- MATLAB, CO2calc, seacarb, mocsy, and both CO2SYS Excel variants. The latter two are not shown but agree with the reference. The recommendation to use the Uppström (1974) formulation by Dickson et al. (2007) came before the Lee et al. (2010) study. Table 11. Ratio of relative changea,b between output and input variablesc, d (∂y/y)/(∂xi/xi). Input Output AT CT K0 K1 K2 KB KW KS KF KA KC CO∗ 2 −9.5 11.7 −0.92 0.63 0.28 0.02 HCO − 3 −0.7 1.7 0.01 −0.03 0.02 CO 2− 3 8.8 −7.4 −0.05 0.30 −0.24 −0.01 H+ −8.8 9.8 0.06 0.66 0.26 0.01 pCO2 −9.5 11.7 −0.99 −0.92 0.63 0.28 0.02 fCO2 −9.5 11.7 −0.99 −0.92 0.63 0.28 0.02 �A 8.8 −7.4 −0.05 0.30 −0.24 −0.01 −0.99 �C 8.8 −7.4 −0.05 0.30 −0.24 −0.01 −0.99 a Percent change in output (dy/y) computed from a 1 % change in input (dx/x). b Missing values indicate changes of less then 0.001 %. c Ratios were computed under the standard conditions described in Sect. 4.1. d Ratios are sensitive to solution composition. Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1501 Temperature (°C) ∆ p C O 2 (µ a tm ) 0 10 20 30 40 50 − 2 0 − 1 5 − 1 0 − 5 0 CO2SYS CO2calc seacarb mocsy Salinity (practical scale) 0 10 20 30 40 50 − 1 2 − 8 − 6 − 4 − 2 0 CO2SYS CO2calc seacarb mocsy Pressure (db), T=2°C 0 2000 4000 6000 8000 − 3 .5 − 2 .5 − 1 .5 − 0 .5 CO2SYS CO2calc seacarb mocsy Pressure (db), T=13°C 0 2000 4000 6000 8000 − 6 − 5 − 4 − 3 − 2 − 1 0 CO2SYS CO2calc seacarb mocsy ∆ C O 32 − (µ m o l k g −1 ) 0 10 20 30 40 50 − 1 .0 − 0 .6 − 0 .2 0 .2 CO2SYS CO2calc seacarb mocsy 0 10 20 30 40 50 − 1 .2 − 0 .8 − 0 .4 0 .0 CO2SYS CO2calc seacarb mocsy 0 2000 4000 6000 8000 − 1 .0 − 0 .6 − 0 .2 0 .0 CO2SYS CO2calc seacarb mocsy 0 2000 4000 6000 8000 − 1 .0 − 0 .6 − 0 .2 0 .0 CO2SYS CO2calc seacarb mocsy ∆ p H ( to ta l s ca le ) 0 10 20 30 40 50 − 0 .0 0 2 0 .0 0 2 0 .0 0 6 0 10 20 30 40 50 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS CO2calc seacarb mocsy 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 CO2SYS CO2calc seacarb mocsy 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS CO2calc seacarb mocsy Figure 12. Variables computed from AT and CT with each package minus corresponding results from CO2SYS-MATLAB, as in Fig. 5 but with K1 and K2 from Millero (2010) instead of from Lueker et al. (2000). Shown are computed pCO2 (top), CO 2− 3 (middle), and pH (bottom) across ranges of T (column 1), S (column 2), and P when T = 2 ◦C (column 3) and when T = 13 ◦C (column 4). where the left-hand side is the relative error in y, a function of the right-hand side’s individual relative errors of each input variable and constant (u(xi)/xi) multiplied by the square of the associated sensitivity term (∂y/y)/(∂xi/xi) (Table 11). Hence to assess the relative importance of each input vari- able, we need not only its sensitivity but also its uncertainty. For the case where relative errors for each of the constants are assumed to be similar (Table 8), it is largely the sensitiv- ity term which determines the relative contribution of each constant to the overall error. Yet numerical errors in com- puted constants are neither identical nor entirely negligible in all packages. 4.2 Errors in equilibrium constants In order to identify sources of error, equilibrium constants were plotted in the same manner as computed variables. By characterizing errors graphically, we were able to use pat- terns in discrepancies to help isolate problems and eventu- ally identify causes, particularly in packages where source code was available. For packages without source code, we attempted to reproduce discrepancy patterns by making tem- porary modifications to another package where source code was available. 4.2.1 K0, K1, and K2: best practices The constants that have the greatest potential to cause the differences in computed variables seen in Fig. 5 are K0, K1, andK2 (Table 11), simply because of their prominence in the fundamental equilibria. For K0, all packages have negligible discrepancies relative to CO2SYS-MATLAB across ranges of T and S, and all packages agree with the check value from Dickson et al. (2007) to its fourth and final decimal place (Table 12). For K1 and K2 with the Lueker et al. (2000) formulation, the story is the same (Fig. 13). None of these three best-practices constants can be responsible for signifi- cant discrepancies in computed variables. 4.2.2 Alternative K1 and K2 for low salinities Section 3.3.3 detailed the large discrepancies among pack- ages, in terms of computed variables, that were generated simply by replacing the Lueker et al. (2000) formulations for K1 and K2 with those from Millero (2010), i.e., the most recent alternative for low-salinity waters and the one based on the greatest number of measurements. Hence the implementation of the Millero (2010) formulations must be done inconsistently between the different packages. Indeed, six packages (three CO2SYS variants and three others) offer that new option, but three of them show significant surface discrepancies in K1 and K2 relative to those computed by www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1502 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Table 12. Check values vs. computed equilibrium constants (pKs) at T = 25 ◦C, S = 35, and P = 0. pK0 pK1 pK2 pKB pKW pKS a pKF a Check value 1.5468 5.8472 8.966 8.5975 13.217 0.999 2.627 swco2 1.54681 5.84715 8.96595 8.59747 13.2204 0.9987 2.6261 mocsy 1.54681 5.84715 8.96595 8.59747 13.2204 0.9987 2.6261 CO2SYS-MATLAB 1.54681 5.84715 8.96595 8.59747 13.2204 0.9987 2.6261 CO2SYS-Excel-Pelletier 1.54681 5.84715 8.96595 8.59747 13.2204 0.9987 2.6261 csys 1.54681 5.84715 8.96595 8.59747 13.2204 0.9987 2.6261 seacarb 1.54681 5.84715 8.96595 8.59747 13.2204 0.9987 2.6261 CO2calc 1.5468 5.847b 8.966b 8.597 13.220 ODV 1.54680 5.84715 8.96595 a Free scale (all other pKs are on the total scale). b All CO2calc constants shown here are computed from other output variables; the pK1 and pK2 calculated directly by CO2calc, provided by its developers, agree with the reference to beyond six decimal places (L. Robbins, personal communication, 2014). Table 12. Continued. pKC pKA pK1P pK2P pK3P pKSi Check value 1.61 5.962 8.79 9.39 swco2 6.3693 6.1883 1.6215 5.9714 8.799 9.393 mocsy 6.3693 6.1883 1.6150 5.9649 8.792 9.387 CO2SYS-MATLAB 6.3693 6.1883 1.6150 5.9649 8.793 9.387 CO2SYS-Excel-Pelletier 6.3693 6.1883 1.6150 5.9649 8.792 9.387 csys 6.3693 6.1883 1.6150 5.9649 8.792 seacarb 6.3693 6.1883 1.6150 5.9649 8.792 9.387 CO2calc 6.369 6.188 ODV 6.3693 6.1883 CO2SYS-MATLAB (Fig. 14). Patterns of those discrepan- cies are qualitatively consistent with patterns of computed variables found with the same option (Fig. 12). A compari- son of the source code in three packages revealed that their implemented formulations are strictly identical; however, the sets of coefficients differ. More precisely, Millero fit 551 measurements of K1 and 590 measurements of K2 on the seawater pH scale to basic equations of the form pKi − pK 0 i = Ai +Bi/Tk +Ci ln(Tk), (5) where pK0 i was from his previous fit of the same form for pure water (Millero et al., 2006); Tk is the absolute tempera- ture; and Ai , Bi , and Ci are functions of salinity: Ai = α0S 0.5 +α1S+α2S 2 , Bi = α3S 0.5 +α4S, Ci = α5S 0.5 . (6) Millero (2010) provides this set of the six αi coefficients for each of K1 and K2 on the original seawater pH scale but also on the free and total scales, i.e., by making analogous fits after converting the measured constants to each of those other scales (Millero, 2010, Eqs. 9 to 12). With the Millero (2010) formulation, the four packages with internally consistent results are CO2SYS-MATLAB, CO2SYS-Excel-Pierrot, CO2SYS-Excel-Pelletier, and mocsy (Fig. 14). All use the coefficients for his formulation on the seawater scale. In seacarb, however, it is more complicated. At the surface, seacarb uses Millero’s set of coefficients on the total scale to compute K1 and K2; con- versely, below the surface seacarb uses Millero’s coefficients for the seawater scale and then converts the resulting con- stants to the total scale after making the pressure correction (as is appropriate). Although the two approaches should yield equivalent results, seacarb’s constants computed for the surface differ from those calculated by the reference. Conversely, below the surface, seacarb agrees with the ref- erence. Because seacarb’s formulations and coefficients are strictly identical to those published by Millero (2010), which we have verified closely, the surface discrepancies imply an inconsistency between Millero’s sets of coefficients for the total and seawater scales. Both sets should yield the same results for K1 and for K2, e.g., once the results from the seawater set are converted back to the total scale. Yet they do not. Indeed whenK1 andK2 were computed separately from Millero’s published sets of coefficients, we found similar patterns of surface discrepancies as already seen between seacarb and CO2SYS-MATLAB (Fig. 15). Patterns matched exactly when we also accounted for the differences in KF. That is, Millero converted pK1 and pK2 on the measured Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1503 Temperature (°C) ∆ p K 0 0 10 20 30 40 50 − 1 e − 0 5 1 e − 0 5 ● Salinity (practical scale) 0 10 20 30 40 50 − 3 e − 0 5 0 e + 0 0 2 e − 0 5 Pressure (db), T=2°C 0 2000 4000 6000 8000 − 1 e − 0 4 1 e − 0 4 2 e − 0 4 Pressure (db), T=13°C 0 2000 4000 6000 8000 − 0 .0 0 0 1 5 0 .0 0 0 0 0 0 .0 0 0 1 5 ∆ p K 1 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 ● 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 ∆ p K 2 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 ● 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 Figure 13. The pK0 (top), pK1 (middle), and pK2 (bottom) computed with each package minus corresponding values for CO2SYS- MATLAB. Formulations are those recommended for best practices, namely K0 from Weiss (1974) and K1 and K2 from Lueker et al. (2000). Constants were computed across the same ranges of T (column 1), S (column 2), and P when T = 2 ◦C (column 3) and when T = 13 ◦C (column 4) as used in previous figures. Constants from CO2calc and ODV were not directly available but are estimated from variables computed with the AT–CT pair. The filled black circles indicate the check values (Table 12). Line signatures are as in Fig. 5. Temperature (°C) ∆ p K 1 0 10 20 30 40 50 − 0 .0 1 0 − 0 .0 0 6 − 0 .0 0 2 CO2SYS CO2calc seacarb mocsy ● Salinity (practical scale) 0 10 20 30 40 50 − 0 .0 1 0 − 0 .0 0 6 − 0 .0 0 2 CO2SYS CO2calc seacarb mocsy Pressure (db), T=2°C 0 2000 4000 6000 8000 − 0 .0 0 6 − 0 .0 0 2 CO2SYS CO2calc seacarb mocsy Pressure (db), T=13°C 0 2000 4000 6000 8000 − 0 .0 0 8 − 0 .0 0 4 0 .0 0 0 CO2SYS CO2calc seacarb mocsy ∆ p K 2 0 10 20 30 40 50− 0 .0 0 4 0 .0 0 0 0 .0 0 4 0 .0 0 8 CO2SYS CO2calc seacarb mocsy ● 0 10 20 30 40 50 0 .0 0 0 0 .0 0 4 0 .0 0 8 CO2SYS CO2calc seacarb mocsy 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 4 0 .0 0 8 CO2SYS CO2calc seacarb mocsy 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 4 0 .0 0 8 CO2SYS CO2calc seacarb mocsy Figure 14. The pK1 (top) and pK2 (bottom) computed in each of four packages minus corresponding values for CO2SYS-MATLAB, as in Fig. 13 except that formulations are from Millero (2010), not Lueker et al. (2000). The filled black circles indicate the check values (Table 12). Six packages include this option. Only CO2SYS-MATLAB, CO2calc, seacarb, and mocsy are shown. Both CO2SYS Excel variants agree with the reference, but when CO2SYS-Excel-Pelletier is switched from the published to the unpublished seawater-scale coefficients, it resembles CO2calc. www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1504 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Temperature (°C) ∆ p K 1 0 10 20 30 40 50 − 0 .0 1 5 − 0 .0 1 0 − 0 .0 0 5 0 .0 0 0 SWS (spreadsheet) SWS (Table 2) T (spreadsheet) T (Table 2) Salinity (practical scale) 0 10 20 30 40 50 − 0 .0 1 5 − 0 .0 1 0 − 0 .0 0 5 0 .0 0 0 SWS (spreadsheet) SWS (Table 2) T (spreadsheet) T (Table 2) ∆ p K 2 0 10 20 30 40 50 − 0 .0 1 5 − 0 .0 1 0 − 0 .0 0 5 0 .0 0 0 SWS (spreadsheet) SWS (Table 3) T (spreadsheet) T (Table 3) 0 10 20 30 40 50 − 0 .0 1 4 − 0 .0 1 0 − 0 .0 0 6 − 0 .0 0 2 SWS (spreadsheet) SWS (Table 3) T (spreadsheet) T (Table 3) Figure 15. Relative differences between four formulations for pK1 (top) as well as pK2 (bottom), i.e., between values computed from four different sets of coefficients from Millero (2010) over ranges of T (left) and S (right). Two sets of coefficients are from Millero’s (2010) Tables 2 and 3, i.e., for the total scale (T , orange dotted line) and the seawater scale (SWS, blue dotted line). The two other sets, also on the T and SWS scales (solid lines), have greater precision, coming from the spreadsheet used for calculations in the same publication (F. J. Millero, personal communication 2013). For consistent comparison, both SWS curves were converted to the to- tal scale using the standard approach (Millero, 2010, Eqs. 11 and 12) and KF from Perez and Fraga (1987). Curves are shown after subtracting values from the preferred formulation (spreadsheet co- efficients for the SWS scale converted to the T scale). seawater scale to the total scale using KF from Perez and Fraga (1987), whereas for this study all packages use KF from Dickson and Riley (1979). Thus seacarb shows surface discrepancies (relative to CO2SYS-MATLAB) primarily because it uses Millero’s coefficients on the total scale, which are inconsistent with those on the seawater scale, and secondly because the KF used by Millero is inconsistent with that used in this study. The second package that differs substantially from CO2SYS-MATLAB is CO2calc, but only for K2. Although CO2calc’s main code was taken from CO2SYS, the CO2calc developers included the Millero (2010) K1 and K2 formu- lations themselves, before they were available in CO2SYS. Lacking the CO2calc source code, we studied discrepancy patterns and made sensitivity tests. These differences appear to come from a different number of significant figures in one of the coefficients. More precisely, Fig. 15 compares the constants computed from the published set of coeffi- cients (Millero, 2010, Tables 2 and 3) to those computed with the unpublished yet more precise set of coefficients used by Millero, i.e., his spreadsheet for the same publication (F. J. Millero, personal communication 2013). Only the α5 coeffi- Table 13. Coefficients from Millero (2010) for formulations of K1 and K2 (seawater scale). K1 K2 α0 13.4038 21.3728 α1 0.03206 0.1218 α2 −5.242×10 −5 −3.688×10−4 α3 −530.659 −788.289 α4 −5.8210 −19.189 α5 −2.0664 −3.374 ∗ ∗ Value is −3.3738 in Millero’s spreadsheet (F. J. Millero, personal communication, 2013). Temperature (°C) K 1 K 2 q u o tie n t 0 10 20 30 40 50 0 .9 8 5 0 .9 9 5 1 .0 0 5 1 .0 1 5 SWS (spreadsheet) SWS (Table 2) T (spreadsheet) T (Table 2) Salinity (practical scale) 0 10 20 30 40 50 0 .9 8 5 0 .9 9 5 1 .0 0 5 1 .0 1 5 Figure 16. The ratio of K1/K2 for each set of coefficients from Millero (2010) over the same ratio for the reference. We refer to that ratio of ratios as the K1/K2 quotient. The reference is chosen arbitrarily as Millero’s set of coefficients on SWS scale from his spreadsheet. Curve colors and line patterns are as in Fig. 15. cient differs, being given with one additional decimal place in the spreadsheet (Table 13). The difference between con- stants computed with the published coefficients and those computed with unpublished coefficients, i.e., the spreadsheet coefficients on the seawater scale, match the pattern and mag- nitude of the differences between CO2calc and CO2SYS- MATLAB (compare Figs. 15 and Fig. 14). Hence CO2calc developers appear to have used the set of seawater-scale co- efficients from Millero’s spreadsheet. To further confirm that the different sets of coefficients yield fundamentally different results, we made two addi- tional comparisons. First, we compared their K1/K2 ratios (Fig. 16). By definition, that ratio should be independent of the pH scale, yet with different sets of coefficients it dif- fers by up to 1.5% over the observed range of T and S. Secondly, we made a sensitivity test with CO2SYS-Excel- Pelletier’s two options for the Millero (2010) formulation (two sets of coefficients), both of which became available after our discussion paper was published. With that package, users choose to use either the published seawater-scale co- efficients (as in the CO2SYS-MATLAB) or the unpublished seawater-scale coefficients from the spreadsheet (as used by CO2calc). With the former, CO2SYS-Excel-Pelletier agrees with the reference; with the latter, results are like those for CO2calc. Therefore, all three simple analyses indicate that it Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1505 Temperature (°C) ∆ p K B 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 ● Salinity (practical scale) 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 Pressure (db), T=2°C 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 Pressure (db), T=13°C 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 5 0 .0 1 0 0 .0 1 5 co2sys co2calc csys seacarb mocsy swco2 ∆ p K W 0 10 20 30 40 50 − 0 .0 0 3 − 0 .0 0 1 0 .0 0 0 co2sys co2calc csys seacarb mocsy swco2 ● 0 10 20 30 40 50 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000 − 4 e − 0 4 0 e + 0 0 4 e − 0 4 0 2000 4000 6000 8000− 6 e − 0 4 − 2 e − 0 4 2 e − 0 4 ∆ p K S i 0 10 20 30 40 50− 0 .0 0 2 0 .0 0 2 0 .0 0 6 co2sys seacarb mocsy swco2 ● 0 10 20 30 40 50 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 co2sys seacarb mocsy swco2 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 co2sys seacarb mocsy swco2 0 2000 4000 6000 8000 0 .0 0 0 0 .0 1 0 0 .0 2 0 co2sys seacarb mocsy swco2 Figure 17. The pKB (top), pKW (middle), and pKSi (bottom) computed from each package minus corresponding values from CO2SYS- MATLAB. Formulations are from Millero (1995), as recommended for best practices. The filled black circles indicate the check values (Table 12). is the different sets of coefficients that cause substantial dif- ferences in computed variables. It is tempting to conclude that all package developers should simply adopt the spreadsheet’s more precise set of coefficients on the seawater scale, given their greater pre- cision and their consistency with original results (Millero, 2010, Fig. 3). However, even that set of unpublished coeffi- cients, which is more precise than those published, may have two few significant figures To test that concern, we exploited the same spreadsheet’s coefficients for the total scale, which are given to more decimal places than its seawater-scale co- efficients. By incrementally reducing the number of decimal places in each unpublished total-scale coefficient (one at a time), we determined the point at which calculated variables change significantly. Thus we found that the published α1 for K1 for the total scale would need to be extended from 4 to 5 decimal places, while the α5 for K1 as well as that for K2 would both need to be extended from 4 to 6 decimal places before results match those computed with the unpub- lished spreadsheet’s total-scale coefficients. It follows that the published seawater-scale coefficients should be extended likewise, because they have similar magnitudes and the same number of significant figures as the published total-scale co- efficients. The much larger disagreement among packages found when changing from the Lueker et al. (2000) formula- tions forK1 andK2 to those from Millero (2010) emphasizes the danger of applying conclusions from one comparison to cases with different sets of constants. 4.2.3 KB and KW: principal non-carbonate alkalinity constants Previous comparison revealed significant discrepancies in subsurface variables computed from the swco2 package (Fig. 5–9), which are not due to K1 and K2 (Fig. 13). These discrepancies occur only when AT is a member of the input pair or when AT is computed, suggesting that they stem from the need to correct from total to carbonate alkalinity. The largest factor to correct for is borate alkalinity; hence it is also the most likely cause. Indeed, comparison of KB computed by the different packages does reveal discrepancies for swco2 (Fig. 17). Furthermore, swco2’s divergence from CO2SYS- MATLAB increases linearly with depth, consistent with dis- crepancies in computed variables. Although we do not have access to the code for swco2, this discrepancy is consistent with a sign error in its a2 pressure-correction coefficient for KB, as verified by sensitivity tests in seacarb. This same er- ror was only identified and corrected in other packages (e.g., in csys and seacarb) in 2010, whereas the current version of swco2 (v2) dates from 2007. Because the a2 coefficient is multiplied by the square of Tc (Eq. 2), the swco2 discrepan- cies associated with the pressure correction of KB are about www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1506 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Temperature (°C) ∆ p K F 0 10 20 30 40 50 0 e + 0 0 2 e − 0 4 4 e − 0 4 ● CO2SYS csys seacarb mocsy swco2 Salinity (practical scale) 0 10 20 30 40 50 0 e + 0 0 2 e − 0 5 4 e − 0 5 6 e − 0 5 CO2SYS csys seacarb mocsy swco2 Pressure (db), T=2°C 0 2000 4000 6000 8000 0 e + 0 0 2 e − 0 5 4 e − 0 5 6 e − 0 5 CO2SYS csys seacarb mocsy swco2 Pressure (db), T=13°C 0 2000 4000 6000 8000 0 e + 0 0 2 e − 0 5 4 e − 0 5 6 e − 0 5 CO2SYS csys seacarb mocsy swco2 ∆ p K S 0 10 20 30 40 50 0 .0 0 0 0 0 0 .0 0 0 1 0 CO2SYS csys seacarb mocsy swco2 ● 0 10 20 30 40 50 0 .0 0 0 0 0 0 .0 0 0 1 0 0 .0 0 0 2 0 CO2SYS csys seacarb mocsy swco2 0 2000 4000 6000 8000 0 e + 0 0 4 e − 0 5 8 e − 0 5 CO2SYS csys seacarb mocsy swco2 0 2000 4000 6000 8000 0 e + 0 0 4 e − 0 5 CO2SYS csys seacarb mocsy swco2 ∆ p K A 0 10 20 30 40 50 0 .0 0 0 0 0 0 .0 0 0 1 0 0 .0 0 0 2 0 0 10 20 30 40 50 0 .0 0 0 0 0 0 .0 0 0 1 0 0 .0 0 0 2 0 0 .0 0 0 3 0 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 5 0 .0 1 0 CO2SYS CO2calc csys seacarb mocsy swco2 0 2000 4000 6000 8000 0 .0 0 0 .0 2 0 .0 4 0 .0 6 0 .0 8 CO2SYS CO2calc csys seacarb mocsy swco2 Figure 18. The pKF (top), pKS (middle), and pKA (bottom) computed from each package minus corresponding values from CO2SYS- MATLAB. The formulation for KF is from Dickson and Riley (1979) as recommended by Dickson and Goyet (1994), with all packages on the free scale. The formulation for KS is from Dickson (1990a) and on the free scale, while that for KA is from Mucci (1983) with no scale, as recommended for best practices. The filled black circles indicate check values (Table 12). 2 orders of magnitude smaller and become negligible when carried out at 2 ◦C rather than 13 ◦C. Regarding KW, none of the packages diverges signifi- cantly from CO2SYS-MATLAB. Although CO2calc’s KW appears to oscillate about the reference, the extremes of those oscillations remain negligible. Moreover, our estimates of CO2calc’s equilibrium constants are not precise. Having to compute them from output variables with limited precision, we were unable to estimate CO2calc’s equilibrium constants typically beyond the third place after the decimal. 4.2.4 KF and KS: constants to change pH scales For KF, all packages agree with the check value to its third and final digit after the decimal. The KF from the swco2 package does diverge from the others as salinity increases, but it still agrees with CO2SYS-MATLAB within 1pKF = 0.00006, and its discrepancies do not change with tempera- ture or pressure (Fig. 18). For KS, all packages agree with the check value, again to its third and final digit after the decimal. Beyond that, packages agree even more tightly, with the largest divergence reaching1pKS = 0.0002 for swco2. There are visible differ- ences forKS computed from the different packages that merit further investigation (e.g., positive excursions under surface conditions for swco2), but they remain quite small. Given the negligible consequences, we leave their resolution to future work. 4.2.5 KA and KC: solubility products ForKA, the situation is similar at the surface but not at depth (Fig. 18). Under surface conditions, no packages have sig- nificant discrepancies. Although CO2calc appears to have discrepancies larger than other packages (average 1pKA ∼ 0.0002), they remain quite small; moreover, they may be ex- aggerated because we had to calculate them from computed variables with limited output precision (2 decimal places for CO 2− 3 ). Pressure-correction discrepancies are negligible in all packages but one, swco2. At 5000 db, the discrepancy for 13 ◦C water reaches 1pKA = 0.015, thereby biasing KA to be 3.4 % too low and �A to be 3.4 % too high. However, for more typical deep waters at 2 ◦C, those discrepancies are re- duced by a factor of 7. The form of the swco2 discrepancy curve, quadratic with pressure, suggests an error in the b1 pressure-correction coefficient. Without access to the swco2 source code, we made sensitivity tests with seacarb. Inversing the sign of its b1 coefficient reproduced the form and magni- tude of the swco2 discrepancies. Thus it appears that swco2’s b1 coefficient for KA needs to be changed to +0.0003692. Other swco2 pressure-correction coefficients for KA appear to be correct. Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1507 Temperature (°C) ∆ p K 1 P 0 10 20 30 40 50− 0 .0 0 4 0 .0 0 0 0 .0 0 4 ● Salinity (practical scale) 0 10 20 30 40 50 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 Pressure (db), T=2°C 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 Pressure (db), T=13°C 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 ∆ p K 2 P 0 10 20 30 40 50 − 0 .0 0 2 0 .0 0 2 0 .0 0 6 ● 0 10 20 30 40 50 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 ∆ p K 3 P 0 10 20 30 40 50 − 0 .0 0 2 0 .0 0 2 0 .0 0 6 ● 0 10 20 30 40 50 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 0 2000 4000 6000 8000 0 .0 0 0 0 .0 0 2 0 .0 0 4 0 .0 0 6 CO2SYS csys seacarb mocsy swco2 Figure 19. The pK1P (top), pK2P (middle), and pK3P (bottom) computed from each package minus corresponding values from CO2SYS- MATLAB. Formulations are from Millero (1995), as recommended for best practices. Constants are computed across the same ranges of T (column 1), S (column 2), and P when T = 2 ◦C (column 3) and when T = 13 ◦C (column 4) as used in previous figures. The filled black circles indicate the check values (Table 12). 4.2.6 K1P, K2P, and K3P: constants for phosphoric and silicic acids Constants for phosphoric and silicic acids enter into the cal- culations only when nutrient concentrations are significant andAT is a member of the input pair. Under those conditions, AT must be corrected for nutrient alkalinity to provide an ac- curate estimate of AC, as needed to compute other variables. For K1P, K2P, and K3P, three packages (seacarb, mocsy, and CO2SYS-Excel-Pelletier) agree with results from CO2SYS- MATLAB across ranges of T , S, and P (Fig. 19). Three other packages (CO2SYS-Excel-Pierrot, CO2calc, and ODV) do not provide these constants as output, nor could they be cal- culated from available variables. Yet they exhibit negligible discrepancies for computed variables as a function of nutrient concentrations (Fig. 10), suggesting that their discrepancies in associated equilibrium constants must also be negligible. The remaining package, swco2, differs significantly from CO2SYS-MATLAB, with a constant shift of 0.006 for each of K1P, K2P, and K3P across ranges of T and S. Sensitivity tests with seacarb suggest that this constant shift is caused by swco2 making the necessary conversion from the seawater pH scale to the total pH scale, but doing so twice. The orig- inal formulations of these constants are from Millero (1995) and are on the seawater scale. For their conversion to the to- tal scale, the best-practices approach simply subtracts 0.015 (Dickson and Goyet, 1994; Dickson et al., 2007, Chap. 5, footnote 5), i.e., a constant correction. Conversely, the more rigorous approach to convert between those two pH scales (e.g., Millero, 2010, Eq. 6) results in an offset that varies with the hydrogen fluoride concentration [HF]. For example, with KF from Perez and Fraga (1987) the offset ranges from 0 to 0.032 across observed ocean T and S; withKF from Dickson and Riley (1979), it ranges from 0 to 0.024. Our tests suggest that all packages make the variable correction but only swco2 does not first remove the 0.015 offset (equivalent to a 0.006 shift in pK). ForKSi, only the swco2 package reveals any discrepancies relative to CO2SYS-MATLAB (Fig. 17). Out of the other packages, three agree with KSi from CO2SYS-MATLAB (seacarb, mocsy, and CO2SYS-Excel-Pelletier), three do not provide KSi as output (CO2calc, ODV, and CO2SYS-Excel- Pierrot), and one does not compute KSi (csys). Discrepan- cies for KSi in swco2 under surface conditions are identical to those for its K1P, K2P, and K3P. The constant positive ex- cursion of 0.006 appears due to the same cause, correcting the equilibrium constant from the seawater to the total scale two times. Below the surface, swco2’s discrepancy for KSi grows linearly with pressure, just as does its discrepancy for KB (Sect. 4.2.3). And the cause appears to be identical, a sign error in the a2 pressure correction coefficient, based on our sensitivity tests in seacarb. Thus we recommend that swco2’s a2 coefficient should be checked and changed if necessary to −0.002608. Just as for KB, discrepancies in swco2’s pres- www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 1508 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages sure correction for KSi are lower when carried out at 2 ◦C rather than at 13◦C. The total discrepancies in 1pKSi are 0.007 and 0.015, respectively (at 4000 db). That implies that pressure-correction discrepancies are about 10 times larger at 13◦C than at 2◦C, after removing the 0.006 constant offset at surface conditions. 5 Conclusions To assess the consistency of carbonate chemistry software packages, we have compared computed variables from 10 publicly available distributions, identifying discrepancies and causes. This comparison has led to improved agreement. Since our discussion paper was published (Orr et al., 2014), there has been a fivefold reduction in discrepancies in pCO2 and CO 2− 3 when all packages use the set of constants recom- mended for best practices (Dickson et al., 2007). The small discrepancies that currently exist remain insignificant even after pressure adjustments are made for the cold waters that pervade the deep ocean. Only in warm deep waters, such as found in the Mediterranean Sea, are there significant discrep- ancies and only for one package (swco2), e.g., when pCO2 and CO 2− 3 are computed from the AT–CT input pair. Those discrepancies appear to derive from a sign error in a pressure- correction coefficient forKB. Similar sign errors in pressure- correction coefficients for swco2’s KA and KC appear to cause its �A and �C to be underestimated by 3 % at 4000 db when at 13 ◦C but only 0.5 % when at 2 ◦C. The choice of equilibrium constants affects package agree- ment. Despite the excellent agreement found when packages use the best-practices set of equilibrium constants, their accu- racy under extreme conditions is questionable. Best-practices formulations for K1 and K2 (Lueker et al., 2000) are based on measurements that did not include conditions such as found in estuaries (S < 19) nor in the ocean’s coldest wa- ters (T < 2◦C), which comprise 11% of its global surface area and 42% of its global volume, based on an annual cli- matology (Locarnini et al., 2010). Thus we also compared packages changing only the formulations for K1 and K2 to those that consider low-salinity and low-temperature waters (Millero, 2010). Out of the six packages where that newer option is available, three agreed with the reference, while three others differed, e.g., by up to 7 µatm in surface pCO2. One package differs because it uses the set of published co- efficients to compute the salinity dependence of K1 and K2 on the total scale; conversely, the reference uses another set to compute those constants on the seawater scale, later con- verting to the total scale. Their disagreement after conver- sion indicates a fundamental inconsistency between the two published sets of coefficients. Two other packages differ be- cause one coefficient, also for the seawater scale, has an ad- ditional significant figure taken from an unpublished spread- sheet. Other published coefficients may lack up to 2 signif- icant figures based on our tests with the same spreadsheet’s coefficients on the total scale, which have still greater pre- cision. These discrepancies emphasize the fundamental need for new measurements of K1 and K2 at low salinities, low temperatures, and high pressures. To limit future inconsistencies, we offer several practical recommendations. Users are encouraged to use up-to-date software, to use the set of constants recommended for best practices (Dickson et al., 2007), and to avoid the K1 and K2 from Millero (2010) until discrepancies are resolved. For now, users are also advised to avoid the new total boron-to- salinity ratio (Lee et al., 2010) and favor the “best-practices” ratio (Uppström, 1974), which was used to compute K1 and K2 from laboratory measurements (Mehrbach et al., 1973, Eq. 8). For reproducibility, users should cite not only the package name but also its version number and all chosen equilibrium constants as well as any other selected package options. Developers would facilitate future comparison and reproducibility by providing computed constants as output, releasing their source code, and offering access to older ver- sions, ideally through a public revision control system. De- velopers are also encouraged to consider providing results for potential and in situ pCO2, which differ greatly in deep waters. Although our focus has been on public packages, it is just as necessary to validate privately developed code. To fa- cilitate such validation, we provide a supplement containing a subset of the data produced for this comparison. The Supplement related to this article is available online at doi:10.5194/bg-12-1483-2015-supplement. Acknowledgements. This comparison was conceived by the SOLAS-IMBER Ocean Acidification Working Group (SIOA). Design of the comparison, data production, and preliminary analysis was originally supported by the International Ocean Carbon Coordination Project (IOCCP) with funds from the U.S. National Science Foundation (grant OCE-1243377) to the Scien- tific Committee on Oceanic Research (SCOR). Follow-up support came from the Ocean Acidification International Coordination Centre (OA-ICC), a project of the Peaceful Uses Initiative of the International Atomic Energy Agency (IAEA). Final analysis and the publication of this article were supported by the French ANR project MACROES (MACRoscope for Oceanic Earth System ANR-09-CEP-003) and two EU FP7 projects, CARBOCHANGE (grant 264879) and MedSeA (grant 265103). We thank F. J. Millero for providing the spreadsheet associated with his 2010 publication, with which we were able decipher causes of some differences in implementations of his formulations for K1 and K2. We are indebted to A. Dickson and J. Ólafsson, who provided reviews that helped to improve this study. We also appreciate the many helpful comments from E. Lewis, D. Wallace, L. Robbins, R. Zeebe, and D. Wolf-Gladrow. Edited by: L. Cotrim da Cunha Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ http://dx.doi.org/10.5194/bg-12-1483-2015-supplement J. C. Orr et al.: Comparison of ocean carbonate chemistry packages 1509 References Antonov, J. I., Seidov, D., Boyer, T. P., Locarnini, R. A., Mis- honov, A. V., Garcia, H. E., Baranova, O. K., Zweng, M. M., and Johnson, D. R.: World Ocean Atlas 2009, Volume 2: Salin- ity, edited by: Levitus, S., Atlas NESDIS 69, NOAA, US Gov- ernment Printing Office, Washington DC, 184 pp., 2010. Byrne, R. H. and Yao, W.: Procedures for measurement of carbonate ion concentrations in seawater by direct spectrophotometric ob- servations of Pb (II) complexation, Mar. Chem., 112, 128–135, 2008. Cai, W.-J. and Wang, Y.: The chemistry, fluxes, and sources of car- bon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia, Limnol. Oceanogr., 43, 657–668, 1998. Culberson, C. and Pytkowicz, R. M.: Effect of pressure on carbonic acid, boric acid and the pH in seawater, Limnol. Oceanogr., 13, 403–417, 1968. Dickson, A. G.: Standard potential of the reaction: AgCl(s)+ 1/2H2(g)= Ag(s)+HCl(aq), and the standard acidity constant of the ion HSO − 4 in synthetic seawater from 273.15 to 318.15 K, Chemical Thermodynamics, 22, 113–127, 1990a. Dickson, A. G.: Thermodynamics of the dissociation of boric acid in synthetic seawater from 273.15 to 318.15 K, Deep-Sea Res., 37, 755–766, 1990b. Dickson, A. G.: The carbon dioxide system in seawater: equilib- rium chemistry and measurements, in: Guide to Best Practices for Ocean Acidification Research and Data Reporting, edited by: Riebesell, U., Fabry, V. J., Hansson, L., and Gattuso, J.-P., Publi- cations Office of the European Union, 17–40, 2010. Dickson, A. G. and Goyet, C.: Handbook of methods for the anal- ysis of the various parameters of the carbon dioxide system in seawater; version 2, ORNL/CDIAC-74, ORNL, 1994. Dickson, A. G. and Millero, F.: A comparison of the equilibrium constants for the dissociation of carbonic acid in seawater media, Deep-Sea Res., 34, 1733–1743, 1987. Dickson, A. G. and Riley, J. P.: The effect of analytical error on the evaluation of the components of the aquatic carbon-dioxide system, Mar. Chem., 6, 77–85, 1978. Dickson, A. G. and Riley, J. P.: The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base, I. The ionic product of water – KW, Mar. Chem., 7, 89–99, 1979. Dickson, A. G., Sabine, C. L., and Christian, J. R.: Guide to best practices for ocean CO2 measurements, PICES Special Publica- tion 3, 191 pp., 2007. Easley, R. A., Patsavas, M. C., Byrne, R. H., Liu, X., Feely, R. A., and Mathis, J. T.: Spectrophotometric Measurement of Calcium Carbonate Saturation States in Seawater, Environ. Sci. Technol., 47, 1468–1477, 2013. Frankignoulle, M.: A complete set of buffer factors for acid/base CO2 system in seawater, J. Marine Syst., 5, 111–118, 1994. Garcia, H. E., Locarnini, R. A., Boyer, T. P., Antonov, J. I., Zweng, M. M., Baranova, O. K., and Johnson, D. R.: World Ocean Atlas 2009, Volume 4: Nutrients (Phosphate, Nitrate, Sili- cate), edited by: Levitus, S., Atlas NESDIS 71, NOAA, US Gov- ernment Printing Office, Washington DC, 398 pp., 2010. Gattuso, J.-P. and Hansson, L. (Eds.): Ocean Acidification, Oxford Univ. Press, Oxford, UK, 408 pp., 2011. Gattuso, J.-P. and Lavigne, H.: Technical Note: Approaches and software tools to investigate the impact of ocean acidifica- tion, Biogeosciences, 6, 2121–2133, doi:10.5194/bg-6-2121- 2009, 2009. Gattuso, J.-P., Epitalon, J.-M. and Lavigne, H. : seacarb: seawa- ter carbonate chemistry with R. R package version 3.0.6, The Comprehensive R Archive Network, http://CRAN.R-project.org/ package=seacarb (last access: 24 February 2015), 2015. Goyet, C. and Poisson, A.: New determination of carbonic acid dis- sociation constants in seawater as a function of temperature and salinity, Deep-Sea Res., 36, 1635–1654, 1989. Hansson, I.: A new set of acidity constants for carbonic acid and boric acid in sea water, Deep-Sea Res., 20, 461–478, 1973a. Hansson, I.: The determination of dissociation constants of carbonic acid in synthetic sea water in the salinity range of 20–40 ‰ and temperature range of 5–30 ◦C, Acta Chemica Scandanavia, 27, 931–944, 1973b. Hofmann, A. F., Soetaert, K., Middelburg, J. J., and Meysman, F. J.: AquaEnv: An Aquatic Acid-Base Modelling Environment in: R. Aquatic Geochemistry, 16, 507–546, 2010. Hoppe, C. J. M., Langer, G., Rokitta, S. D., Wolf-Gladrow, D. A., and Rost, B.: Implications of observed inconsistencies in carbon- ate chemistry measurements for ocean acidification studies, Bio- geosciences, 9, 2401–2405, doi:10.5194/bg-9-2401-2012, 2012. Hunter, K. A.: XLCO2 – Seawater CO2 Equilibrium Calcula- tions Using Excel Version 2, University of Otago, New Zealand, available at: http://neon.otago.ac.nz/research/mfc/people/keith_ hunter/software/swco2/ (last access: 24 February 2015), 2007. Key, R. M., Sabine., C. L., Lee, K., Wanninkhof, R., Bullister, J., Feely, R. A., Millero, F. J., Mordy, C., and Peng, T.-H.: A Global Ocean carbon climatology: results from Global Data Analy- sis Project (GLODAP), Global Biogeochem. Cy., 18, GB4031, doi:10.1029/2004GB002247, 2004. Khoo, K. H., Ramette, R. W., Culberson, C. H., and Bates, R. G.: Determination of hydrogen ion concentrations in seawater from 5 to 40 ◦C: standard potentials at salinities from 20 to 45 ‰, Anal. Chem., 49, 29–34, 1977. Kroeker, K. J., Kordas, R. L., Crim, R., Hendriks, I. E., Ramajo, L., Singh, G. S., Duarte, C. M., and Gattuso, J.-P.: Impacts of ocean acidification on marine organisms: quantifying sensitivities and interaction with warming, Glob. Change Biol., 19, 156–159, 2013. Lee, K., Kim, T.-W., Byrne, R. H., Millero, F. J., Feely, R. A., and Liu, Y.-M.: The universal ratio of boron to chlorinity for the North Pacific and North Atlantic oceans, Geochim. Cosmochim. Ac., 74, 1801–1811, doi:10.1016/j.gca.2009.12.027, 2010. Lewis, E. and Wallace, D. W. R.: Program Developed for CO2 System Calculations, ORNL/CDIAC-105, Carbon Dioxide Inf. Anal. Cent., Oak Ridge Natl. Lab., Oak Ridge, Tenn., 38 pp., 1998. Locarnini, R., Mishonov, A., Antonov, J., Boyer, T., Garcia, H., Baranova, O., Zweng, M., and Johnson, D.: World Ocean At- las 2009, Volume 1: Temperature, edited by: Levitus, S., Atlas NESDIS 68, NOAA, US Government Printing Office, Washing- ton DC, 184 pp., 2010. Lueker, T. J., Dickson, A. G., and Keeling, C. D.: Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equa- tions for K1 and K2: validation based on laboratory measure- ments of CO2 in gas and seawater at equilibrium, Mar. Chem., 70, 105–119, 2000. www.biogeosciences.net/12/1483/2015/ Biogeosciences, 12, 1483–1510, 2015 http://dx.doi.org/10.5194/bg-6-2121-2009 http://dx.doi.org/10.5194/bg-6-2121-2009 http://CRAN.R-project.org/package=seacarb http://CRAN.R-project.org/package=seacarb http://dx.doi.org/10.5194/bg-9-2401-2012 http://neon.otago.ac.nz/research/mfc/people/keith_hunter/software/swco2/ http://neon.otago.ac.nz/research/mfc/people/keith_hunter/software/swco2/ http://dx.doi.org/10.1029/2004GB002247 http://dx.doi.org/10.1016/j.gca.2009.12.027 1510 J. C. Orr et al.: Comparison of ocean carbonate chemistry packages Martz, T. R., Jannasch, H. W., and Johnson, K. S.: Determination of carbonate ion concentration and inner sphere carbonate ion pairs in seawater by ultraviolet spectrophotometric titration, Mar. Chem., 115, 145–154, 2009. Mehrbach, C., Culberson, C. H., Hawley, J. E., and Pytkow- icz, R. M.: Measurement of the apparent dissociation constants of carbonic acid in seawater at atmospheric pressure, Limnol. Oceanogr., 18, 897–907, 1973. Millero, F. J.: The thermodynamics of the carbonate system in sea- water, Geochim. Cosmochim. Ac., 43, 1651–1661, 1979. Millero, F. J.: Influence of pressure on chemical processes in the sea, in: Chemical Oceanography, edited by: Riley, J. P. and Chester, R., 1–88, Academic Press, New York, 1983. Millero, F. J.: Thermodynamics of the carbon dioxide system in the oceans, Geochim. Cosmochim. Ac., 59, 661–677, 1995. Millero, F. J.: The marine inorganic carbon cycle, Chem. Rev., 107, 308–341, 2007. Millero, F. J.: Carbonate constants for estuarine waters, Mar. Fresh- water Res., 61, 139–142, doi:10.1071/MF09254, 2010. Millero, F. J., Graham, T. B., Huang, F., Bustos-Serrano, H., and Pierrot, D.: Dissociation constants of carbonic acid in seawater, Mar. Chem., 100, 80–94, doi:10.1016/j.marchem.2005.12.001, 2006. Mojica Prieto, F. J. and Millero, F. J.: The values of pK1+ pK2 for the dissociation of carbonic acid in seawater, Geochim. Cos- mochim. Ac., 66, 2529–2540, 2002. Morris, A. and Riley, J.: The bromide/chlorinity and sul- phate/chlorinity ratio in sea water, Deep-Sea Res., 13, 699–705, 1966. Mosley, L. M., Peake, B. M., and Hunter, K. A.: Modelling of pH and inorganic carbon speciation in estuaries using the compo- sition of the river and seawater end members, Environ. Modell. Softw., 25, 1658–1663, 2010. Mucci, A.: The solubility of calcite and aragonite in seawater at var- ious salinities, temperatures, and one atmosphere total pressure, Am. J. Sc., 283, 780–799, 1983. Munhoven, G.: Mathematics of the total alkalinity-pH equation – pathway to robust and universal solution algorithms: the SolveSAPHE package v1.0.1, Geosci. Model Dev., 6, 1367– 1388, doi:10.5194/gmd-6-1367-2013, 2013. Orr, J. C.: Recent and future changes in ocean carbonate chem- istry, in: Ocean Acidification, edited by: Gattuso, J.-P., and Hans- son, L., chap. 3, 41–66, Oxford Univ. Press, 2011. Orr, J. C. and Epitalon, J.-M.: Improved routines to model the ocean carbonate system: mocsy 1.0, Geosci. Model Dev. Discuss., 7, 2877–2902, doi:10.5194/gmdd-7-2877-2014, 2014. Orr, J. C. and Epitalon, J.-M.: Improved routines to model the ocean carbonate system: mocsy 2.0, Geosci. Model Dev., 8, 485–499, doi:10.5194/gmd-8-485-2015, 2015. Orr, J. C., Najjar, R., Sabine, C. L., and Joos, F.: Abiotic-HOWTO. Internal OCMIP Report, LSCE/CEA Saclay, Gif-sur-Yvette, France, 25 pp., 1999. Orr, J. C., Fabry, V. J., Aumont, O., Bopp, L., Doney, S. C., Feely, R. A., Gnanadesikan, A., Gruber, N., Ishida, A., Joos, F., Key, R. M., Lindsay, K., Maier-Reimer, E., Matear, R., Monfray, P., Mouchet, A., Najjar, R. G., Plattner, G.-K., Rodgers, K. B., Sabine, C. L., Sarmiento, J. L., Schlitzer, R., Slater, R. D., Totterdell, I. J., Weirig, M.-F., Yamanaka, Y., and Yool, A.: Anthropogenic ocean acidification over the twenty- first century and its impact on calcifying organisms, Nature, 437, 681–686, doi:10.1038/nature04095, 2005. Orr, J. C., Epitalon, J.-M., and Gattuso, J.-P.: Comparison of seven packages that compute ocean carbonate chemistry, Bio- geosciences Discuss., 11, 5327–5397, doi:10.5194/bgd-11-5327- 2014, 2014. 2014. Pelletier, G., Lewis, E., and Wallace, D.: CO2SY S.XLS: A calcu- lator for the CO2 system in seawater for Microsoft Excel/VBA, Wash. State Dept. of Ecology/Brookhaven Nat. Lab., Olympia, WA/Upton, NY, USA, 2007. Perez, F. F. and Fraga, F.: Association constant of fluoride and hy- drogen ions in seawater, Mar. Chem., 21, 161–168, 1987. Pierrot, D., Lewis, E., and Wallace, D. W. R.: MS Excel Program Developed for CO2 System Calculations, Tech. rep., Carbon Dioxide Inf. Anal. Cent., Oak Ridge Natl. Lab., US DOE, Oak Ridge, Tenn., 2006. Proye, A. and Gattuso, J.-P.: Seacarb, an R package to calculate parameters of the seawater carbonate system, 2003. R Development Core Team: R: A Language and Environment for Statistical Computing, R Foundation for Statistical Computing, Vienna, Austria, ISBN 3-900051-07-0, 2012. Riley, J. P.: The occurrence of anomalously high fluoride concentra- tions in the North Atlantic, Deep-Sea Res., 12, 219–220, 1965. Riley, J. and Tongudai, M.: The major cation/chlorinity ratios in sea water, Chem. Geol., 2, 263–269, 1967. Robbins, L. L., Hansen, M. E., Kleypas, J. A., and Meylan, S. C.: CO2calc: a user-friendly carbon calculator for Windows, Mac OS X, and iOS (iPhone), USGS Open-File Report, 2010–1280, 17, 2010. Roy, R. N., Roy, L. N., Vogel, K. M., Porter-Moore, C., Pearson, T., Good, C. E., Millero, F. J., and Campbell, D. M.: The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45 ◦C, Mar. Chem., 44, 249–267, 1993. Sarmiento, J. L., Le Quéré, C., and Pacala, S.: Limiting future at- mospheric carbon dioxide, Global Biogeochem. Cy., 9, 121–137, 1995. Schlitzer, R.: Interactive analysis and visualization of geoscience data with Ocean Data View, Comput. Geosci., 28, 1211–1218, 2002. Uppström, L. R.: The Boron/Chlorinity Ratio of Deep-Sea Water from the Pacific Ocean, in: Deep-Sea Research and Oceano- graphic Abstracts, 21, 161–162, Elsevier, 1974. van Heuven, S., Pierrot, D., Rae, J. W. B., Lewis, E., and Wallace, D. W. R.: MATLAB program developed for CO2 system calcu- lations, ORNL/CDIAC-105b, Carbon Dioxide Inf. Anal. Cent., Oak Ridge Natl. Lab., US DOE, Oak Ridge, Tenn., 2011. Weiss, R. F.: Carbon dioxide in water and seawater: the solubility of a non-ideal gas, Mar. Chem., 2, 203–215, 1974. Wittmann, A. C. and Pörtner, H.-O.: Sensitivities of extant animal taxa to ocean acidification, Nature Climate Change, 3, 995–1001, 2013. Zeebe, R. E. and Wolf-Gladrow, D. A.: CO2 in Seawater: Equilib- rium, Kinetics, Isotopes, Elsevier, Amsterdam, 346 pp., 2001. Biogeosciences, 12, 1483–1510, 2015 www.biogeosciences.net/12/1483/2015/ http://dx.doi.org/10.1071/MF09254 http://dx.doi.org/10.1016/j.marchem.2005.12.001 http://dx.doi.org/10.5194/gmd-6-1367-2013 http://dx.doi.org/10.5194/gmdd-7-2877-2014 http://dx.doi.org/10.5194/gmd-8-485-2015 http://dx.doi.org/10.1038/nature04095 http://dx.doi.org/10.5194/bgd-11-5327-2014 http://dx.doi.org/10.5194/bgd-11-5327-2014 Abstract Introduction Methods Packages and reference Features Input data Best-practices comparison Sensitivity tests Constants Pressure corrections What is significant? Results Global gridded data Physical factors AT--CT AT--pH AT--pCO2 CT--pH CT--pCO2 Chemical factors Nutrients Total boron K1 and K2 Computational efficiency Discussion Sensitivity to individual constants Errors in equilibrium constants K0, K1, and K2: best practices Alternative K1 and K2 for low salinities KB and KW: principal non-carbonate alkalinity constants KF and KS: constants to change pH scales KA and KC: solubility products K1P, K2P, and K3P: constants for phosphoric and silicic acids Conclusions Acknowledgements References